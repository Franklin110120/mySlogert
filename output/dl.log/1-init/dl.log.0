server.com lassen268: [2022-07-22 10:11:18,978] [INFO] [launch.py:110:main] 0 NCCL_DEBUG=warn
server.com lassen268: [2022-07-22 10:11:18,978] [INFO] [launch.py:117:main] WORLD INFO DICT: {'lassen268': [0, 1, 2, 3], 'lassen412': [0, 1, 2, 3]}
server.com lassen268: [2022-07-22 10:11:18,978] [INFO] [launch.py:123:main] nnodes=2, num_local_procs=4, node_rank=0
server.com lassen268: [2022-07-22 10:11:18,978] [INFO] [launch.py:136:main] global_rank_mapping=defaultdict(<class 'list'>, {'lassen268': [0, 1, 2, 3], 'lassen412': [4, 5, 6, 7]})
server.com lassen268: [2022-07-22 10:11:18,978] [INFO] [launch.py:137:main] dist_world_size=8
server.com lassen268: [2022-07-22 10:11:18,978] [INFO] [launch.py:139:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
server.com lassen412: [2022-07-22 10:11:19,494] [INFO] [launch.py:110:main] 1 NCCL_DEBUG=warn
server.com lassen412: [2022-07-22 10:11:19,494] [INFO] [launch.py:117:main] WORLD INFO DICT: {'lassen268': [0, 1, 2, 3], 'lassen412': [0, 1, 2, 3]}
server.com lassen412: [2022-07-22 10:11:19,494] [INFO] [launch.py:123:main] nnodes=2, num_local_procs=4, node_rank=1
server.com lassen412: [2022-07-22 10:11:19,494] [INFO] [launch.py:136:main] global_rank_mapping=defaultdict(<class 'list'>, {'lassen268': [0, 1, 2, 3], 'lassen412': [4, 5, 6, 7]})
server.com lassen412: [2022-07-22 10:11:19,494] [INFO] [launch.py:137:main] dist_world_size=8
server.com lassen412: [2022-07-22 10:11:19,494] [INFO] [launch.py:139:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
server.com lassen412: [2022-07-22 10:11:53,408] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:11:53,409] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:11:53,469] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:11:53,469] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:11:53,477] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:11:53,477] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:11:53,477] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:11:53,478] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:11:53,478] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:11:53,478] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:11:53,484] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:11:53,485] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:11:53,494] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:11:53,494] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:11:53,542] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:11:53,542] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:11:53,585] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:11:54,890] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:12:00,909] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:00,909] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen412: [2022-07-22 10:12:00,909] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:00,909] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen412: [2022-07-22 10:12:00,909] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen412: [2022-07-22 10:12:00,909] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:00,909] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:12:00,909] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:00,910] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:12:00,910] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:00,910] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:00,910] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:00,910] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:00,910] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:00,911] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:00,941] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:12:00,942] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:12:00,943] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 39.79 GB, percent = 12.5%
server.com lassen268: [2022-07-22 10:12:00,943] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:00,944] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:00,944] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:00,944] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:12:00,944] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:12:00,944] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:12:00,944] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:03,818] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen412: [2022-07-22 10:12:03,818] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:12:03,818] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:03,818] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:03,819] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:03,819] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:03,819] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:03,878] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen412: [2022-07-22 10:12:03,878] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen412: [2022-07-22 10:12:03,879] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:12:03,879] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:03,879] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:12:03,879] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:03,879] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:03,879] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:03,879] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:03,879] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen412: [2022-07-22 10:12:03,879] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:03,879] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:03,879] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:03,879] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:03,881] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:03,881] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:03,882] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:03,882] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:12:03,882] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:12:03,882] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:12:03,882] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:03,885] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen412: [2022-07-22 10:12:03,885] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:03,885] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen412: [2022-07-22 10:12:03,885] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:03,885] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:03,885] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:03,885] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:12:03,885] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:03,885] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:12:03,885] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen412: [2022-07-22 10:12:03,885] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen412: [2022-07-22 10:12:03,885] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:12:03,885] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen412: [2022-07-22 10:12:03,885] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:03,886] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:03,886] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:03,886] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:03,886] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:12:03,886] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:12:03,886] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:12:03,886] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:04,125] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:12:04,127] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:12:04,127] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.47 GB, percent = 12.7%
server.com lassen268: [2022-07-22 10:12:04,134] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:12:04,139] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:12:04,139] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:12:04,139] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:04,139] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:12:04,139] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:12:04,140] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:12:04,140] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:12:04,633] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:12:04,633] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:12:04,633] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:12:04,654] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:12:04,654] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:12:04,849] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:12:04,850] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:12:04,850] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x2000bd7b5b80>
server.com lassen268: [2022-07-22 10:12:04,850] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:04,851] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:12:04,851] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:12:04,851] [INFO] [config.py:1055:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
server.com lassen268: [2022-07-22 10:12:04,851] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:12:04,851] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:12:04,852] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:12:04,852] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:12:04,852] [INFO] [config.py:1055:print]   checkpoint_tag_validation_enabled  True
server.com lassen268: [2022-07-22 10:12:04,852] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:12:04,852] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:12:04,853] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:12:04,854] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 15
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x2000bd763c10>
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:12:04,855] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:12:04,856] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   train_batch_size ............. 480
server.com lassen268: [2022-07-22 10:12:04,857] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  4
server.com lassen268: [2022-07-22 10:12:04,858] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:12:04,858] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:12:04,858] [INFO] [config.py:1055:print]   world_size ................... 8
server.com lassen268: [2022-07-22 10:12:04,858] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:12:04,858] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:12:04,858] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:12:04,858] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:12:04,859] [INFO] [config.py:1057:print]   json = {
server.com lassen412: [2022-07-22 10:12:07,867] [WARNING] [engine.py:2487:load_checkpoint] Unable to find latest file at results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
server.com lassen412: [2022-07-22 10:12:07,867] [WARNING] [engine.py:2487:load_checkpoint] Unable to find latest file at results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
server.com lassen412: [2022-07-22 10:12:07,867] [WARNING] [engine.py:2487:load_checkpoint] Unable to find latest file at results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
server.com lassen412: [2022-07-22 10:12:07,867] [WARNING] [engine.py:2487:load_checkpoint] Unable to find latest file at results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
server.com lassen268: [2022-07-22 10:12:07,868] [WARNING] [engine.py:2487:load_checkpoint] Unable to find latest file at results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
server.com lassen268: [2022-07-22 10:12:07,868] [WARNING] [engine.py:2487:load_checkpoint] Unable to find latest file at results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
server.com lassen268: [2022-07-22 10:12:07,868] [WARNING] [engine.py:2487:load_checkpoint] Unable to find latest file at results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
server.com lassen268: [2022-07-22 10:12:07,868] [WARNING] [engine.py:2487:load_checkpoint] Unable to find latest file at results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
server.com lassen268: [2022-07-22 10:12:08,291] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:12:08,291] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:12:08,291] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:12:08,291] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:12:08,292] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:12:11,302] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.17 | overflow_check: 71.86 | unscale_and_clip: 1.08 | basic_step: 3.83 | update_fp16: 2.89
server.com lassen268: [2022-07-22 10:12:11,302] [INFO] [logging.py:69:log_dist] [Rank 0] step=1, skipped=0, lr=[5.9999866760450176e-05, 5.9999866760450176e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:11,306] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1313.31 | backward_microstep: 1542.31 | backward_inner_microstep: 1517.57 | backward_allreduce_microstep: 23.29 | step_microstep: 92.27
server.com lassen268: [2022-07-22 10:12:11,309] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1312.72 | backward: 1541.75 | backward_inner: 1517.01 | backward_allreduce: 23.29 | step: 92.29
server.com lassen268: [2022-07-22 10:12:13,247] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.91 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.27
server.com lassen268: [2022-07-22 10:12:13,248] [INFO] [logging.py:69:log_dist] [Rank 0] step=2, skipped=0, lr=[5.9999467043115695e-05, 5.9999467043115695e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:13,251] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.12 | backward_microstep: 1262.43 | backward_inner_microstep: 1237.90 | backward_allreduce_microstep: 23.13 | step_microstep: 39.89
server.com lassen268: [2022-07-22 10:12:13,255] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.56 | backward: 1261.88 | backward_inner: 1237.37 | backward_allreduce: 23.17 | step: 39.92
server.com lassen268: [2022-07-22 10:12:15,172] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.15 | unscale_and_clip: 1.02 | basic_step: 3.82 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:12:15,172] [INFO] [logging.py:69:log_dist] [Rank 0] step=3, skipped=0, lr=[5.999880085194164e-05, 5.999880085194164e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:15,173] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=173.0448361577259, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:15,176] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 551.44 | backward_microstep: 1259.39 | backward_inner_microstep: 1234.93 | backward_allreduce_microstep: 23.07 | step_microstep: 40.78
server.com lassen268: [2022-07-22 10:12:15,179] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 550.88 | backward: 1258.85 | backward_inner: 1234.40 | backward_allreduce: 23.11 | step: 40.80
server.com lassen268: [2022-07-22 10:12:17,093] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.95 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:12:17,093] [INFO] [logging.py:69:log_dist] [Rank 0] step=4, skipped=0, lr=[5.999786819350304e-05, 5.999786819350304e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:17,094] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=169.32016965103458, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:17,097] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.75 | backward_microstep: 1261.86 | backward_inner_microstep: 1233.78 | backward_allreduce_microstep: 26.69 | step_microstep: 40.58
server.com lassen268: [2022-07-22 10:12:17,100] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 550.19 | backward: 1261.32 | backward_inner: 1233.26 | backward_allreduce: 26.73 | step: 40.60
server.com lassen268: [2022-07-22 10:12:19,034] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.02 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:12:19,035] [INFO] [logging.py:69:log_dist] [Rank 0] step=5, skipped=0, lr=[5.999666907700483e-05, 5.999666907700483e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:19,035] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=171.0674174058712, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:19,039] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.92 | backward_microstep: 1267.27 | backward_inner_microstep: 1242.46 | backward_allreduce_microstep: 23.43 | step_microstep: 40.71
server.com lassen268: [2022-07-22 10:12:19,042] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 550.35 | backward: 1266.73 | backward_inner: 1241.93 | backward_allreduce: 23.47 | step: 40.72
server.com lassen268: [2022-07-22 10:12:20,957] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.63 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:12:20,958] [INFO] [logging.py:69:log_dist] [Rank 0] step=6, skipped=0, lr=[5.999520351428184e-05, 5.999520351428184e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:20,959] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=170.303778893178, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:20,962] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.65 | backward_microstep: 1257.83 | backward_inner_microstep: 1232.45 | backward_allreduce_microstep: 24.02 | step_microstep: 40.26
server.com lassen268: [2022-07-22 10:12:20,965] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 550.10 | backward: 1257.29 | backward_inner: 1231.92 | backward_allreduce: 24.05 | step: 40.28
server.com lassen268: [2022-07-22 10:12:22,871] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.83 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:12:22,871] [INFO] [logging.py:69:log_dist] [Rank 0] step=7, skipped=0, lr=[5.999347151979857e-05, 5.999347151979857e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:22,872] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=170.7633794265704, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:22,875] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.40 | backward_microstep: 1261.02 | backward_inner_microstep: 1235.98 | backward_allreduce_microstep: 23.66 | step_microstep: 40.48
server.com lassen268: [2022-07-22 10:12:22,878] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.84 | backward: 1260.48 | backward_inner: 1235.46 | backward_allreduce: 23.70 | step: 40.50
server.com lassen268: [2022-07-22 10:12:24,783] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.62 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:12:24,784] [INFO] [logging.py:69:log_dist] [Rank 0] step=8, skipped=0, lr=[5.99914731106491e-05, 5.99914731106491e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:24,784] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=171.11576198927034, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:24,788] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 549.97 | backward_microstep: 1258.51 | backward_inner_microstep: 1233.67 | backward_allreduce_microstep: 23.47 | step_microstep: 40.27
server.com lassen268: [2022-07-22 10:12:24,791] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.40 | backward: 1257.97 | backward_inner: 1233.14 | backward_allreduce: 23.50 | step: 40.29
server.com lassen268: [2022-07-22 10:12:26,697] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.88 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:12:26,698] [INFO] [logging.py:69:log_dist] [Rank 0] step=9, skipped=0, lr=[5.9989208306556924e-05, 5.9989208306556924e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:26,699] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=171.42379290274434, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:26,702] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.29 | backward_microstep: 1255.09 | backward_inner_microstep: 1230.55 | backward_allreduce_microstep: 23.16 | step_microstep: 40.52
server.com lassen268: [2022-07-22 10:12:26,705] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.73 | backward: 1254.56 | backward_inner: 1230.02 | backward_allreduce: 23.20 | step: 40.55
server.com lassen268: [2022-07-22 10:12:28,611] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.80 | unscale_and_clip: 1.01 | basic_step: 3.84 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:12:28,611] [INFO] [logging.py:69:log_dist] [Rank 0] step=10, skipped=0, lr=[5.9986677129874745e-05, 5.9986677129874745e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:28,612] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=171.64349865425677, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:28,615] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.30 | backward_microstep: 1256.18 | backward_inner_microstep: 1231.88 | backward_allreduce_microstep: 22.93 | step_microstep: 40.41
server.com lassen268: [2022-07-22 10:12:28,618] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.75 | backward: 1255.64 | backward_inner: 1231.35 | backward_allreduce: 22.97 | step: 40.43
server.com lassen268: [2022-07-22 10:12:30,526] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.77 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:12:30,527] [INFO] [logging.py:69:log_dist] [Rank 0] step=11, skipped=0, lr=[5.9983879605584264e-05, 5.9983879605584264e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:30,528] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=171.85723023166648, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:30,531] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 549.87 | backward_microstep: 1255.52 | backward_inner_microstep: 1231.18 | backward_allreduce_microstep: 22.96 | step_microstep: 40.36
server.com lassen268: [2022-07-22 10:12:30,534] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.31 | backward: 1254.98 | backward_inner: 1230.65 | backward_allreduce: 22.99 | step: 40.38
server.com lassen268: [2022-07-22 10:12:32,445] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.98 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:12:32,445] [INFO] [logging.py:69:log_dist] [Rank 0] step=12, skipped=0, lr=[5.998081576129591e-05, 5.998081576129591e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:32,446] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=171.97373633937545, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:32,449] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.13 | backward_microstep: 1255.86 | backward_inner_microstep: 1231.73 | backward_allreduce_microstep: 22.76 | step_microstep: 40.59
server.com lassen268: [2022-07-22 10:12:32,452] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.58 | backward: 1255.32 | backward_inner: 1231.20 | backward_allreduce: 22.79 | step: 40.61
server.com lassen268: [2022-07-22 10:12:34,364] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.75 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:12:34,365] [INFO] [logging.py:69:log_dist] [Rank 0] step=13, skipped=0, lr=[5.997748562724858e-05, 5.997748562724858e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:34,366] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=172.09491036090864, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:34,369] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.54 | backward_microstep: 1256.36 | backward_inner_microstep: 1231.86 | backward_allreduce_microstep: 23.13 | step_microstep: 40.37
server.com lassen268: [2022-07-22 10:12:34,372] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.98 | backward: 1255.83 | backward_inner: 1231.33 | backward_allreduce: 23.17 | step: 40.39
server.com lassen268: [2022-07-22 10:12:36,284] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.97 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:12:36,284] [INFO] [logging.py:69:log_dist] [Rank 0] step=14, skipped=0, lr=[5.9973889236309373e-05, 5.9973889236309373e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:36,285] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=172.15773483001564, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:36,288] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.00 | backward_microstep: 1256.44 | backward_inner_microstep: 1232.05 | backward_allreduce_microstep: 23.03 | step_microstep: 40.59
server.com lassen268: [2022-07-22 10:12:36,291] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.44 | backward: 1255.90 | backward_inner: 1231.52 | backward_allreduce: 23.06 | step: 40.61
server.com lassen268: [2022-07-22 10:12:38,203] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.77 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:12:38,203] [INFO] [logging.py:69:log_dist] [Rank 0] step=15, skipped=0, lr=[5.997002662397319e-05, 5.997002662397319e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:38,204] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=172.0300526758892, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:38,207] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.26 | backward_microstep: 1258.94 | backward_inner_microstep: 1231.57 | backward_allreduce_microstep: 25.99 | step_microstep: 40.43
server.com lassen268: [2022-07-22 10:12:38,210] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.70 | backward: 1258.40 | backward_inner: 1231.05 | backward_allreduce: 26.03 | step: 40.45
server.com lassen268: [2022-07-22 10:12:40,121] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.73 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:12:40,122] [INFO] [logging.py:69:log_dist] [Rank 0] step=16, skipped=0, lr=[5.996589782836248e-05, 5.996589782836248e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:40,122] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=172.09774461569518, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:40,125] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.38 | backward_microstep: 1259.38 | backward_inner_microstep: 1235.03 | backward_allreduce_microstep: 22.97 | step_microstep: 40.41
server.com lassen268: [2022-07-22 10:12:40,129] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.82 | backward: 1258.84 | backward_inner: 1234.51 | backward_allreduce: 23.01 | step: 40.43
server.com lassen268: [2022-07-22 10:12:42,037] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.83 | unscale_and_clip: 1.02 | basic_step: 3.82 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:12:42,037] [INFO] [logging.py:69:log_dist] [Rank 0] step=17, skipped=0, lr=[5.9961502890226766e-05, 5.9961502890226766e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:42,038] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=172.17385637739494, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:42,041] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.02 | backward_microstep: 1258.11 | backward_inner_microstep: 1233.92 | backward_allreduce_microstep: 22.82 | step_microstep: 40.50
server.com lassen268: [2022-07-22 10:12:42,045] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.46 | backward: 1257.57 | backward_inner: 1233.38 | backward_allreduce: 22.86 | step: 40.52
server.com lassen268: [2022-07-22 10:12:43,956] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.82 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:12:43,956] [INFO] [logging.py:69:log_dist] [Rank 0] step=18, skipped=0, lr=[5.995684185294233e-05, 5.995684185294233e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:43,957] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=172.21450030670053, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:43,960] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 550.01 | backward_microstep: 1255.22 | backward_inner_microstep: 1230.63 | backward_allreduce_microstep: 23.23 | step_microstep: 40.44
server.com lassen268: [2022-07-22 10:12:43,963] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.46 | backward: 1254.69 | backward_inner: 1230.10 | backward_allreduce: 23.27 | step: 40.46
server.com lassen268: [2022-07-22 10:12:45,871] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.03 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:12:45,872] [INFO] [logging.py:69:log_dist] [Rank 0] step=19, skipped=0, lr=[5.995191476251172e-05, 5.995191476251172e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:45,873] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=172.2651258119019, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:45,876] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 549.99 | backward_microstep: 1257.18 | backward_inner_microstep: 1232.46 | backward_allreduce_microstep: 23.35 | step_microstep: 40.64
server.com lassen268: [2022-07-22 10:12:45,879] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.44 | backward: 1256.64 | backward_inner: 1231.93 | backward_allreduce: 23.39 | step: 40.66
server.com lassen268: [2022-07-22 10:12:47,788] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.71 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:12:47,789] [INFO] [logging.py:69:log_dist] [Rank 0] step=20, skipped=0, lr=[5.9946721667563326e-05, 5.9946721667563326e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:47,789] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=172.30367485550184, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:47,793] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 549.83 | backward_microstep: 1254.97 | backward_inner_microstep: 1230.29 | backward_allreduce_microstep: 23.31 | step_microstep: 40.31
server.com lassen268: [2022-07-22 10:12:47,796] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 549.27 | backward: 1254.43 | backward_inner: 1229.76 | backward_allreduce: 23.34 | step: 40.33
server.com lassen268: [2022-07-22 10:12:47,811] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step20/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:12:53,174] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.02 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:12:53,175] [INFO] [logging.py:69:log_dist] [Rank 0] step=21, skipped=0, lr=[5.994126261935092e-05, 5.994126261935092e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:53,176] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=172.36095286295782, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:53,179] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.36 | backward_microstep: 1262.16 | backward_inner_microstep: 1238.02 | backward_allreduce_microstep: 22.76 | step_microstep: 40.64
server.com lassen268: [2022-07-22 10:12:53,182] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 554.65 | backward: 1261.62 | backward_inner: 1237.49 | backward_allreduce: 22.79 | step: 40.65
server.com lassen268: [2022-07-22 10:12:55,095] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.87 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:12:55,095] [INFO] [logging.py:69:log_dist] [Rank 0] step=22, skipped=0, lr=[5.993553767175308e-05, 5.993553767175308e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:55,096] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=172.28659645481787, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:55,099] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.07 | backward_microstep: 1264.45 | backward_inner_microstep: 1240.17 | backward_allreduce_microstep: 22.91 | step_microstep: 40.53
server.com lassen268: [2022-07-22 10:12:55,102] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.38 | backward: 1263.91 | backward_inner: 1239.64 | backward_allreduce: 22.94 | step: 40.55
server.com lassen268: [2022-07-22 10:12:57,011] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.72 | unscale_and_clip: 1.02 | basic_step: 3.82 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:12:57,011] [INFO] [logging.py:69:log_dist] [Rank 0] step=23, skipped=0, lr=[5.992954688127273e-05, 5.992954688127273e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:57,012] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=172.34648183721959, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:57,015] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.01 | backward_microstep: 1260.27 | backward_inner_microstep: 1235.74 | backward_allreduce_microstep: 23.16 | step_microstep: 40.37
server.com lassen268: [2022-07-22 10:12:57,018] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.27 | backward: 1259.73 | backward_inner: 1235.21 | backward_allreduce: 23.19 | step: 40.39
server.com lassen268: [2022-07-22 10:12:58,926] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.93 | unscale_and_clip: 1.02 | basic_step: 3.82 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:12:58,927] [INFO] [logging.py:69:log_dist] [Rank 0] step=24, skipped=0, lr=[5.992329030703658e-05, 5.992329030703658e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:12:58,928] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=172.37965264051516, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:12:58,931] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.04 | backward_microstep: 1260.56 | backward_inner_microstep: 1236.44 | backward_allreduce_microstep: 22.75 | step_microstep: 40.65
server.com lassen268: [2022-07-22 10:12:58,934] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.33 | backward: 1260.02 | backward_inner: 1235.91 | backward_allreduce: 22.78 | step: 40.67
server.com lassen268: [2022-07-22 10:13:00,843] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.80 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:13:00,843] [INFO] [logging.py:69:log_dist] [Rank 0] step=25, skipped=0, lr=[5.991676801079446e-05, 5.991676801079446e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:00,844] [INFO] [timer.py:194:stop] 0/25, SamplesPerSec=172.39417911146242, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:00,847] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.24 | backward_microstep: 1259.50 | backward_inner_microstep: 1234.78 | backward_allreduce_microstep: 23.34 | step_microstep: 40.44
server.com lassen268: [2022-07-22 10:13:00,850] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.52 | backward: 1258.96 | backward_inner: 1234.25 | backward_allreduce: 23.37 | step: 40.46
server.com lassen268: [2022-07-22 10:13:02,761] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.99 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:13:02,762] [INFO] [logging.py:69:log_dist] [Rank 0] step=26, skipped=0, lr=[5.99099800569188e-05, 5.99099800569188e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:02,763] [INFO] [timer.py:194:stop] 0/26, SamplesPerSec=172.41065310856968, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:02,766] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.58 | backward_microstep: 1259.98 | backward_inner_microstep: 1235.66 | backward_allreduce_microstep: 22.94 | step_microstep: 40.63
server.com lassen268: [2022-07-22 10:13:02,769] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.88 | backward: 1259.44 | backward_inner: 1235.13 | backward_allreduce: 22.98 | step: 40.65
server.com lassen268: [2022-07-22 10:13:04,675] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.79 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:13:04,676] [INFO] [logging.py:69:log_dist] [Rank 0] step=27, skipped=0, lr=[5.9902926512403986e-05, 5.9902926512403986e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:04,677] [INFO] [timer.py:194:stop] 0/27, SamplesPerSec=172.4385985116943, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:04,680] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.98 | backward_microstep: 1258.58 | backward_inner_microstep: 1233.83 | backward_allreduce_microstep: 23.37 | step_microstep: 40.41
server.com lassen268: [2022-07-22 10:13:04,683] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.25 | backward: 1258.05 | backward_inner: 1233.30 | backward_allreduce: 23.41 | step: 40.43
server.com lassen268: [2022-07-22 10:13:06,593] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.96 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:13:06,594] [INFO] [logging.py:69:log_dist] [Rank 0] step=28, skipped=0, lr=[5.989560744686566e-05, 5.989560744686566e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:06,595] [INFO] [timer.py:194:stop] 0/28, SamplesPerSec=172.44914667429404, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:06,598] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.64 | backward_microstep: 1256.78 | backward_inner_microstep: 1232.42 | backward_allreduce_microstep: 22.99 | step_microstep: 40.60
server.com lassen268: [2022-07-22 10:13:06,601] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.92 | backward: 1256.25 | backward_inner: 1231.89 | backward_allreduce: 23.03 | step: 40.61
server.com lassen268: [2022-07-22 10:13:08,510] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.89 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:13:08,510] [INFO] [logging.py:69:log_dist] [Rank 0] step=29, skipped=0, lr=[5.9888022932540015e-05, 5.9888022932540015e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:08,511] [INFO] [timer.py:194:stop] 0/29, SamplesPerSec=172.48321973365492, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:08,514] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.66 | backward_microstep: 1260.19 | backward_inner_microstep: 1236.45 | backward_allreduce_microstep: 22.38 | step_microstep: 40.52
server.com lassen268: [2022-07-22 10:13:08,518] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.93 | backward: 1259.66 | backward_inner: 1235.92 | backward_allreduce: 22.41 | step: 40.54
server.com lassen268: [2022-07-22 10:13:10,427] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.81 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:13:10,427] [INFO] [logging.py:69:log_dist] [Rank 0] step=30, skipped=0, lr=[5.9880173044283156e-05, 5.9880173044283156e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:10,428] [INFO] [timer.py:194:stop] 0/30, SamplesPerSec=172.4697667748132, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:10,431] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.88 | backward_microstep: 1258.92 | backward_inner_microstep: 1235.63 | backward_allreduce_microstep: 21.93 | step_microstep: 40.52
server.com lassen268: [2022-07-22 10:13:10,434] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.16 | backward: 1258.39 | backward_inner: 1235.10 | backward_allreduce: 21.96 | step: 40.54
server.com lassen268: [2022-07-22 10:13:12,342] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.84 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:13:12,342] [INFO] [logging.py:69:log_dist] [Rank 0] step=31, skipped=0, lr=[5.9872057859570324e-05, 5.9872057859570324e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:12,343] [INFO] [timer.py:194:stop] 0/31, SamplesPerSec=172.50531166672465, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:12,346] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.09 | backward_microstep: 1257.79 | backward_inner_microstep: 1233.32 | backward_allreduce_microstep: 23.10 | step_microstep: 40.42
server.com lassen268: [2022-07-22 10:13:12,349] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.35 | backward: 1257.25 | backward_inner: 1232.79 | backward_allreduce: 23.13 | step: 40.44
server.com lassen268: [2022-07-22 10:13:14,260] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.81 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.28
server.com lassen268: [2022-07-22 10:13:14,260] [INFO] [logging.py:69:log_dist] [Rank 0] step=32, skipped=0, lr=[5.986367745849511e-05, 5.986367745849511e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:14,261] [INFO] [timer.py:194:stop] 0/32, SamplesPerSec=172.4213803904165, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:14,264] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.48 | backward_microstep: 1261.22 | backward_inner_microstep: 1233.59 | backward_allreduce_microstep: 26.26 | step_microstep: 40.37
server.com lassen268: [2022-07-22 10:13:14,268] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.77 | backward: 1260.69 | backward_inner: 1233.06 | backward_allreduce: 26.29 | step: 40.39
server.com lassen268: [2022-07-22 10:13:16,176] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.00 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:13:16,177] [INFO] [logging.py:69:log_dist] [Rank 0] step=33, skipped=0, lr=[5.985503192376867e-05, 5.985503192376867e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:16,177] [INFO] [timer.py:194:stop] 0/33, SamplesPerSec=172.45185669627426, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:16,181] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.58 | backward_microstep: 1258.84 | backward_inner_microstep: 1234.35 | backward_allreduce_microstep: 23.12 | step_microstep: 40.63
server.com lassen268: [2022-07-22 10:13:16,184] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.84 | backward: 1258.31 | backward_inner: 1233.82 | backward_allreduce: 23.15 | step: 40.65
server.com lassen268: [2022-07-22 10:13:18,093] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.83 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:13:18,094] [INFO] [logging.py:69:log_dist] [Rank 0] step=34, skipped=0, lr=[5.984612134071896e-05, 5.984612134071896e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:18,095] [INFO] [timer.py:194:stop] 0/34, SamplesPerSec=172.45282610375065, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:18,098] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.23 | backward_microstep: 1258.53 | backward_inner_microstep: 1234.08 | backward_allreduce_microstep: 23.07 | step_microstep: 40.42
server.com lassen268: [2022-07-22 10:13:18,101] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 554.51 | backward: 1257.99 | backward_inner: 1233.56 | backward_allreduce: 23.10 | step: 40.43
server.com lassen268: [2022-07-22 10:13:20,006] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.01 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:13:20,007] [INFO] [logging.py:69:log_dist] [Rank 0] step=35, skipped=0, lr=[5.983694579728985e-05, 5.983694579728985e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:20,008] [INFO] [timer.py:194:stop] 0/35, SamplesPerSec=172.47877922057492, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:20,011] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.56 | backward_microstep: 1257.36 | backward_inner_microstep: 1232.93 | backward_allreduce_microstep: 23.06 | step_microstep: 40.58
server.com lassen268: [2022-07-22 10:13:20,014] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.82 | backward: 1256.83 | backward_inner: 1232.40 | backward_allreduce: 23.09 | step: 40.60
server.com lassen268: [2022-07-22 10:13:21,919] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.88 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.28
server.com lassen268: [2022-07-22 10:13:21,920] [INFO] [logging.py:69:log_dist] [Rank 0] step=36, skipped=0, lr=[5.982750538404022e-05, 5.982750538404022e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:21,921] [INFO] [timer.py:194:stop] 0/36, SamplesPerSec=172.48937012313098, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:21,924] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.17 | backward_microstep: 1257.74 | backward_inner_microstep: 1233.17 | backward_allreduce_microstep: 23.19 | step_microstep: 40.48
server.com lassen268: [2022-07-22 10:13:21,927] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.45 | backward: 1257.20 | backward_inner: 1232.64 | backward_allreduce: 23.23 | step: 40.50
server.com lassen268: [2022-07-22 10:13:23,836] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.74 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:13:23,837] [INFO] [logging.py:69:log_dist] [Rank 0] step=37, skipped=0, lr=[5.9817800194143165e-05, 5.9817800194143165e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:23,838] [INFO] [timer.py:194:stop] 0/37, SamplesPerSec=172.49056549457606, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:23,841] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.02 | backward_microstep: 1261.23 | backward_inner_microstep: 1236.34 | backward_allreduce_microstep: 23.50 | step_microstep: 40.45
server.com lassen268: [2022-07-22 10:13:23,844] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.28 | backward: 1260.69 | backward_inner: 1235.82 | backward_allreduce: 23.53 | step: 40.47
server.com lassen268: [2022-07-22 10:13:25,754] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.86 | unscale_and_clip: 1.01 | basic_step: 3.84 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:13:25,755] [INFO] [logging.py:69:log_dist] [Rank 0] step=38, skipped=0, lr=[5.9807830323384964e-05, 5.9807830323384964e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:25,756] [INFO] [timer.py:194:stop] 0/38, SamplesPerSec=172.49354798265753, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:25,759] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.48 | backward_microstep: 1261.12 | backward_inner_microstep: 1236.56 | backward_allreduce_microstep: 23.19 | step_microstep: 40.48
server.com lassen268: [2022-07-22 10:13:25,762] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.76 | backward: 1260.58 | backward_inner: 1236.03 | backward_allreduce: 23.22 | step: 40.50
server.com lassen268: [2022-07-22 10:13:27,669] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.82 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:13:27,670] [INFO] [logging.py:69:log_dist] [Rank 0] step=39, skipped=0, lr=[5.979759587016424e-05, 5.979759587016424e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:27,670] [INFO] [timer.py:194:stop] 0/39, SamplesPerSec=172.5097198370882, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:27,674] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.64 | backward_microstep: 1257.50 | backward_inner_microstep: 1233.02 | backward_allreduce_microstep: 23.11 | step_microstep: 40.47
server.com lassen268: [2022-07-22 10:13:27,677] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.91 | backward: 1256.97 | backward_inner: 1232.49 | backward_allreduce: 23.14 | step: 40.49
server.com lassen268: [2022-07-22 10:13:29,586] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.03 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:13:29,587] [INFO] [logging.py:69:log_dist] [Rank 0] step=40, skipped=0, lr=[5.97870969354909e-05, 5.97870969354909e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:29,588] [INFO] [timer.py:194:stop] 0/40, SamplesPerSec=172.50628866681643, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:29,591] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.51 | backward_microstep: 1259.11 | backward_inner_microstep: 1234.21 | backward_allreduce_microstep: 23.52 | step_microstep: 40.63
server.com lassen268: [2022-07-22 10:13:29,594] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.80 | backward: 1258.57 | backward_inner: 1233.68 | backward_allreduce: 23.56 | step: 40.65
server.com lassen268: [2022-07-22 10:13:29,608] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step40/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:13:35,177] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.79 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.27
server.com lassen268: [2022-07-22 10:13:35,178] [INFO] [logging.py:69:log_dist] [Rank 0] step=41, skipped=0, lr=[5.97763336229852e-05, 5.97763336229852e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:35,178] [INFO] [timer.py:194:stop] 0/41, SamplesPerSec=172.53125210431946, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:35,182] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.11 | backward_microstep: 1259.61 | backward_inner_microstep: 1235.15 | backward_allreduce_microstep: 23.08 | step_microstep: 40.38
server.com lassen268: [2022-07-22 10:13:35,185] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.52 | backward: 1259.07 | backward_inner: 1234.62 | backward_allreduce: 23.12 | step: 40.40
server.com lassen268: [2022-07-22 10:13:37,090] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.03 | unscale_and_clip: 1.02 | basic_step: 3.83 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:13:37,090] [INFO] [logging.py:69:log_dist] [Rank 0] step=42, skipped=0, lr=[5.9765306038876676e-05, 5.9765306038876676e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:37,091] [INFO] [timer.py:194:stop] 0/42, SamplesPerSec=172.549589000221, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:37,094] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 552.29 | backward_microstep: 1258.68 | backward_inner_microstep: 1234.39 | backward_allreduce_microstep: 22.92 | step_microstep: 40.63
server.com lassen268: [2022-07-22 10:13:37,097] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 551.70 | backward: 1258.14 | backward_inner: 1233.86 | backward_allreduce: 22.95 | step: 40.65
server.com lassen268: [2022-07-22 10:13:39,002] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.84 | unscale_and_clip: 1.01 | basic_step: 3.84 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:13:39,003] [INFO] [logging.py:69:log_dist] [Rank 0] step=43, skipped=0, lr=[5.975401429200314e-05, 5.975401429200314e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:13:39,003] [INFO] [timer.py:194:stop] 0/43, SamplesPerSec=172.55892890499572, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:13:39,007] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.27 | backward_microstep: 1258.09 | backward_inner_microstep: 1233.63 | backward_allreduce_microstep: 23.09 | step_microstep: 40.56
server.com lassen268: [2022-07-22 10:13:39,010] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.68 | backward: 1257.55 | backward_inner: 1233.11 | backward_allreduce: 23.12 | step: 40.59
server.com lassen268: [2022-07-22 10:14:24,520] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:24,520] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:24,521] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:24,522] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:24,523] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:24,525] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:24,525] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:24,618] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:14:25,759] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:14:28,952] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:14:28,952] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:14:28,952] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:14:28,952] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:28,952] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:28,953] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:28,953] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:14:28,953] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:14:28,953] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:14:28,953] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:28,953] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:14:28,953] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:14:28,953] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:14:28,985] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:14:28,986] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:14:28,986] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 39.73 GB, percent = 12.5%
server.com lassen268: [2022-07-22 10:14:28,987] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:14:28,987] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:28,987] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:28,987] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:14:28,987] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:14:28,988] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:14:28,988] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:14:31,883] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:14:31,883] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:31,883] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:31,883] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:14:31,883] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:14:31,883] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:14:31,883] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:14:31,919] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:14:31,920] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:31,920] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:31,920] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:14:31,920] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:14:31,920] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:14:31,920] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:14:32,084] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:14:32,084] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:32,084] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:32,084] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:14:32,084] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:14:32,084] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:14:32,084] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:14:32,171] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:14:32,172] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:14:32,173] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.38 GB, percent = 12.7%
server.com lassen268: [2022-07-22 10:14:32,179] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:14:32,185] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:14:32,185] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:14:32,185] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:14:32,185] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:14:32,186] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:14:32,186] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:14:32,186] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:14:32,423] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:14:32,424] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:14:32,424] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:14:32,444] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:14:32,444] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:14:32,629] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:14:32,629] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:14:32,629] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x20009d99cb80>
server.com lassen268: [2022-07-22 10:14:32,629] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:14:32,630] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:14:32,630] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:14:32,630] [INFO] [config.py:1055:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
server.com lassen268: [2022-07-22 10:14:32,631] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:14:32,631] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:14:32,631] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:14:32,631] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:14:32,631] [INFO] [config.py:1055:print]   checkpoint_tag_validation_enabled  True
server.com lassen268: [2022-07-22 10:14:32,631] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:14:32,631] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:14:32,632] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 32
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:14:32,633] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x20009d763c10>
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:14:32,634] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:14:32,635] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   train_batch_size ............. 512
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  4
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   world_size ................... 4
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:14:32,636] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:14:32,637] [INFO] [config.py:1057:print]   json = {
server.com lassen268: [2022-07-22 10:14:40,463] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:14:40,464] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:14:40,464] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:14:40,464] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:14:40,464] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:14:45,664] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.19 | overflow_check: 79.18 | unscale_and_clip: 1.09 | basic_step: 3.87 | update_fp16: 2.89
server.com lassen268: [2022-07-22 10:14:45,664] [INFO] [logging.py:69:log_dist] [Rank 0] step=41, skipped=0, lr=[5.9775606671304504e-05, 5.9775606671304504e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:14:45,671] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1972.51 | backward_microstep: 2963.53 | backward_inner_microstep: 2939.81 | backward_allreduce_microstep: 20.77 | step_microstep: 96.68
server.com lassen268: [2022-07-22 10:14:45,678] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1971.20 | backward: 2962.71 | backward_inner: 2938.63 | backward_allreduce: 20.82 | step: 96.72
server.com lassen268: [2022-07-22 10:14:49,736] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.03 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:14:49,736] [INFO] [logging.py:69:log_dist] [Rank 0] step=42, skipped=0, lr=[5.976381573295844e-05, 5.976381573295844e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:14:49,743] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1187.37 | backward_microstep: 2678.48 | backward_inner_microstep: 2654.97 | backward_allreduce_microstep: 20.63 | step_microstep: 40.28
server.com lassen268: [2022-07-22 10:14:49,749] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1186.07 | backward: 2677.50 | backward_inner: 2653.82 | backward_allreduce: 20.67 | step: 40.29
server.com lassen268: [2022-07-22 10:14:53,797] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.01 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.45
server.com lassen268: [2022-07-22 10:14:53,797] [INFO] [logging.py:69:log_dist] [Rank 0] step=43, skipped=0, lr=[5.9751724252857913e-05, 5.9751724252857913e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:14:53,798] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=86.71998056488472, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:14:53,805] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1183.53 | backward_microstep: 2677.32 | backward_inner_microstep: 2653.43 | backward_allreduce_microstep: 21.00 | step_microstep: 41.00
server.com lassen268: [2022-07-22 10:14:53,811] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1182.26 | backward: 2676.34 | backward_inner: 2652.30 | backward_allreduce: 21.04 | step: 41.02
server.com lassen268: [2022-07-22 10:14:57,856] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.98 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:14:57,857] [INFO] [logging.py:69:log_dist] [Rank 0] step=44, skipped=0, lr=[5.973933236678311e-05, 5.973933236678311e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:14:57,858] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=86.88125703551368, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:14:57,864] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1185.11 | backward_microstep: 2672.45 | backward_inner_microstep: 2648.82 | backward_allreduce_microstep: 20.75 | step_microstep: 40.78
server.com lassen268: [2022-07-22 10:14:57,871] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1183.85 | backward: 2671.46 | backward_inner: 2647.68 | backward_allreduce: 20.79 | step: 40.79
server.com lassen268: [2022-07-22 10:15:01,905] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.22 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:15:01,905] [INFO] [logging.py:69:log_dist] [Rank 0] step=45, skipped=0, lr=[5.972664021388752e-05, 5.972664021388752e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:01,906] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=86.84960566945601, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:01,912] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1181.98 | backward_microstep: 2672.82 | backward_inner_microstep: 2649.30 | backward_allreduce_microstep: 20.66 | step_microstep: 41.08
server.com lassen268: [2022-07-22 10:15:01,919] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1180.71 | backward: 2671.82 | backward_inner: 2648.17 | backward_allreduce: 20.70 | step: 41.10
server.com lassen268: [2022-07-22 10:15:05,959] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 23.97 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:15:05,960] [INFO] [logging.py:69:log_dist] [Rank 0] step=46, skipped=0, lr=[5.97136479366965e-05, 5.97136479366965e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:05,960] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=86.95417660185592, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:05,967] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1182.10 | backward_microstep: 2677.03 | backward_inner_microstep: 2653.60 | backward_allreduce_microstep: 20.57 | step_microstep: 40.85
server.com lassen268: [2022-07-22 10:15:05,973] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1180.85 | backward: 2676.03 | backward_inner: 2652.46 | backward_allreduce: 20.61 | step: 40.86
server.com lassen268: [2022-07-22 10:15:10,008] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.91 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:15:10,009] [INFO] [logging.py:69:log_dist] [Rank 0] step=47, skipped=0, lr=[5.970035568110558e-05, 5.970035568110558e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:10,010] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=87.04008632821062, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:10,016] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1181.08 | backward_microstep: 2673.33 | backward_inner_microstep: 2650.20 | backward_allreduce_microstep: 20.28 | step_microstep: 40.77
server.com lassen268: [2022-07-22 10:15:10,023] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1179.81 | backward: 2672.31 | backward_inner: 2649.06 | backward_allreduce: 20.32 | step: 40.78
server.com lassen268: [2022-07-22 10:15:14,057] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.95 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:15:14,058] [INFO] [logging.py:69:log_dist] [Rank 0] step=48, skipped=0, lr=[5.968676359637893e-05, 5.968676359637893e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:14,058] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=87.11409270519084, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:14,065] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1182.31 | backward_microstep: 2672.58 | backward_inner_microstep: 2649.62 | backward_allreduce_microstep: 20.09 | step_microstep: 40.76
server.com lassen268: [2022-07-22 10:15:14,071] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1181.03 | backward: 2671.58 | backward_inner: 2648.49 | backward_allreduce: 20.14 | step: 40.77
server.com lassen268: [2022-07-22 10:15:18,112] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 23.89 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:15:18,113] [INFO] [logging.py:69:log_dist] [Rank 0] step=49, skipped=0, lr=[5.9672871835147554e-05, 5.9672871835147554e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:18,113] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=87.09262839830984, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:18,120] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1182.31 | backward_microstep: 2678.44 | backward_inner_microstep: 2655.19 | backward_allreduce_microstep: 20.38 | step_microstep: 40.79
server.com lassen268: [2022-07-22 10:15:18,126] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1181.05 | backward: 2677.41 | backward_inner: 2654.05 | backward_allreduce: 20.42 | step: 40.80
server.com lassen268: [2022-07-22 10:15:22,172] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.01 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:15:22,172] [INFO] [logging.py:69:log_dist] [Rank 0] step=50, skipped=0, lr=[5.96586805534077e-05, 5.96586805534077e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:22,173] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=87.0990128838571, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:22,179] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1181.54 | backward_microstep: 2671.93 | backward_inner_microstep: 2648.74 | backward_allreduce_microstep: 20.32 | step_microstep: 40.85
server.com lassen268: [2022-07-22 10:15:22,186] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1180.28 | backward: 2670.89 | backward_inner: 2647.60 | backward_allreduce: 20.36 | step: 40.86
server.com lassen268: [2022-07-22 10:15:26,232] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.20 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:15:26,233] [INFO] [logging.py:69:log_dist] [Rank 0] step=51, skipped=0, lr=[5.964418991051903e-05, 5.964418991051903e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:26,234] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=87.07947796700095, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:26,240] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1182.24 | backward_microstep: 2671.19 | backward_inner_microstep: 2647.70 | backward_allreduce_microstep: 20.62 | step_microstep: 41.07
server.com lassen268: [2022-07-22 10:15:26,247] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1180.97 | backward: 2670.16 | backward_inner: 2646.57 | backward_allreduce: 20.66 | step: 41.09
server.com lassen268: [2022-07-22 10:15:30,294] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.97 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:15:30,295] [INFO] [logging.py:69:log_dist] [Rank 0] step=52, skipped=0, lr=[5.962940006920287e-05, 5.962940006920287e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:30,295] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=87.06351748532538, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:30,302] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1184.18 | backward_microstep: 2677.19 | backward_inner_microstep: 2653.60 | backward_allreduce_microstep: 20.72 | step_microstep: 40.85
server.com lassen268: [2022-07-22 10:15:30,308] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1182.91 | backward: 2676.16 | backward_inner: 2652.46 | backward_allreduce: 20.77 | step: 40.86
server.com lassen268: [2022-07-22 10:15:34,358] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.98 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:15:34,359] [INFO] [logging.py:69:log_dist] [Rank 0] step=53, skipped=0, lr=[5.961431119554033e-05, 5.961431119554033e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:34,360] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=87.00095133304481, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:34,366] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1201.01 | backward_microstep: 2673.98 | backward_inner_microstep: 2648.78 | backward_allreduce_microstep: 22.30 | step_microstep: 40.86
server.com lassen268: [2022-07-22 10:15:34,373] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1199.79 | backward: 2672.85 | backward_inner: 2647.63 | backward_allreduce: 22.34 | step: 40.89
server.com lassen268: [2022-07-22 10:15:38,407] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.20 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:15:38,407] [INFO] [logging.py:69:log_dist] [Rank 0] step=54, skipped=0, lr=[5.95989234589705e-05, 5.95989234589705e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:38,408] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=87.02580797847335, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:38,415] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1207.33 | backward_microstep: 2679.92 | backward_inner_microstep: 2657.14 | backward_allreduce_microstep: 19.93 | step_microstep: 41.01
server.com lassen268: [2022-07-22 10:15:38,421] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1206.08 | backward: 2678.74 | backward_inner: 2656.01 | backward_allreduce: 19.95 | step: 41.03
server.com lassen268: [2022-07-22 10:15:42,454] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.19 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:15:42,455] [INFO] [logging.py:69:log_dist] [Rank 0] step=55, skipped=0, lr=[5.958323703228855e-05, 5.958323703228855e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:42,456] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=86.99802442942448, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:42,462] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1205.91 | backward_microstep: 2684.36 | backward_inner_microstep: 2659.98 | backward_allreduce_microstep: 21.43 | step_microstep: 41.07
server.com lassen268: [2022-07-22 10:15:42,469] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1204.65 | backward: 2683.25 | backward_inner: 2658.85 | backward_allreduce: 21.47 | step: 41.09
server.com lassen268: [2022-07-22 10:15:46,511] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.91 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:15:46,511] [INFO] [logging.py:69:log_dist] [Rank 0] step=56, skipped=0, lr=[5.9567252091643696e-05, 5.9567252091643696e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:46,512] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=87.02401041556675, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:46,518] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1211.96 | backward_microstep: 2683.20 | backward_inner_microstep: 2660.21 | backward_allreduce_microstep: 20.11 | step_microstep: 40.80
server.com lassen268: [2022-07-22 10:15:46,525] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1210.71 | backward: 2682.02 | backward_inner: 2659.08 | backward_allreduce: 20.15 | step: 40.82
server.com lassen268: [2022-07-22 10:15:50,565] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.15 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:15:50,565] [INFO] [logging.py:69:log_dist] [Rank 0] step=57, skipped=0, lr=[5.9550968816537354e-05, 5.9550968816537354e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:50,566] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=87.03868650419689, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:50,572] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1209.26 | backward_microstep: 2678.64 | backward_inner_microstep: 2655.70 | backward_allreduce_microstep: 20.07 | step_microstep: 41.02
server.com lassen268: [2022-07-22 10:15:50,579] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1208.04 | backward: 2677.46 | backward_inner: 2654.56 | backward_allreduce: 20.10 | step: 41.04
server.com lassen268: [2022-07-22 10:15:54,614] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.12 | unscale_and_clip: 1.01 | basic_step: 3.88 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:15:54,615] [INFO] [logging.py:69:log_dist] [Rank 0] step=58, skipped=0, lr=[5.953438738982103e-05, 5.953438738982103e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:54,615] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=87.05230847859863, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:54,622] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1212.02 | backward_microstep: 2679.14 | backward_inner_microstep: 2656.14 | backward_allreduce_microstep: 20.14 | step_microstep: 40.92
server.com lassen268: [2022-07-22 10:15:54,628] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1210.83 | backward: 2677.96 | backward_inner: 2655.00 | backward_allreduce: 20.17 | step: 40.93
server.com lassen268: [2022-07-22 10:15:58,658] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.94 | unscale_and_clip: 1.02 | basic_step: 3.90 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:15:58,659] [INFO] [logging.py:69:log_dist] [Rank 0] step=59, skipped=0, lr=[5.951750799769429e-05, 5.951750799769429e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:15:58,660] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=87.07568806429148, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:15:58,666] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1208.99 | backward_microstep: 2681.60 | backward_inner_microstep: 2658.81 | backward_allreduce_microstep: 19.94 | step_microstep: 40.86
server.com lassen268: [2022-07-22 10:15:58,673] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1207.74 | backward: 2680.43 | backward_inner: 2657.68 | backward_allreduce: 19.97 | step: 40.89
server.com lassen268: [2022-07-22 10:16:02,706] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.84 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:16:02,707] [INFO] [logging.py:69:log_dist] [Rank 0] step=60, skipped=0, lr=[5.9500330829702686e-05, 5.9500330829702686e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:16:02,708] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=87.05162781185092, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:16:02,714] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1210.93 | backward_microstep: 2683.02 | backward_inner_microstep: 2658.61 | backward_allreduce_microstep: 21.55 | step_microstep: 40.78
server.com lassen268: [2022-07-22 10:16:02,721] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1209.63 | backward: 2681.84 | backward_inner: 2657.48 | backward_allreduce: 21.58 | step: 40.81
server.com lassen268: [2022-07-22 10:16:02,736] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step60/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:16:09,418] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 25.11 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.59
server.com lassen268: [2022-07-22 10:16:09,418] [INFO] [logging.py:69:log_dist] [Rank 0] step=61, skipped=0, lr=[5.948285607873561e-05, 5.948285607873561e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:16:09,419] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=87.00357848693679, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:16:09,425] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1203.02 | backward_microstep: 2680.82 | backward_inner_microstep: 2656.71 | backward_allreduce_microstep: 21.22 | step_microstep: 42.36
server.com lassen268: [2022-07-22 10:16:09,432] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1201.59 | backward: 2679.63 | backward_inner: 2655.55 | backward_allreduce: 21.25 | step: 42.38
server.com lassen268: [2022-07-22 10:16:13,457] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.14 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:16:13,458] [INFO] [logging.py:69:log_dist] [Rank 0] step=62, skipped=0, lr=[5.9465083941024136e-05, 5.9465083941024136e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:16:13,459] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=87.02351146396292, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:16:13,465] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1191.65 | backward_microstep: 2679.68 | backward_inner_microstep: 2656.99 | backward_allreduce_microstep: 19.83 | step_microstep: 41.03
server.com lassen268: [2022-07-22 10:16:13,472] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1190.46 | backward: 2678.49 | backward_inner: 2655.86 | backward_allreduce: 19.85 | step: 41.05
server.com lassen268: [2022-07-22 10:16:17,502] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.18 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:16:17,502] [INFO] [logging.py:69:log_dist] [Rank 0] step=63, skipped=0, lr=[5.944701461613881e-05, 5.944701461613881e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:16:17,503] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=87.07144902637248, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:16:17,510] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1192.90 | backward_microstep: 2681.77 | backward_inner_microstep: 2658.78 | backward_allreduce_microstep: 20.13 | step_microstep: 41.12
server.com lassen268: [2022-07-22 10:16:17,516] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1191.68 | backward: 2680.59 | backward_inner: 2657.65 | backward_allreduce: 20.16 | step: 41.14
server.com lassen268: [2022-07-22 10:16:21,547] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.18 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:16:21,548] [INFO] [logging.py:69:log_dist] [Rank 0] step=64, skipped=0, lr=[5.942864830698744e-05, 5.942864830698744e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:16:21,549] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=87.08528665395184, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:16:21,555] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1195.22 | backward_microstep: 2683.98 | backward_inner_microstep: 2661.14 | backward_allreduce_microstep: 19.98 | step_microstep: 41.07
server.com lassen268: [2022-07-22 10:16:21,562] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1193.99 | backward: 2682.80 | backward_inner: 2660.00 | backward_allreduce: 20.00 | step: 41.09
server.com lassen268: [2022-07-22 10:17:00,219] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:00,219] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:00,219] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:00,220] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:00,220] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:00,220] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:00,221] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:00,221] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:00,315] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:17:02,008] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:17:10,781] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:17:10,781] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:17:10,781] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:17:10,782] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:10,782] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:10,782] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:17:10,782] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:17:10,782] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:10,782] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:17:10,782] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:10,782] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:10,782] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:10,782] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:17:10,782] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:17:10,782] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:10,782] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:17:10,783] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:10,783] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:17:10,783] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:17:10,783] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:17:10,783] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:10,814] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:17:10,815] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:17:10,816] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 39.88 GB, percent = 12.5%
server.com lassen268: [2022-07-22 10:17:10,816] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:17:10,817] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:10,817] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:10,817] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:17:10,817] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:17:10,817] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:17:10,817] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:13,751] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:17:13,751] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:13,752] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:13,752] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:17:13,752] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:17:13,752] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:17:13,752] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:13,753] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:17:13,753] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:13,753] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:13,753] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:17:13,753] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:17:13,754] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:17:13,754] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:13,763] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:17:13,764] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:13,764] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:13,764] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:17:13,764] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:17:13,764] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:17:13,764] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:14,000] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:17:14,002] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:17:14,002] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.54 GB, percent = 12.7%
server.com lassen268: [2022-07-22 10:17:14,009] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:17:14,014] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:17:14,015] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:17:14,015] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:14,015] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:17:14,015] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:17:14,015] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:17:14,015] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:17:14,649] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:17:14,650] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:17:14,650] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:17:14,670] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:17:14,670] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:17:14,798] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:17:14,798] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:17:14,799] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x2000bd7b5be0>
server.com lassen268: [2022-07-22 10:17:14,799] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:14,800] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:17:14,800] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:17:14,800] [INFO] [config.py:1055:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
server.com lassen268: [2022-07-22 10:17:14,800] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:17:14,800] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:17:14,801] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:17:14,801] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:17:14,801] [INFO] [config.py:1055:print]   checkpoint_tag_validation_enabled  True
server.com lassen268: [2022-07-22 10:17:14,801] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:17:14,801] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:17:14,801] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:17:14,802] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:17:14,803] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 10
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x2000bd763c70>
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:17:14,804] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:17:14,805] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   train_batch_size ............. 480
server.com lassen268: [2022-07-22 10:17:14,806] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  4
server.com lassen268: [2022-07-22 10:17:14,807] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:17:14,807] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:17:14,807] [INFO] [config.py:1055:print]   world_size ................... 12
server.com lassen268: [2022-07-22 10:17:14,807] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:17:14,807] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:17:14,807] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:17:14,807] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:17:14,808] [INFO] [config.py:1057:print]   json = {
server.com lassen268: [2022-07-22 10:17:23,665] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:17:23,665] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:17:23,665] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:17:23,665] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:17:23,665] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:17:26,153] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.04 | overflow_check: 76.31 | unscale_and_clip: 1.08 | basic_step: 3.86 | update_fp16: 2.94
server.com lassen268: [2022-07-22 10:17:26,154] [INFO] [logging.py:69:log_dist] [Rank 0] step=61, skipped=0, lr=[5.9483956965226205e-05, 5.9483956965226205e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:26,156] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1135.56 | backward_microstep: 1138.09 | backward_inner_microstep: 1108.25 | backward_allreduce_microstep: 28.85 | step_microstep: 93.68
server.com lassen268: [2022-07-22 10:17:26,159] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1135.14 | backward: 1137.72 | backward_inner: 1107.88 | backward_allreduce: 28.89 | step: 93.69
server.com lassen268: [2022-07-22 10:17:27,501] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.40 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:17:27,502] [INFO] [logging.py:69:log_dist] [Rank 0] step=62, skipped=0, lr=[5.946732171478649e-05, 5.946732171478649e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:27,504] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.18 | backward_microstep: 868.93 | backward_inner_microstep: 836.58 | backward_allreduce_microstep: 31.36 | step_microstep: 40.73
server.com lassen268: [2022-07-22 10:17:27,506] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.77 | backward: 868.57 | backward_inner: 836.21 | backward_allreduce: 31.39 | step: 40.74
server.com lassen268: [2022-07-22 10:17:28,837] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:17:28,837] [INFO] [logging.py:69:log_dist] [Rank 0] step=63, skipped=0, lr=[5.945042524256674e-05, 5.945042524256674e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:28,838] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=244.24687391950502, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:28,840] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.38 | backward_microstep: 857.96 | backward_inner_microstep: 828.34 | backward_allreduce_microstep: 28.66 | step_microstep: 41.17
server.com lassen268: [2022-07-22 10:17:28,842] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.98 | backward: 857.60 | backward_inner: 827.98 | backward_allreduce: 28.70 | step: 41.20
server.com lassen268: [2022-07-22 10:17:30,152] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.30 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:17:30,152] [INFO] [logging.py:69:log_dist] [Rank 0] step=64, skipped=0, lr=[5.94332677153283e-05, 5.94332677153283e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:30,153] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=247.1261017477597, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:30,155] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.21 | backward_microstep: 856.82 | backward_inner_microstep: 827.36 | backward_allreduce_microstep: 28.50 | step_microstep: 41.16
server.com lassen268: [2022-07-22 10:17:30,157] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.81 | backward: 856.47 | backward_inner: 827.00 | backward_allreduce: 28.53 | step: 41.19
server.com lassen268: [2022-07-22 10:17:31,475] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:17:31,476] [INFO] [logging.py:69:log_dist] [Rank 0] step=65, skipped=0, lr=[5.941584930240907e-05, 5.941584930240907e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:31,476] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=247.6877029189989, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:31,479] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.22 | backward_microstep: 857.94 | backward_inner_microstep: 827.71 | backward_allreduce_microstep: 29.29 | step_microstep: 41.19
server.com lassen268: [2022-07-22 10:17:31,481] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.82 | backward: 857.59 | backward_inner: 827.35 | backward_allreduce: 29.33 | step: 41.21
server.com lassen268: [2022-07-22 10:17:32,789] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.21 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:17:32,790] [INFO] [logging.py:69:log_dist] [Rank 0] step=66, skipped=0, lr=[5.9398170175721716e-05, 5.9398170175721716e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:32,790] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=248.43625468571506, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:32,792] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.26 | backward_microstep: 856.62 | backward_inner_microstep: 827.09 | backward_allreduce_microstep: 28.57 | step_microstep: 41.01
server.com lassen268: [2022-07-22 10:17:32,795] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.86 | backward: 856.27 | backward_inner: 826.73 | backward_allreduce: 28.61 | step: 41.03
server.com lassen268: [2022-07-22 10:17:34,104] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.24 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:17:34,105] [INFO] [logging.py:69:log_dist] [Rank 0] step=67, skipped=0, lr=[5.938023050975212e-05, 5.938023050975212e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:34,106] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=248.09534278230333, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:34,108] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.16 | backward_microstep: 859.18 | backward_inner_microstep: 827.38 | backward_allreduce_microstep: 30.85 | step_microstep: 41.09
server.com lassen268: [2022-07-22 10:17:34,110] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.76 | backward: 858.84 | backward_inner: 827.03 | backward_allreduce: 30.88 | step: 41.12
server.com lassen268: [2022-07-22 10:17:35,437] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.92 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:17:35,437] [INFO] [logging.py:69:log_dist] [Rank 0] step=68, skipped=0, lr=[5.936203048155751e-05, 5.936203048155751e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:35,438] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=247.99631606382175, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:35,440] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.27 | backward_microstep: 859.04 | backward_inner_microstep: 826.92 | backward_allreduce_microstep: 31.18 | step_microstep: 40.71
server.com lassen268: [2022-07-22 10:17:35,442] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.88 | backward: 858.69 | backward_inner: 826.56 | backward_allreduce: 31.22 | step: 40.73
server.com lassen268: [2022-07-22 10:17:36,757] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.02 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:17:36,758] [INFO] [logging.py:69:log_dist] [Rank 0] step=69, skipped=0, lr=[5.934357027076483e-05, 5.934357027076483e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:36,758] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=248.3259715256665, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:36,761] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.33 | backward_microstep: 856.93 | backward_inner_microstep: 827.27 | backward_allreduce_microstep: 28.71 | step_microstep: 40.78
server.com lassen268: [2022-07-22 10:17:36,763] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.93 | backward: 856.58 | backward_inner: 826.91 | backward_allreduce: 28.74 | step: 40.81
server.com lassen268: [2022-07-22 10:17:38,073] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.86 | overflow_check: 24.23 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:17:38,074] [INFO] [logging.py:69:log_dist] [Rank 0] step=70, skipped=0, lr=[5.932485005956891e-05, 5.932485005956891e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:38,074] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=248.56400650033103, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:38,077] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.53 | backward_microstep: 856.39 | backward_inner_microstep: 826.72 | backward_allreduce_microstep: 28.72 | step_microstep: 41.08
server.com lassen268: [2022-07-22 10:17:38,079] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 371.13 | backward: 856.04 | backward_inner: 826.36 | backward_allreduce: 28.76 | step: 41.10
server.com lassen268: [2022-07-22 10:17:39,388] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.08 | unscale_and_clip: 1.01 | basic_step: 3.85 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:17:39,388] [INFO] [logging.py:69:log_dist] [Rank 0] step=71, skipped=0, lr=[5.9305870032730677e-05, 5.9305870032730677e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:39,389] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=248.10757932416902, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:39,391] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.40 | backward_microstep: 863.00 | backward_inner_microstep: 835.24 | backward_allreduce_microstep: 26.82 | step_microstep: 40.92
server.com lassen268: [2022-07-22 10:17:39,393] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.01 | backward: 862.65 | backward_inner: 834.88 | backward_allreduce: 26.85 | step: 40.95
server.com lassen268: [2022-07-22 10:17:40,698] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.21 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:17:40,699] [INFO] [logging.py:69:log_dist] [Rank 0] step=72, skipped=0, lr=[5.928663037757532e-05, 5.928663037757532e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:40,699] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=248.45037300889567, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:40,702] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.93 | backward_microstep: 857.10 | backward_inner_microstep: 827.54 | backward_allreduce_microstep: 28.61 | step_microstep: 40.99
server.com lassen268: [2022-07-22 10:17:40,704] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.53 | backward: 856.75 | backward_inner: 827.18 | backward_allreduce: 28.65 | step: 41.02
server.com lassen268: [2022-07-22 10:17:42,009] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.23 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:17:42,010] [INFO] [logging.py:69:log_dist] [Rank 0] step=73, skipped=0, lr=[5.92671312839905e-05, 5.92671312839905e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:42,011] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=248.68853155247817, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:42,013] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.84 | backward_microstep: 856.44 | backward_inner_microstep: 827.12 | backward_allreduce_microstep: 28.37 | step_microstep: 41.06
server.com lassen268: [2022-07-22 10:17:42,015] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.44 | backward: 856.09 | backward_inner: 826.76 | backward_allreduce: 28.41 | step: 41.08
server.com lassen268: [2022-07-22 10:17:43,321] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 23.99 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:17:43,322] [INFO] [logging.py:69:log_dist] [Rank 0] step=74, skipped=0, lr=[5.924737294442435e-05, 5.924737294442435e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:43,322] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=248.76051684199072, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:43,325] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.99 | backward_microstep: 860.25 | backward_inner_microstep: 830.14 | backward_allreduce_microstep: 29.17 | step_microstep: 40.84
server.com lassen268: [2022-07-22 10:17:43,327] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.60 | backward: 859.90 | backward_inner: 829.78 | backward_allreduce: 29.20 | step: 40.87
server.com lassen268: [2022-07-22 10:17:44,634] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.19 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:17:44,634] [INFO] [logging.py:69:log_dist] [Rank 0] step=75, skipped=0, lr=[5.9227355553883747e-05, 5.9227355553883747e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:44,635] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=248.80012464505108, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:44,637] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.40 | backward_microstep: 856.59 | backward_inner_microstep: 826.09 | backward_allreduce_microstep: 29.55 | step_microstep: 41.00
server.com lassen268: [2022-07-22 10:17:44,639] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.01 | backward: 856.24 | backward_inner: 825.73 | backward_allreduce: 29.59 | step: 41.02
server.com lassen268: [2022-07-22 10:17:45,947] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.19 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:17:45,948] [INFO] [logging.py:69:log_dist] [Rank 0] step=76, skipped=0, lr=[5.920707930993223e-05, 5.920707930993223e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:45,948] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=248.9234601849255, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:45,951] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.81 | backward_microstep: 857.25 | backward_inner_microstep: 827.57 | backward_allreduce_microstep: 28.73 | step_microstep: 40.97
server.com lassen268: [2022-07-22 10:17:45,953] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.42 | backward: 856.90 | backward_inner: 827.21 | backward_allreduce: 28.77 | step: 41.00
server.com lassen268: [2022-07-22 10:17:47,260] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.26 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:17:47,261] [INFO] [logging.py:69:log_dist] [Rank 0] step=77, skipped=0, lr=[5.918654441268816e-05, 5.918654441268816e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:47,261] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=248.97873089807493, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:47,264] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.01 | backward_microstep: 857.27 | backward_inner_microstep: 827.33 | backward_allreduce_microstep: 28.99 | step_microstep: 41.08
server.com lassen268: [2022-07-22 10:17:47,266] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.62 | backward: 856.91 | backward_inner: 826.97 | backward_allreduce: 29.03 | step: 41.11
server.com lassen268: [2022-07-22 10:17:48,577] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.19 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:17:48,578] [INFO] [logging.py:69:log_dist] [Rank 0] step=78, skipped=0, lr=[5.916575106482266e-05, 5.916575106482266e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:48,578] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=249.00459029978177, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:48,581] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.85 | backward_microstep: 855.92 | backward_inner_microstep: 826.24 | backward_allreduce_microstep: 28.72 | step_microstep: 41.05
server.com lassen268: [2022-07-22 10:17:48,583] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.45 | backward: 855.57 | backward_inner: 825.89 | backward_allreduce: 28.77 | step: 41.08
server.com lassen268: [2022-07-22 10:17:49,890] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.03 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:17:49,891] [INFO] [logging.py:69:log_dist] [Rank 0] step=79, skipped=0, lr=[5.91446994715577e-05, 5.91446994715577e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:49,892] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=249.1949297958118, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:49,894] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.95 | backward_microstep: 857.73 | backward_inner_microstep: 827.89 | backward_allreduce_microstep: 28.89 | step_microstep: 40.93
server.com lassen268: [2022-07-22 10:17:49,896] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.56 | backward: 857.38 | backward_inner: 827.53 | backward_allreduce: 28.93 | step: 40.95
server.com lassen268: [2022-07-22 10:17:51,207] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.05 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:17:51,208] [INFO] [logging.py:69:log_dist] [Rank 0] step=80, skipped=0, lr=[5.9123389840664005e-05, 5.9123389840664005e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:51,208] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=249.2900708856388, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:51,211] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.86 | backward_microstep: 861.14 | backward_inner_microstep: 831.74 | backward_allreduce_microstep: 28.45 | step_microstep: 40.91
server.com lassen268: [2022-07-22 10:17:51,213] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.47 | backward: 860.79 | backward_inner: 831.39 | backward_allreduce: 28.49 | step: 40.93
server.com lassen268: [2022-07-22 10:17:51,228] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step80/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:17:56,372] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.12 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:17:56,372] [INFO] [logging.py:69:log_dist] [Rank 0] step=81, skipped=0, lr=[5.910182238245901e-05, 5.910182238245901e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:56,373] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=249.2675997267783, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:56,375] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.04 | backward_microstep: 861.07 | backward_inner_microstep: 829.97 | backward_allreduce_microstep: 30.16 | step_microstep: 41.00
server.com lassen268: [2022-07-22 10:17:56,377] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.64 | backward: 860.72 | backward_inner: 829.62 | backward_allreduce: 30.18 | step: 41.03
server.com lassen268: [2022-07-22 10:17:57,681] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.24 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:17:57,682] [INFO] [logging.py:69:log_dist] [Rank 0] step=82, skipped=0, lr=[5.9079997309804844e-05, 5.9079997309804844e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:57,683] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=249.33098458983847, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:57,685] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.07 | backward_microstep: 859.26 | backward_inner_microstep: 829.77 | backward_allreduce_microstep: 28.55 | step_microstep: 41.08
server.com lassen268: [2022-07-22 10:17:57,687] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.69 | backward: 858.92 | backward_inner: 829.42 | backward_allreduce: 28.58 | step: 41.11
server.com lassen268: [2022-07-22 10:17:58,994] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.04 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:17:58,994] [INFO] [logging.py:69:log_dist] [Rank 0] step=83, skipped=0, lr=[5.905791483810615e-05, 5.905791483810615e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:17:58,995] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=249.38312370017672, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:17:58,997] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.95 | backward_microstep: 858.76 | backward_inner_microstep: 828.87 | backward_allreduce_microstep: 28.95 | step_microstep: 40.85
server.com lassen268: [2022-07-22 10:17:58,999] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.56 | backward: 858.41 | backward_inner: 828.51 | backward_allreduce: 28.98 | step: 40.87
server.com lassen268: [2022-07-22 10:18:00,307] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 23.97 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:18:00,307] [INFO] [logging.py:69:log_dist] [Rank 0] step=84, skipped=0, lr=[5.9035575185308e-05, 5.9035575185308e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:18:00,308] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=249.42507775694847, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:18:00,310] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.35 | backward_microstep: 857.31 | backward_inner_microstep: 827.70 | backward_allreduce_microstep: 28.66 | step_microstep: 40.86
server.com lassen268: [2022-07-22 10:18:00,312] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.95 | backward: 856.96 | backward_inner: 827.35 | backward_allreduce: 28.70 | step: 40.88
server.com lassen268: [2022-07-22 10:18:01,627] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.01 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:18:01,628] [INFO] [logging.py:69:log_dist] [Rank 0] step=85, skipped=0, lr=[5.901297857189376e-05, 5.901297857189376e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:18:01,628] [INFO] [timer.py:194:stop] 0/25, SamplesPerSec=249.49866632642326, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:18:01,631] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.42 | backward_microstep: 861.96 | backward_inner_microstep: 832.74 | backward_allreduce_microstep: 28.26 | step_microstep: 40.90
server.com lassen268: [2022-07-22 10:18:01,633] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 371.03 | backward: 861.61 | backward_inner: 832.39 | backward_allreduce: 28.30 | step: 40.93
server.com lassen268: [2022-07-22 10:18:02,939] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.21 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:18:02,939] [INFO] [logging.py:69:log_dist] [Rank 0] step=86, skipped=0, lr=[5.8990125220882873e-05, 5.8990125220882873e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:18:02,940] [INFO] [timer.py:194:stop] 0/26, SamplesPerSec=249.57328914415913, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:18:02,942] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.17 | backward_microstep: 858.80 | backward_inner_microstep: 829.50 | backward_allreduce_microstep: 28.35 | step_microstep: 41.12
server.com lassen268: [2022-07-22 10:18:02,944] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.78 | backward: 858.45 | backward_inner: 829.14 | backward_allreduce: 28.38 | step: 41.15
server.com lassen268: [2022-07-22 10:18:04,249] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.04 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:18:04,249] [INFO] [logging.py:69:log_dist] [Rank 0] step=87, skipped=0, lr=[5.8967015357828703e-05, 5.8967015357828703e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:18:04,250] [INFO] [timer.py:194:stop] 0/27, SamplesPerSec=249.61247852909517, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:18:04,252] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.02 | backward_microstep: 856.45 | backward_inner_microstep: 826.76 | backward_allreduce_microstep: 28.74 | step_microstep: 40.87
server.com lassen268: [2022-07-22 10:18:04,255] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.63 | backward: 856.10 | backward_inner: 826.40 | backward_allreduce: 28.78 | step: 40.90
server.com lassen268: [2022-07-22 10:18:05,565] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.22 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:18:05,566] [INFO] [logging.py:69:log_dist] [Rank 0] step=88, skipped=0, lr=[5.894364921081626e-05, 5.894364921081626e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:18:05,566] [INFO] [timer.py:194:stop] 0/28, SamplesPerSec=249.52795506630292, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:18:05,568] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.87 | backward_microstep: 858.63 | backward_inner_microstep: 827.19 | backward_allreduce_microstep: 30.50 | step_microstep: 41.01
server.com lassen268: [2022-07-22 10:18:05,571] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.48 | backward: 858.29 | backward_inner: 826.83 | backward_allreduce: 30.54 | step: 41.03
server.com lassen268: [2022-07-22 10:18:06,876] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.02 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.47
server.com lassen268: [2022-07-22 10:18:06,876] [INFO] [logging.py:69:log_dist] [Rank 0] step=89, skipped=0, lr=[5.8920027010459975e-05, 5.8920027010459975e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:18:06,877] [INFO] [timer.py:194:stop] 0/29, SamplesPerSec=249.54691138630338, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:18:06,879] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.96 | backward_microstep: 857.54 | backward_inner_microstep: 827.66 | backward_allreduce_microstep: 28.93 | step_microstep: 40.93
server.com lassen268: [2022-07-22 10:18:06,881] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.57 | backward: 857.19 | backward_inner: 827.30 | backward_allreduce: 28.97 | step: 40.96
server.com lassen268: [2022-07-22 10:19:00,684] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:00,684] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:00,685] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:00,685] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:00,685] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:00,687] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:00,687] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:00,779] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:19:02,085] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:19:07,976] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:19:07,976] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:19:07,976] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:07,977] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:19:07,977] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:08,032] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:19:08,033] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:19:08,033] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 39.88 GB, percent = 12.5%
server.com lassen268: [2022-07-22 10:19:08,034] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:19:08,035] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:08,035] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:08,035] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:19:08,035] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:19:08,035] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:19:08,035] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:10,945] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:19:10,945] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:10,945] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:10,945] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:19:10,945] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:19:10,945] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:19:10,946] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:10,951] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:19:10,952] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:10,952] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:10,952] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:19:10,952] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:19:10,952] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:19:10,952] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:10,953] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:19:10,954] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:10,954] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:10,954] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:19:10,954] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:19:10,954] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:19:10,954] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:11,220] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:19:11,222] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:19:11,222] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.56 GB, percent = 12.7%
server.com lassen268: [2022-07-22 10:19:11,229] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:19:11,234] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:19:11,234] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:19:11,234] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:11,234] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:19:11,235] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:19:11,235] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:19:11,235] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:19:11,617] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:19:11,617] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:19:11,617] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:19:11,637] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:19:11,637] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:19:11,712] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:19:11,712] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:19:11,712] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x20006d99eac0>
server.com lassen268: [2022-07-22 10:19:11,712] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:11,713] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:19:11,713] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:19:11,713] [INFO] [config.py:1055:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
server.com lassen268: [2022-07-22 10:19:11,714] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:19:11,714] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:19:11,714] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:19:11,714] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:19:11,714] [INFO] [config.py:1055:print]   checkpoint_tag_validation_enabled  True
server.com lassen268: [2022-07-22 10:19:11,714] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:19:11,714] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:19:11,715] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 15
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:19:11,716] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x20006d760c10>
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:19:11,717] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   train_batch_size ............. 480
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  4
server.com lassen268: [2022-07-22 10:19:11,718] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:19:11,719] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:19:11,719] [INFO] [config.py:1055:print]   world_size ................... 8
server.com lassen268: [2022-07-22 10:19:11,719] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:19:11,719] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:19:11,719] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:19:11,719] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:19:11,719] [INFO] [config.py:1057:print]   json = {
server.com lassen268: [2022-07-22 10:19:22,161] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:19:22,162] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:19:22,162] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:19:22,162] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:19:22,162] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:19:25,211] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.17 | overflow_check: 77.05 | unscale_and_clip: 1.06 | basic_step: 3.87 | update_fp16: 3.23
server.com lassen268: [2022-07-22 10:19:25,212] [INFO] [logging.py:69:log_dist] [Rank 0] step=81, skipped=0, lr=[5.910182238245901e-05, 5.910182238245901e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:25,215] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1343.69 | backward_microstep: 1561.10 | backward_inner_microstep: 1531.78 | backward_allreduce_microstep: 27.85 | step_microstep: 95.19
server.com lassen268: [2022-07-22 10:19:25,219] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1343.07 | backward: 1560.55 | backward_inner: 1531.22 | backward_allreduce: 27.89 | step: 95.19
server.com lassen268: [2022-07-22 10:19:27,180] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.29 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.43
server.com lassen268: [2022-07-22 10:19:27,181] [INFO] [logging.py:69:log_dist] [Rank 0] step=82, skipped=0, lr=[5.9079997309804844e-05, 5.9079997309804844e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:27,184] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.42 | backward_microstep: 1270.34 | backward_inner_microstep: 1245.73 | backward_allreduce_microstep: 23.12 | step_microstep: 40.90
server.com lassen268: [2022-07-22 10:19:27,187] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.82 | backward: 1269.83 | backward_inner: 1245.18 | backward_allreduce: 23.19 | step: 40.92
server.com lassen268: [2022-07-22 10:19:29,111] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.51 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:19:29,112] [INFO] [logging.py:69:log_dist] [Rank 0] step=83, skipped=0, lr=[5.905791483810615e-05, 5.905791483810615e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:29,112] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=171.46136560775793, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:29,116] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.60 | backward_microstep: 1263.58 | backward_inner_microstep: 1239.27 | backward_allreduce_microstep: 22.91 | step_microstep: 41.38
server.com lassen268: [2022-07-22 10:19:29,119] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.00 | backward: 1263.03 | backward_inner: 1238.72 | backward_allreduce: 22.95 | step: 41.39
server.com lassen268: [2022-07-22 10:19:31,070] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.10 | overflow_check: 24.39 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.86
server.com lassen268: [2022-07-22 10:19:31,070] [INFO] [logging.py:69:log_dist] [Rank 0] step=84, skipped=0, lr=[5.9035575185308e-05, 5.9035575185308e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:31,071] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=168.2456663973671, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:31,074] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.23 | backward_microstep: 1275.89 | backward_inner_microstep: 1249.92 | backward_allreduce_microstep: 24.47 | step_microstep: 42.38
server.com lassen268: [2022-07-22 10:19:31,078] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.63 | backward: 1275.39 | backward_inner: 1249.38 | backward_allreduce: 24.51 | step: 42.40
server.com lassen268: [2022-07-22 10:19:32,999] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.26 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:19:33,000] [INFO] [logging.py:69:log_dist] [Rank 0] step=85, skipped=0, lr=[5.901297857189376e-05, 5.901297857189376e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:33,000] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=169.56231413144272, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:33,004] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.55 | backward_microstep: 1261.84 | backward_inner_microstep: 1237.47 | backward_allreduce_microstep: 22.98 | step_microstep: 41.07
server.com lassen268: [2022-07-22 10:19:33,007] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.96 | backward: 1261.30 | backward_inner: 1236.94 | backward_allreduce: 23.01 | step: 41.08
server.com lassen268: [2022-07-22 10:19:34,926] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.41 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:19:34,927] [INFO] [logging.py:69:log_dist] [Rank 0] step=86, skipped=0, lr=[5.8990125220882873e-05, 5.8990125220882873e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:34,928] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=170.15113878131717, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:34,931] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.79 | backward_microstep: 1263.15 | backward_inner_microstep: 1238.63 | backward_allreduce_microstep: 23.14 | step_microstep: 41.29
server.com lassen268: [2022-07-22 10:19:34,934] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.20 | backward: 1262.61 | backward_inner: 1238.09 | backward_allreduce: 23.17 | step: 41.30
server.com lassen268: [2022-07-22 10:19:36,853] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.36 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:19:36,853] [INFO] [logging.py:69:log_dist] [Rank 0] step=87, skipped=0, lr=[5.8967015357828703e-05, 5.8967015357828703e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:36,854] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=170.54934286182626, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:36,857] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.58 | backward_microstep: 1262.60 | backward_inner_microstep: 1238.37 | backward_allreduce_microstep: 22.84 | step_microstep: 41.28
server.com lassen268: [2022-07-22 10:19:36,860] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.99 | backward: 1262.06 | backward_inner: 1237.84 | backward_allreduce: 22.88 | step: 41.29
server.com lassen268: [2022-07-22 10:19:38,777] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:19:38,778] [INFO] [logging.py:69:log_dist] [Rank 0] step=88, skipped=0, lr=[5.894364921081626e-05, 5.894364921081626e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:38,779] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=170.83954850177682, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:38,782] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.03 | backward_microstep: 1261.93 | backward_inner_microstep: 1237.55 | backward_allreduce_microstep: 23.00 | step_microstep: 41.17
server.com lassen268: [2022-07-22 10:19:38,785] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.45 | backward: 1261.39 | backward_inner: 1237.01 | backward_allreduce: 23.03 | step: 41.18
server.com lassen268: [2022-07-22 10:19:40,708] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.39 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:19:40,708] [INFO] [logging.py:69:log_dist] [Rank 0] step=89, skipped=0, lr=[5.8920027010459975e-05, 5.8920027010459975e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:40,709] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=170.9934942238623, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:40,712] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.77 | backward_microstep: 1267.11 | backward_inner_microstep: 1242.65 | backward_allreduce_microstep: 23.08 | step_microstep: 41.27
server.com lassen268: [2022-07-22 10:19:40,715] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 555.19 | backward: 1266.57 | backward_inner: 1242.11 | backward_allreduce: 23.11 | step: 41.28
server.com lassen268: [2022-07-22 10:19:42,633] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:19:42,633] [INFO] [logging.py:69:log_dist] [Rank 0] step=90, skipped=0, lr=[5.8896148989901444e-05, 5.8896148989901444e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:42,634] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=170.99256449394971, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:42,637] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.25 | backward_microstep: 1265.35 | backward_inner_microstep: 1240.05 | backward_allreduce_microstep: 23.91 | step_microstep: 41.21
server.com lassen268: [2022-07-22 10:19:42,640] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.67 | backward: 1264.81 | backward_inner: 1239.52 | backward_allreduce: 23.95 | step: 41.22
server.com lassen268: [2022-07-22 10:19:44,558] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.36 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:19:44,559] [INFO] [logging.py:69:log_dist] [Rank 0] step=91, skipped=0, lr=[5.887201538480708e-05, 5.887201538480708e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:44,559] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=171.12844030328716, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:44,562] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.96 | backward_microstep: 1262.06 | backward_inner_microstep: 1237.89 | backward_allreduce_microstep: 22.79 | step_microstep: 41.17
server.com lassen268: [2022-07-22 10:19:44,566] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.38 | backward: 1261.52 | backward_inner: 1237.35 | backward_allreduce: 22.82 | step: 41.18
server.com lassen268: [2022-07-22 10:19:46,489] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.40 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:19:46,489] [INFO] [logging.py:69:log_dist] [Rank 0] step=92, skipped=0, lr=[5.8847626433365807e-05, 5.8847626433365807e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:46,490] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=171.21606411972826, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:46,493] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.63 | backward_microstep: 1263.30 | backward_inner_microstep: 1238.88 | backward_allreduce_microstep: 23.03 | step_microstep: 41.29
server.com lassen268: [2022-07-22 10:19:46,496] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.04 | backward: 1262.77 | backward_inner: 1238.34 | backward_allreduce: 23.07 | step: 41.31
server.com lassen268: [2022-07-22 10:19:48,416] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.34 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:19:48,417] [INFO] [logging.py:69:log_dist] [Rank 0] step=93, skipped=0, lr=[5.882298237628676e-05, 5.882298237628676e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:48,417] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=171.29124122642807, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:48,421] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.85 | backward_microstep: 1265.90 | backward_inner_microstep: 1241.41 | backward_allreduce_microstep: 23.10 | step_microstep: 41.26
server.com lassen268: [2022-07-22 10:19:48,424] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.26 | backward: 1265.35 | backward_inner: 1240.88 | backward_allreduce: 23.14 | step: 41.27
server.com lassen268: [2022-07-22 10:19:50,346] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.37 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:19:50,347] [INFO] [logging.py:69:log_dist] [Rank 0] step=94, skipped=0, lr=[5.879808345679683e-05, 5.879808345679683e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:50,347] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=171.36223451352384, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:50,351] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.76 | backward_microstep: 1264.05 | backward_inner_microstep: 1239.56 | backward_allreduce_microstep: 23.11 | step_microstep: 41.21
server.com lassen268: [2022-07-22 10:19:50,354] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.18 | backward: 1263.51 | backward_inner: 1239.03 | backward_allreduce: 23.14 | step: 41.22
server.com lassen268: [2022-07-22 10:19:52,273] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.31 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:19:52,274] [INFO] [logging.py:69:log_dist] [Rank 0] step=95, skipped=0, lr=[5.877292992063827e-05, 5.877292992063827e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:52,275] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=171.25561446644963, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:52,278] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.23 | backward_microstep: 1263.22 | backward_inner_microstep: 1238.69 | backward_allreduce_microstep: 23.15 | step_microstep: 41.17
server.com lassen268: [2022-07-22 10:19:52,281] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.64 | backward: 1262.68 | backward_inner: 1238.16 | backward_allreduce: 23.19 | step: 41.18
server.com lassen268: [2022-07-22 10:19:54,196] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.90 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:19:54,197] [INFO] [logging.py:69:log_dist] [Rank 0] step=96, skipped=0, lr=[5.8747522016066344e-05, 5.8747522016066344e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:54,198] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=171.3442282002205, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:54,201] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.61 | backward_microstep: 1262.59 | backward_inner_microstep: 1238.19 | backward_allreduce_microstep: 23.02 | step_microstep: 41.20
server.com lassen268: [2022-07-22 10:19:54,204] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.03 | backward: 1262.05 | backward_inner: 1237.66 | backward_allreduce: 23.05 | step: 41.21
server.com lassen268: [2022-07-22 10:19:56,127] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.37 | unscale_and_clip: 1.01 | basic_step: 3.88 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:19:56,128] [INFO] [logging.py:69:log_dist] [Rank 0] step=97, skipped=0, lr=[5.872185999384683e-05, 5.872185999384683e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:56,128] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=171.25634172976854, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:56,132] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.19 | backward_microstep: 1262.41 | backward_inner_microstep: 1238.01 | backward_allreduce_microstep: 23.00 | step_microstep: 41.18
server.com lassen268: [2022-07-22 10:19:56,135] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 554.61 | backward: 1261.86 | backward_inner: 1237.48 | backward_allreduce: 23.04 | step: 41.19
server.com lassen268: [2022-07-22 10:19:58,055] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.37 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:19:58,056] [INFO] [logging.py:69:log_dist] [Rank 0] step=98, skipped=0, lr=[5.869594410725351e-05, 5.869594410725351e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:58,057] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=171.07534422652762, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:58,060] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.03 | backward_microstep: 1266.69 | backward_inner_microstep: 1238.02 | backward_allreduce_microstep: 27.28 | step_microstep: 41.20
server.com lassen268: [2022-07-22 10:19:58,063] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.44 | backward: 1266.15 | backward_inner: 1237.48 | backward_allreduce: 27.32 | step: 41.21
server.com lassen268: [2022-07-22 10:19:59,980] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.40 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:19:59,981] [INFO] [logging.py:69:log_dist] [Rank 0] step=99, skipped=0, lr=[5.866977461206571e-05, 5.866977461206571e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:19:59,981] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=171.13197134356855, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:19:59,984] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.48 | backward_microstep: 1262.54 | backward_inner_microstep: 1238.04 | backward_allreduce_microstep: 23.10 | step_microstep: 41.26
server.com lassen268: [2022-07-22 10:19:59,988] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 552.90 | backward: 1261.99 | backward_inner: 1237.51 | backward_allreduce: 23.13 | step: 41.28
server.com lassen268: [2022-07-22 10:20:01,906] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.62 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:20:01,906] [INFO] [logging.py:69:log_dist] [Rank 0] step=100, skipped=0, lr=[5.86433517665658e-05, 5.86433517665658e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:01,907] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=171.1798879570279, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:01,910] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 553.99 | backward_microstep: 1266.67 | backward_inner_microstep: 1242.50 | backward_allreduce_microstep: 22.79 | step_microstep: 41.65
server.com lassen268: [2022-07-22 10:20:01,913] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.41 | backward: 1266.13 | backward_inner: 1241.97 | backward_allreduce: 22.82 | step: 41.66
server.com lassen268: [2022-07-22 10:20:01,929] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step100/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:20:06,762] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.44 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:20:06,763] [INFO] [logging.py:69:log_dist] [Rank 0] step=101, skipped=0, lr=[5.8616675831536604e-05, 5.8616675831536604e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:06,763] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=171.2375000478432, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:06,767] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 556.59 | backward_microstep: 1267.78 | backward_inner_microstep: 1244.23 | backward_allreduce_microstep: 22.15 | step_microstep: 41.39
server.com lassen268: [2022-07-22 10:20:06,770] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 556.00 | backward: 1267.23 | backward_inner: 1243.69 | backward_allreduce: 22.18 | step: 41.40
server.com lassen268: [2022-07-22 10:20:08,686] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.39 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.43
server.com lassen268: [2022-07-22 10:20:08,687] [INFO] [logging.py:69:log_dist] [Rank 0] step=102, skipped=0, lr=[5.858974707025881e-05, 5.858974707025881e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:08,688] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=171.32133850922636, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:08,691] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.93 | backward_microstep: 1265.95 | backward_inner_microstep: 1242.10 | backward_allreduce_microstep: 22.46 | step_microstep: 41.39
server.com lassen268: [2022-07-22 10:20:08,694] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 555.34 | backward: 1265.41 | backward_inner: 1241.57 | backward_allreduce: 22.48 | step: 41.40
server.com lassen268: [2022-07-22 10:20:10,614] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.43 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:20:10,615] [INFO] [logging.py:69:log_dist] [Rank 0] step=103, skipped=0, lr=[5.856256574850844e-05, 5.856256574850844e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:10,616] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=171.34077008786025, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:10,619] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.91 | backward_microstep: 1268.07 | backward_inner_microstep: 1243.83 | backward_allreduce_microstep: 22.85 | step_microstep: 41.32
server.com lassen268: [2022-07-22 10:20:10,622] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 555.33 | backward: 1267.53 | backward_inner: 1243.30 | backward_allreduce: 22.87 | step: 41.34
server.com lassen268: [2022-07-22 10:20:12,542] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.39 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:20:12,542] [INFO] [logging.py:69:log_dist] [Rank 0] step=104, skipped=0, lr=[5.853513213455415e-05, 5.853513213455415e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:12,543] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=171.37728568872365, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:12,546] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 556.17 | backward_microstep: 1267.15 | backward_inner_microstep: 1242.97 | backward_allreduce_microstep: 22.78 | step_microstep: 41.30
server.com lassen268: [2022-07-22 10:20:12,550] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 555.59 | backward: 1266.61 | backward_inner: 1242.44 | backward_allreduce: 22.82 | step: 41.31
server.com lassen268: [2022-07-22 10:20:14,470] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.45 | unscale_and_clip: 1.01 | basic_step: 3.87 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:20:14,471] [INFO] [logging.py:69:log_dist] [Rank 0] step=105, skipped=0, lr=[5.850744649915465e-05, 5.850744649915465e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:14,471] [INFO] [timer.py:194:stop] 0/25, SamplesPerSec=171.40402498061644, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:14,475] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.55 | backward_microstep: 1266.72 | backward_inner_microstep: 1242.61 | backward_allreduce_microstep: 22.72 | step_microstep: 41.41
server.com lassen268: [2022-07-22 10:20:14,478] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 554.97 | backward: 1266.19 | backward_inner: 1242.08 | backward_allreduce: 22.75 | step: 41.42
server.com lassen268: [2022-07-22 10:20:16,403] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:20:16,404] [INFO] [logging.py:69:log_dist] [Rank 0] step=106, skipped=0, lr=[5.847950911555597e-05, 5.847950911555597e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:16,404] [INFO] [timer.py:194:stop] 0/26, SamplesPerSec=171.2905754769053, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:16,408] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 557.93 | backward_microstep: 1267.88 | backward_inner_microstep: 1242.22 | backward_allreduce_microstep: 24.27 | step_microstep: 41.21
server.com lassen268: [2022-07-22 10:20:16,411] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 557.35 | backward: 1267.34 | backward_inner: 1241.68 | backward_allreduce: 24.30 | step: 41.22
server.com lassen268: [2022-07-22 10:20:18,331] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.40 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.33
server.com lassen268: [2022-07-22 10:20:18,332] [INFO] [logging.py:69:log_dist] [Rank 0] step=107, skipped=0, lr=[5.845132025948882e-05, 5.845132025948882e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:18,332] [INFO] [timer.py:194:stop] 0/27, SamplesPerSec=171.3166151082828, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:18,335] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 556.20 | backward_microstep: 1266.83 | backward_inner_microstep: 1242.77 | backward_allreduce_microstep: 22.69 | step_microstep: 41.32
server.com lassen268: [2022-07-22 10:20:18,339] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 555.62 | backward: 1266.29 | backward_inner: 1242.24 | backward_allreduce: 22.70 | step: 41.34
server.com lassen268: [2022-07-22 10:20:20,260] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.39 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:20:20,260] [INFO] [logging.py:69:log_dist] [Rank 0] step=108, skipped=0, lr=[5.842288020916581e-05, 5.842288020916581e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:20,261] [INFO] [timer.py:194:stop] 0/28, SamplesPerSec=171.30122885476013, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:20,264] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.82 | backward_microstep: 1265.93 | backward_inner_microstep: 1242.00 | backward_allreduce_microstep: 22.54 | step_microstep: 41.33
server.com lassen268: [2022-07-22 10:20:20,267] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 555.24 | backward: 1265.38 | backward_inner: 1241.47 | backward_allreduce: 22.57 | step: 41.34
server.com lassen268: [2022-07-22 10:20:22,182] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.34 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:20:22,183] [INFO] [logging.py:69:log_dist] [Rank 0] step=109, skipped=0, lr=[5.8394189245278774e-05, 5.8394189245278774e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:22,183] [INFO] [timer.py:194:stop] 0/29, SamplesPerSec=171.34896655003925, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:22,187] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.99 | backward_microstep: 1264.22 | backward_inner_microstep: 1240.50 | backward_allreduce_microstep: 22.34 | step_microstep: 41.19
server.com lassen268: [2022-07-22 10:20:22,190] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 554.41 | backward: 1263.68 | backward_inner: 1239.96 | backward_allreduce: 22.36 | step: 41.21
server.com lassen268: [2022-07-22 10:20:24,107] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.44 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:20:24,108] [INFO] [logging.py:69:log_dist] [Rank 0] step=110, skipped=0, lr=[5.8365247650995944e-05, 5.8365247650995944e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:24,108] [INFO] [timer.py:194:stop] 0/30, SamplesPerSec=171.3806953034731, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:24,112] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.25 | backward_microstep: 1265.70 | backward_inner_microstep: 1241.33 | backward_allreduce_microstep: 22.98 | step_microstep: 41.35
server.com lassen268: [2022-07-22 10:20:24,115] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 554.65 | backward: 1265.16 | backward_inner: 1240.80 | backward_allreduce: 23.02 | step: 41.36
server.com lassen268: [2022-07-22 10:20:26,034] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.39 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:20:26,034] [INFO] [logging.py:69:log_dist] [Rank 0] step=111, skipped=0, lr=[5.833605571195915e-05, 5.833605571195915e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:26,035] [INFO] [timer.py:194:stop] 0/31, SamplesPerSec=171.2839384804081, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:26,038] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.32 | backward_microstep: 1265.06 | backward_inner_microstep: 1240.82 | backward_allreduce_microstep: 22.86 | step_microstep: 41.28
server.com lassen268: [2022-07-22 10:20:26,041] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 553.73 | backward: 1264.52 | backward_inner: 1240.29 | backward_allreduce: 22.89 | step: 41.29
server.com lassen268: [2022-07-22 10:20:27,956] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.38 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:20:27,957] [INFO] [logging.py:69:log_dist] [Rank 0] step=112, skipped=0, lr=[5.8306613716281076e-05, 5.8306613716281076e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:27,957] [INFO] [timer.py:194:stop] 0/32, SamplesPerSec=171.33737669040335, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:27,961] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 554.83 | backward_microstep: 1264.59 | backward_inner_microstep: 1240.87 | backward_allreduce_microstep: 22.33 | step_microstep: 41.28
server.com lassen268: [2022-07-22 10:20:27,964] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 554.24 | backward: 1264.05 | backward_inner: 1240.34 | backward_allreduce: 22.36 | step: 41.29
server.com lassen268: [2022-07-22 10:20:29,880] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.42 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:20:29,881] [INFO] [logging.py:69:log_dist] [Rank 0] step=113, skipped=0, lr=[5.82769219545423e-05, 5.82769219545423e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:20:29,881] [INFO] [timer.py:194:stop] 0/33, SamplesPerSec=171.36543050155473, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:20:29,885] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 555.02 | backward_microstep: 1268.94 | backward_inner_microstep: 1245.00 | backward_allreduce_microstep: 22.56 | step_microstep: 41.37
server.com lassen268: [2022-07-22 10:20:29,888] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 554.44 | backward: 1268.40 | backward_inner: 1244.47 | backward_allreduce: 22.59 | step: 41.38
server.com lassen268: [2022-07-22 10:21:06,510] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:06,510] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:06,510] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:06,512] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:06,512] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:06,606] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:21:08,086] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:21:16,679] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:21:16,679] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:21:16,679] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:21:16,680] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:21:16,680] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:16,735] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:21:16,736] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:21:16,736] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 39.95 GB, percent = 12.5%
server.com lassen268: [2022-07-22 10:21:16,737] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:21:16,737] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:16,737] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:16,737] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:21:16,738] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:21:16,738] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:21:16,738] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:19,651] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:21:19,651] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:19,651] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:19,651] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:21:19,651] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:21:19,651] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:21:19,651] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:19,655] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:21:19,655] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:19,656] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:21:19,656] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:19,656] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:21:19,656] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:21:19,656] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:21:19,656] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:19,656] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:19,656] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:19,656] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:21:19,656] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:21:19,656] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:21:19,656] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:19,939] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:21:19,941] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:21:19,942] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.62 GB, percent = 12.8%
server.com lassen268: [2022-07-22 10:21:19,949] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:21:19,954] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:21:19,954] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:21:19,954] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:19,954] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:21:19,955] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:21:19,955] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:21:19,955] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:21:20,571] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:21:20,572] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:21:20,572] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:21:20,592] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:21:20,592] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:21:20,771] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:21:20,771] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:21:20,771] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x20009d99abe0>
server.com lassen268: [2022-07-22 10:21:20,771] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:20,773] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:21:20,773] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:21:20,773] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:21:20,773] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   checkpoint_tag_validation_enabled  True
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:21:20,774] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 10
server.com lassen268: [2022-07-22 10:21:20,775] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x20009d75fc70>
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:21:20,776] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:21:20,777] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   train_batch_size ............. 480
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  4
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   world_size ................... 12
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:21:20,778] [INFO] [config.py:1057:print]   json = {
server.com lassen268: [2022-07-22 10:21:29,401] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:21:29,401] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:21:29,401] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:21:29,401] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:21:29,401] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:21:31,837] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.15 | overflow_check: 85.05 | unscale_and_clip: 1.13 | basic_step: 3.86 | update_fp16: 3.57
server.com lassen268: [2022-07-22 10:21:31,838] [INFO] [logging.py:69:log_dist] [Rank 0] step=101, skipped=0, lr=[5.8616675831536604e-05, 5.8616675831536604e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:31,840] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1152.17 | backward_microstep: 1145.65 | backward_inner_microstep: 1116.06 | backward_allreduce_microstep: 28.31 | step_microstep: 103.54
server.com lassen268: [2022-07-22 10:21:31,843] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1151.67 | backward: 1145.41 | backward_inner: 1115.68 | backward_allreduce: 28.48 | step: 103.54
server.com lassen268: [2022-07-22 10:21:33,161] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.68 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:21:33,161] [INFO] [logging.py:69:log_dist] [Rank 0] step=102, skipped=0, lr=[5.858974707025881e-05, 5.858974707025881e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:33,164] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 372.56 | backward_microstep: 869.94 | backward_inner_microstep: 839.14 | backward_allreduce_microstep: 29.79 | step_microstep: 41.07
server.com lassen268: [2022-07-22 10:21:33,166] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 372.17 | backward: 869.58 | backward_inner: 838.77 | backward_allreduce: 29.83 | step: 41.07
server.com lassen268: [2022-07-22 10:21:34,498] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.68 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:21:34,498] [INFO] [logging.py:69:log_dist] [Rank 0] step=103, skipped=0, lr=[5.856256574850844e-05, 5.856256574850844e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:34,499] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=241.8183491020992, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:34,501] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 372.76 | backward_microstep: 863.76 | backward_inner_microstep: 832.87 | backward_allreduce_microstep: 29.91 | step_microstep: 41.56
server.com lassen268: [2022-07-22 10:21:34,503] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 372.37 | backward: 863.40 | backward_inner: 832.51 | backward_allreduce: 29.95 | step: 41.56
server.com lassen268: [2022-07-22 10:21:35,820] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.63 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:21:35,821] [INFO] [logging.py:69:log_dist] [Rank 0] step=104, skipped=0, lr=[5.853513213455415e-05, 5.853513213455415e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:35,822] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=245.95996256722384, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:35,824] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.85 | backward_microstep: 861.55 | backward_inner_microstep: 832.53 | backward_allreduce_microstep: 28.04 | step_microstep: 41.53
server.com lassen268: [2022-07-22 10:21:35,826] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.45 | backward: 861.19 | backward_inner: 832.17 | backward_allreduce: 28.07 | step: 41.53
server.com lassen268: [2022-07-22 10:21:37,149] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.65 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:21:37,149] [INFO] [logging.py:69:log_dist] [Rank 0] step=105, skipped=0, lr=[5.850744649915465e-05, 5.850744649915465e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:37,150] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=246.2061083171942, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:37,152] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.80 | backward_microstep: 865.17 | backward_inner_microstep: 833.67 | backward_allreduce_microstep: 30.53 | step_microstep: 41.54
server.com lassen268: [2022-07-22 10:21:37,154] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.41 | backward: 864.82 | backward_inner: 833.30 | backward_allreduce: 30.57 | step: 41.54
server.com lassen268: [2022-07-22 10:21:38,481] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.56 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:21:38,482] [INFO] [logging.py:69:log_dist] [Rank 0] step=106, skipped=0, lr=[5.847950911555597e-05, 5.847950911555597e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:38,483] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=247.2064383061658, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:38,485] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.36 | backward_microstep: 861.72 | backward_inner_microstep: 832.56 | backward_allreduce_microstep: 28.18 | step_microstep: 41.50
server.com lassen268: [2022-07-22 10:21:38,487] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.97 | backward: 861.37 | backward_inner: 832.20 | backward_allreduce: 28.22 | step: 41.50
server.com lassen268: [2022-07-22 10:21:39,794] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.58 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:21:39,794] [INFO] [logging.py:69:log_dist] [Rank 0] step=107, skipped=0, lr=[5.845132025948882e-05, 5.845132025948882e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:39,795] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=247.7773040860994, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:39,797] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.38 | backward_microstep: 860.89 | backward_inner_microstep: 831.60 | backward_allreduce_microstep: 28.32 | step_microstep: 41.53
server.com lassen268: [2022-07-22 10:21:39,800] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.99 | backward: 860.54 | backward_inner: 831.24 | backward_allreduce: 28.36 | step: 41.53
server.com lassen268: [2022-07-22 10:21:41,113] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.93 | overflow_check: 24.41 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.44
server.com lassen268: [2022-07-22 10:21:41,114] [INFO] [logging.py:69:log_dist] [Rank 0] step=108, skipped=0, lr=[5.842288020916581e-05, 5.842288020916581e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:41,114] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=248.1491524950199, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:41,117] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.62 | backward_microstep: 868.96 | backward_inner_microstep: 840.85 | backward_allreduce_microstep: 27.12 | step_microstep: 41.44
server.com lassen268: [2022-07-22 10:21:41,119] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.23 | backward: 868.65 | backward_inner: 840.49 | backward_allreduce: 27.16 | step: 41.44
server.com lassen268: [2022-07-22 10:21:42,434] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:21:42,434] [INFO] [logging.py:69:log_dist] [Rank 0] step=109, skipped=0, lr=[5.8394189245278774e-05, 5.8394189245278774e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:42,435] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=248.35371640768403, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:42,437] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.54 | backward_microstep: 867.09 | backward_inner_microstep: 837.73 | backward_allreduce_microstep: 28.40 | step_microstep: 41.22
server.com lassen268: [2022-07-22 10:21:42,439] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.15 | backward: 866.74 | backward_inner: 837.36 | backward_allreduce: 28.44 | step: 41.23
server.com lassen268: [2022-07-22 10:21:43,748] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.54 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.43
server.com lassen268: [2022-07-22 10:21:43,748] [INFO] [logging.py:69:log_dist] [Rank 0] step=110, skipped=0, lr=[5.8365247650995944e-05, 5.8365247650995944e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:43,749] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=248.61177462114634, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:43,751] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.65 | backward_microstep: 863.31 | backward_inner_microstep: 834.41 | backward_allreduce_microstep: 27.93 | step_microstep: 41.49
server.com lassen268: [2022-07-22 10:21:43,754] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.25 | backward: 862.96 | backward_inner: 834.05 | backward_allreduce: 27.97 | step: 41.50
server.com lassen268: [2022-07-22 10:21:45,060] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.40 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:21:45,060] [INFO] [logging.py:69:log_dist] [Rank 0] step=111, skipped=0, lr=[5.833605571195915e-05, 5.833605571195915e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:45,061] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=248.6534017802643, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:45,063] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.91 | backward_microstep: 864.26 | backward_inner_microstep: 835.32 | backward_allreduce_microstep: 27.97 | step_microstep: 41.31
server.com lassen268: [2022-07-22 10:21:45,065] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.52 | backward: 863.91 | backward_inner: 834.96 | backward_allreduce: 28.01 | step: 41.31
server.com lassen268: [2022-07-22 10:21:46,370] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.63 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.44
server.com lassen268: [2022-07-22 10:21:46,371] [INFO] [logging.py:69:log_dist] [Rank 0] step=112, skipped=0, lr=[5.8306613716281076e-05, 5.8306613716281076e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:46,372] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=248.82923818377907, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:46,374] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.66 | backward_microstep: 862.93 | backward_inner_microstep: 833.87 | backward_allreduce_microstep: 28.10 | step_microstep: 41.59
server.com lassen268: [2022-07-22 10:21:46,376] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.26 | backward: 862.58 | backward_inner: 833.51 | backward_allreduce: 28.13 | step: 41.60
server.com lassen268: [2022-07-22 10:21:47,687] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.58 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:21:47,687] [INFO] [logging.py:69:log_dist] [Rank 0] step=113, skipped=0, lr=[5.82769219545423e-05, 5.82769219545423e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:47,688] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=249.17002249243546, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:47,690] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 372.68 | backward_microstep: 866.16 | backward_inner_microstep: 837.59 | backward_allreduce_microstep: 27.60 | step_microstep: 41.54
server.com lassen268: [2022-07-22 10:21:47,693] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 372.28 | backward: 865.85 | backward_inner: 837.23 | backward_allreduce: 27.63 | step: 41.54
server.com lassen268: [2022-07-22 10:21:48,996] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.34 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.46
server.com lassen268: [2022-07-22 10:21:48,996] [INFO] [logging.py:69:log_dist] [Rank 0] step=114, skipped=0, lr=[5.824698071978854e-05, 5.824698071978854e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:48,997] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=249.36051275027327, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:48,999] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.36 | backward_microstep: 863.91 | backward_inner_microstep: 835.21 | backward_allreduce_microstep: 27.73 | step_microstep: 41.29
server.com lassen268: [2022-07-22 10:21:49,001] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.97 | backward: 863.56 | backward_inner: 834.85 | backward_allreduce: 27.76 | step: 41.30
server.com lassen268: [2022-07-22 10:21:50,303] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.60 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:21:50,304] [INFO] [logging.py:69:log_dist] [Rank 0] step=115, skipped=0, lr=[5.82167903075277e-05, 5.82167903075277e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:50,304] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=249.50475010731893, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:50,307] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.64 | backward_microstep: 862.72 | backward_inner_microstep: 833.97 | backward_allreduce_microstep: 27.78 | step_microstep: 41.49
server.com lassen268: [2022-07-22 10:21:50,309] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.24 | backward: 862.36 | backward_inner: 833.61 | backward_allreduce: 27.81 | step: 41.49
server.com lassen268: [2022-07-22 10:21:51,614] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.62 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:21:51,615] [INFO] [logging.py:69:log_dist] [Rank 0] step=116, skipped=0, lr=[5.818635101572696e-05, 5.818635101572696e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:51,616] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=249.6198266654622, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:51,618] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.43 | backward_microstep: 862.41 | backward_inner_microstep: 833.65 | backward_allreduce_microstep: 27.79 | step_microstep: 41.46
server.com lassen268: [2022-07-22 10:21:51,620] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.04 | backward: 862.06 | backward_inner: 833.29 | backward_allreduce: 27.82 | step: 41.47
server.com lassen268: [2022-07-22 10:21:52,931] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.58 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:21:52,932] [INFO] [logging.py:69:log_dist] [Rank 0] step=117, skipped=0, lr=[5.815566314480982e-05, 5.815566314480982e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:52,932] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=249.69846082203318, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:52,935] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.40 | backward_microstep: 862.59 | backward_inner_microstep: 833.58 | backward_allreduce_microstep: 28.05 | step_microstep: 41.51
server.com lassen268: [2022-07-22 10:21:52,937] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.00 | backward: 862.24 | backward_inner: 833.22 | backward_allreduce: 28.08 | step: 41.51
server.com lassen268: [2022-07-22 10:21:54,247] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.59 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:21:54,248] [INFO] [logging.py:69:log_dist] [Rank 0] step=118, skipped=0, lr=[5.81247269976532e-05, 5.81247269976532e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:54,248] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=249.660294483971, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:54,250] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.16 | backward_microstep: 862.40 | backward_inner_microstep: 833.54 | backward_allreduce_microstep: 27.88 | step_microstep: 41.47
server.com lassen268: [2022-07-22 10:21:54,253] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.75 | backward: 862.05 | backward_inner: 833.18 | backward_allreduce: 27.92 | step: 41.47
server.com lassen268: [2022-07-22 10:21:55,559] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.84 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:21:55,559] [INFO] [logging.py:69:log_dist] [Rank 0] step=119, skipped=0, lr=[5.809354287958437e-05, 5.809354287958437e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:55,560] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=249.74265871734562, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:55,562] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.36 | backward_microstep: 862.20 | backward_inner_microstep: 833.21 | backward_allreduce_microstep: 28.03 | step_microstep: 41.22
server.com lassen268: [2022-07-22 10:21:55,564] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.97 | backward: 861.85 | backward_inner: 832.85 | backward_allreduce: 28.06 | step: 41.23
server.com lassen268: [2022-07-22 10:21:56,871] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.41 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:21:56,871] [INFO] [logging.py:69:log_dist] [Rank 0] step=120, skipped=0, lr=[5.8062111098378e-05, 5.8062111098378e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:21:56,872] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=249.67469591063386, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:21:56,874] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.31 | backward_microstep: 862.48 | backward_inner_microstep: 833.77 | backward_allreduce_microstep: 27.75 | step_microstep: 41.33
server.com lassen268: [2022-07-22 10:21:56,876] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.91 | backward: 862.13 | backward_inner: 833.41 | backward_allreduce: 27.79 | step: 41.33
server.com lassen268: [2022-07-22 10:21:56,891] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step120/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:22:01,242] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.32 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:22:01,242] [INFO] [logging.py:69:log_dist] [Rank 0] step=121, skipped=0, lr=[5.8030431964253075e-05, 5.8030431964253075e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:01,243] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=249.78071070259122, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:01,245] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 372.50 | backward_microstep: 871.04 | backward_inner_microstep: 842.25 | backward_allreduce_microstep: 27.77 | step_microstep: 41.30
server.com lassen268: [2022-07-22 10:22:01,247] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 372.12 | backward: 870.72 | backward_inner: 841.90 | backward_allreduce: 27.81 | step: 41.30
server.com lassen268: [2022-07-22 10:22:02,555] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.57 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.44
server.com lassen268: [2022-07-22 10:22:02,555] [INFO] [logging.py:69:log_dist] [Rank 0] step=122, skipped=0, lr=[5.799850578986986e-05, 5.799850578986986e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:02,556] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=249.76875497913008, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:02,558] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.13 | backward_microstep: 864.95 | backward_inner_microstep: 835.49 | backward_allreduce_microstep: 28.50 | step_microstep: 41.50
server.com lassen268: [2022-07-22 10:22:02,560] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.76 | backward: 864.60 | backward_inner: 835.13 | backward_allreduce: 28.54 | step: 41.50
server.com lassen268: [2022-07-22 10:22:03,864] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.31 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:22:03,865] [INFO] [logging.py:69:log_dist] [Rank 0] step=123, skipped=0, lr=[5.796633289032679e-05, 5.796633289032679e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:03,866] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=249.68494126744628, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:03,868] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.20 | backward_microstep: 864.79 | backward_inner_microstep: 836.00 | backward_allreduce_microstep: 27.82 | step_microstep: 41.25
server.com lassen268: [2022-07-22 10:22:03,870] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.83 | backward: 864.44 | backward_inner: 835.65 | backward_allreduce: 27.86 | step: 41.26
server.com lassen268: [2022-07-22 10:22:05,175] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.33 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.44
server.com lassen268: [2022-07-22 10:22:05,176] [INFO] [logging.py:69:log_dist] [Rank 0] step=124, skipped=0, lr=[5.7933913583157424e-05, 5.7933913583157424e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:05,177] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=249.7378833836519, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:05,179] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.07 | backward_microstep: 864.74 | backward_inner_microstep: 835.55 | backward_allreduce_microstep: 28.23 | step_microstep: 41.27
server.com lassen268: [2022-07-22 10:22:05,181] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.69 | backward: 864.39 | backward_inner: 835.19 | backward_allreduce: 28.26 | step: 41.28
server.com lassen268: [2022-07-22 10:22:06,486] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.28 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:22:06,487] [INFO] [logging.py:69:log_dist] [Rank 0] step=125, skipped=0, lr=[5.79012481883272e-05, 5.79012481883272e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:06,487] [INFO] [timer.py:194:stop] 0/25, SamplesPerSec=249.82563320563602, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:06,490] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 372.64 | backward_microstep: 863.06 | backward_inner_microstep: 834.33 | backward_allreduce_microstep: 27.77 | step_microstep: 41.17
server.com lassen268: [2022-07-22 10:22:06,492] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 372.27 | backward: 862.71 | backward_inner: 833.96 | backward_allreduce: 27.81 | step: 41.17
server.com lassen268: [2022-07-22 10:22:07,800] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.70 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:22:07,801] [INFO] [logging.py:69:log_dist] [Rank 0] step=126, skipped=0, lr=[5.786833702823042e-05, 5.786833702823042e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:07,802] [INFO] [timer.py:194:stop] 0/26, SamplesPerSec=249.85850399037187, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:07,804] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.80 | backward_microstep: 863.16 | backward_inner_microstep: 834.41 | backward_allreduce_microstep: 27.76 | step_microstep: 41.63
server.com lassen268: [2022-07-22 10:22:07,806] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.42 | backward: 862.79 | backward_inner: 834.03 | backward_allreduce: 27.79 | step: 41.63
server.com lassen268: [2022-07-22 10:22:09,111] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.35 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:22:09,112] [INFO] [logging.py:69:log_dist] [Rank 0] step=127, skipped=0, lr=[5.7835180427686915e-05, 5.7835180427686915e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:09,112] [INFO] [timer.py:194:stop] 0/27, SamplesPerSec=249.9202818639043, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:09,115] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.74 | backward_microstep: 864.76 | backward_inner_microstep: 836.13 | backward_allreduce_microstep: 27.67 | step_microstep: 41.40
server.com lassen268: [2022-07-22 10:22:09,117] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.36 | backward: 864.41 | backward_inner: 835.77 | backward_allreduce: 27.70 | step: 41.41
server.com lassen268: [2022-07-22 10:22:10,423] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.58 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:22:10,423] [INFO] [logging.py:69:log_dist] [Rank 0] step=128, skipped=0, lr=[5.780177871393895e-05, 5.780177871393895e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:10,424] [INFO] [timer.py:194:stop] 0/28, SamplesPerSec=249.96255650729364, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:10,426] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.69 | backward_microstep: 863.39 | backward_inner_microstep: 834.42 | backward_allreduce_microstep: 28.00 | step_microstep: 41.51
server.com lassen268: [2022-07-22 10:22:10,428] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.31 | backward: 863.03 | backward_inner: 834.06 | backward_allreduce: 28.03 | step: 41.52
server.com lassen268: [2022-07-22 10:22:11,732] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.36 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:22:11,732] [INFO] [logging.py:69:log_dist] [Rank 0] step=129, skipped=0, lr=[5.776813221664798e-05, 5.776813221664798e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:11,733] [INFO] [timer.py:194:stop] 0/29, SamplesPerSec=249.98470811284565, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:11,735] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.63 | backward_microstep: 865.44 | backward_inner_microstep: 835.73 | backward_allreduce_microstep: 28.75 | step_microstep: 41.26
server.com lassen268: [2022-07-22 10:22:11,737] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.25 | backward: 865.09 | backward_inner: 835.37 | backward_allreduce: 28.78 | step: 41.27
server.com lassen268: [2022-07-22 10:22:13,040] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.26 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.43
server.com lassen268: [2022-07-22 10:22:13,041] [INFO] [logging.py:69:log_dist] [Rank 0] step=130, skipped=0, lr=[5.773424126789131e-05, 5.773424126789131e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:13,042] [INFO] [timer.py:194:stop] 0/30, SamplesPerSec=250.06584525743898, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:13,044] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.76 | backward_microstep: 867.79 | backward_inner_microstep: 838.99 | backward_allreduce_microstep: 27.84 | step_microstep: 41.38
server.com lassen268: [2022-07-22 10:22:13,046] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.38 | backward: 867.48 | backward_inner: 838.63 | backward_allreduce: 27.87 | step: 41.38
server.com lassen268: [2022-07-22 10:22:14,348] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.28 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:22:14,349] [INFO] [logging.py:69:log_dist] [Rank 0] step=131, skipped=0, lr=[5.770010620215896e-05, 5.770010620215896e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:14,350] [INFO] [timer.py:194:stop] 0/31, SamplesPerSec=250.0948989426997, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:14,352] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.49 | backward_microstep: 863.29 | backward_inner_microstep: 834.01 | backward_allreduce_microstep: 28.31 | step_microstep: 41.22
server.com lassen268: [2022-07-22 10:22:14,354] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.11 | backward: 862.94 | backward_inner: 833.65 | backward_allreduce: 28.35 | step: 41.23
server.com lassen268: [2022-07-22 10:22:15,664] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.55 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:22:15,664] [INFO] [logging.py:69:log_dist] [Rank 0] step=132, skipped=0, lr=[5.766572735635022e-05, 5.766572735635022e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:15,665] [INFO] [timer.py:194:stop] 0/32, SamplesPerSec=249.989942534742, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:15,667] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.60 | backward_microstep: 862.92 | backward_inner_microstep: 834.18 | backward_allreduce_microstep: 27.77 | step_microstep: 41.51
server.com lassen268: [2022-07-22 10:22:15,669] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.22 | backward: 862.57 | backward_inner: 833.83 | backward_allreduce: 27.81 | step: 41.51
server.com lassen268: [2022-07-22 10:22:16,972] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.58 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:22:16,973] [INFO] [logging.py:69:log_dist] [Rank 0] step=133, skipped=0, lr=[5.7631105069770434e-05, 5.7631105069770434e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:16,974] [INFO] [timer.py:194:stop] 0/33, SamplesPerSec=250.0394963989982, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:16,976] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.53 | backward_microstep: 862.90 | backward_inner_microstep: 834.58 | backward_allreduce_microstep: 27.35 | step_microstep: 41.47
server.com lassen268: [2022-07-22 10:22:16,978] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.16 | backward: 862.55 | backward_inner: 834.22 | backward_allreduce: 27.39 | step: 41.47
server.com lassen268: [2022-07-22 10:22:18,282] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.52 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:22:18,282] [INFO] [logging.py:69:log_dist] [Rank 0] step=134, skipped=0, lr=[5.759623968412759e-05, 5.759623968412759e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:18,283] [INFO] [timer.py:194:stop] 0/34, SamplesPerSec=250.07807867770515, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:18,285] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.09 | backward_microstep: 862.67 | backward_inner_microstep: 833.88 | backward_allreduce_microstep: 27.83 | step_microstep: 41.40
server.com lassen268: [2022-07-22 10:22:18,287] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.71 | backward: 862.33 | backward_inner: 833.52 | backward_allreduce: 27.87 | step: 41.40
server.com lassen268: [2022-07-22 10:22:19,595] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.52 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:22:19,595] [INFO] [logging.py:69:log_dist] [Rank 0] step=135, skipped=0, lr=[5.756113154352897e-05, 5.756113154352897e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:19,596] [INFO] [timer.py:194:stop] 0/35, SamplesPerSec=249.99928640198416, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:19,598] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.20 | backward_microstep: 863.61 | backward_inner_microstep: 834.56 | backward_allreduce_microstep: 28.10 | step_microstep: 41.39
server.com lassen268: [2022-07-22 10:22:19,600] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.83 | backward: 863.27 | backward_inner: 834.20 | backward_allreduce: 28.13 | step: 41.39
server.com lassen268: [2022-07-22 10:22:20,903] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.30 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:22:20,903] [INFO] [logging.py:69:log_dist] [Rank 0] step=136, skipped=0, lr=[5.752578099447774e-05, 5.752578099447774e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:20,904] [INFO] [timer.py:194:stop] 0/36, SamplesPerSec=250.04638766638746, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:20,906] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.23 | backward_microstep: 863.09 | backward_inner_microstep: 834.51 | backward_allreduce_microstep: 27.62 | step_microstep: 41.23
server.com lassen268: [2022-07-22 10:22:20,908] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.86 | backward: 862.74 | backward_inner: 834.15 | backward_allreduce: 27.66 | step: 41.23
server.com lassen268: [2022-07-22 10:22:22,212] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.35 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:22:22,213] [INFO] [logging.py:69:log_dist] [Rank 0] step=137, skipped=0, lr=[5.7490188385869547e-05, 5.7490188385869547e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:22,213] [INFO] [timer.py:194:stop] 0/37, SamplesPerSec=250.09070717467304, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:22,215] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.24 | backward_microstep: 863.31 | backward_inner_microstep: 834.57 | backward_allreduce_microstep: 27.78 | step_microstep: 41.26
server.com lassen268: [2022-07-22 10:22:22,218] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.86 | backward: 862.96 | backward_inner: 834.22 | backward_allreduce: 27.81 | step: 41.27
server.com lassen268: [2022-07-22 10:22:23,522] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.20 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:22:23,523] [INFO] [logging.py:69:log_dist] [Rank 0] step=138, skipped=0, lr=[5.745435406898909e-05, 5.745435406898909e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:23,523] [INFO] [timer.py:194:stop] 0/38, SamplesPerSec=250.12025230551953, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:23,526] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.87 | backward_microstep: 863.73 | backward_inner_microstep: 834.35 | backward_allreduce_microstep: 28.41 | step_microstep: 41.00
server.com lassen268: [2022-07-22 10:22:23,528] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 371.49 | backward: 863.38 | backward_inner: 834.00 | backward_allreduce: 28.45 | step: 41.00
server.com lassen268: [2022-07-22 10:22:24,832] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.57 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:22:24,833] [INFO] [logging.py:69:log_dist] [Rank 0] step=139, skipped=0, lr=[5.7418278397506584e-05, 5.7418278397506584e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:24,834] [INFO] [timer.py:194:stop] 0/39, SamplesPerSec=250.15539764387097, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:24,836] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.50 | backward_microstep: 864.55 | backward_inner_microstep: 835.80 | backward_allreduce_microstep: 27.79 | step_microstep: 41.50
server.com lassen268: [2022-07-22 10:22:24,838] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.12 | backward: 864.23 | backward_inner: 835.45 | backward_allreduce: 27.82 | step: 41.50
server.com lassen268: [2022-07-22 10:22:26,145] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.33 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:22:26,146] [INFO] [logging.py:69:log_dist] [Rank 0] step=140, skipped=0, lr=[5.738196172747436e-05, 5.738196172747436e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:26,147] [INFO] [timer.py:194:stop] 0/40, SamplesPerSec=250.13434586642967, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:26,149] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.41 | backward_microstep: 869.70 | backward_inner_microstep: 839.28 | backward_allreduce_microstep: 29.45 | step_microstep: 41.20
server.com lassen268: [2022-07-22 10:22:26,151] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.03 | backward: 869.34 | backward_inner: 838.92 | backward_allreduce: 29.49 | step: 41.21
server.com lassen268: [2022-07-22 10:22:26,164] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step140/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:22:30,358] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.34 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:22:30,358] [INFO] [logging.py:69:log_dist] [Rank 0] step=141, skipped=0, lr=[5.7345404417323266e-05, 5.7345404417323266e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:30,359] [INFO] [timer.py:194:stop] 0/41, SamplesPerSec=250.16879752175484, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:30,361] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 371.16 | backward_microstep: 863.51 | backward_inner_microstep: 834.82 | backward_allreduce_microstep: 27.73 | step_microstep: 41.22
server.com lassen268: [2022-07-22 10:22:30,363] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.78 | backward: 863.17 | backward_inner: 834.46 | backward_allreduce: 27.77 | step: 41.22
server.com lassen268: [2022-07-22 10:22:31,667] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.22 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:22:31,668] [INFO] [logging.py:69:log_dist] [Rank 0] step=142, skipped=0, lr=[5.730860682785923e-05, 5.730860682785923e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:31,669] [INFO] [timer.py:194:stop] 0/42, SamplesPerSec=250.1637539164856, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:31,671] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.66 | backward_microstep: 862.79 | backward_inner_microstep: 834.16 | backward_allreduce_microstep: 27.67 | step_microstep: 41.08
server.com lassen268: [2022-07-22 10:22:31,673] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.28 | backward: 862.44 | backward_inner: 833.80 | backward_allreduce: 27.71 | step: 41.08
server.com lassen268: [2022-07-22 10:22:32,976] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.50 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:22:32,976] [INFO] [logging.py:69:log_dist] [Rank 0] step=143, skipped=0, lr=[5.727156932225957e-05, 5.727156932225957e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:32,977] [INFO] [timer.py:194:stop] 0/43, SamplesPerSec=250.18995296899814, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:32,979] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.92 | backward_microstep: 862.91 | backward_inner_microstep: 834.66 | backward_allreduce_microstep: 27.28 | step_microstep: 41.40
server.com lassen268: [2022-07-22 10:22:32,981] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.54 | backward: 862.56 | backward_inner: 834.31 | backward_allreduce: 27.32 | step: 41.41
server.com lassen268: [2022-07-22 10:22:34,285] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.36 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.44
server.com lassen268: [2022-07-22 10:22:34,285] [INFO] [logging.py:69:log_dist] [Rank 0] step=144, skipped=0, lr=[5.723429226606953e-05, 5.723429226606953e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:34,286] [INFO] [timer.py:194:stop] 0/44, SamplesPerSec=250.22696410700118, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:34,288] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.76 | backward_microstep: 863.41 | backward_inner_microstep: 834.77 | backward_allreduce_microstep: 27.67 | step_microstep: 41.28
server.com lassen268: [2022-07-22 10:22:34,290] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.38 | backward: 863.06 | backward_inner: 834.42 | backward_allreduce: 27.71 | step: 41.29
server.com lassen268: [2022-07-22 10:22:35,593] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.54 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:22:35,593] [INFO] [logging.py:69:log_dist] [Rank 0] step=145, skipped=0, lr=[5.719677602719861e-05, 5.719677602719861e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:35,594] [INFO] [timer.py:194:stop] 0/45, SamplesPerSec=250.24807029990046, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:35,596] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.70 | backward_microstep: 863.32 | backward_inner_microstep: 834.49 | backward_allreduce_microstep: 27.85 | step_microstep: 41.45
server.com lassen268: [2022-07-22 10:22:35,598] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.31 | backward: 862.97 | backward_inner: 834.13 | backward_allreduce: 27.90 | step: 41.45
server.com lassen268: [2022-07-22 10:22:36,905] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.31 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:22:36,905] [INFO] [logging.py:69:log_dist] [Rank 0] step=146, skipped=0, lr=[5.715902097591694e-05, 5.715902097591694e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:22:36,906] [INFO] [timer.py:194:stop] 0/46, SamplesPerSec=250.21909633722, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:22:36,908] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.64 | backward_microstep: 863.82 | backward_inner_microstep: 835.09 | backward_allreduce_microstep: 27.76 | step_microstep: 41.18
server.com lassen268: [2022-07-22 10:22:36,910] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 370.26 | backward: 863.46 | backward_inner: 834.73 | backward_allreduce: 27.80 | step: 41.19
server.com lassen268: [2022-07-22 10:22:42,930] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:42,930] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:42,938] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:42,939] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:42,939] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:43,031] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:22:44,678] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:22:56,262] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:22:56,262] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:22:56,262] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:22:56,262] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:56,263] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 2
server.com lassen268: [2022-07-22 10:22:56,263] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:56,263] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:56,263] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:56,263] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:56,263] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 2
server.com lassen268: [2022-07-22 10:22:56,263] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 2
server.com lassen268: [2022-07-22 10:22:56,263] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:56,263] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:56,316] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:22:56,318] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:22:56,318] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 39.94 GB, percent = 12.5%
server.com lassen268: [2022-07-22 10:22:56,319] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:22:56,319] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:56,319] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:56,319] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:22:56,319] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:22:56,319] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 2
server.com lassen268: [2022-07-22 10:22:56,320] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:59,229] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:22:59,229] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:59,229] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:59,230] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:22:59,230] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:22:59,230] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 2
server.com lassen268: [2022-07-22 10:22:59,230] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:59,232] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:22:59,232] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:22:59,232] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:59,232] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:59,232] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:22:59,232] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:22:59,232] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:59,232] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 2
server.com lassen268: [2022-07-22 10:22:59,232] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:59,232] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:59,232] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:22:59,232] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:22:59,233] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 2
server.com lassen268: [2022-07-22 10:22:59,233] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:59,513] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:22:59,515] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:22:59,515] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.63 GB, percent = 12.8%
server.com lassen268: [2022-07-22 10:22:59,522] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:22:59,527] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:22:59,528] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:22:59,528] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:22:59,528] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:22:59,528] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:22:59,528] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 2
server.com lassen268: [2022-07-22 10:22:59,528] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:23:00,085] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:23:00,086] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:23:00,086] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:23:00,105] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:23:00,106] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:23:00,284] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:23:00,284] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:23:00,284] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x20009d99aca0>
server.com lassen268: [2022-07-22 10:23:00,284] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:00,285] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:23:00,285] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:23:00,286] [INFO] [config.py:1055:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
server.com lassen268: [2022-07-22 10:23:00,286] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:23:00,286] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:23:00,286] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:23:00,286] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:23:00,286] [INFO] [config.py:1055:print]   checkpoint_tag_validation_enabled  True
server.com lassen268: [2022-07-22 10:23:00,286] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:23:00,286] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:23:00,287] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 15
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:23:00,288] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x20009d75faf0>
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:23:00,289] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   train_batch_size ............. 480
server.com lassen268: [2022-07-22 10:23:00,290] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  2
server.com lassen268: [2022-07-22 10:23:00,291] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:23:00,291] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:23:00,291] [INFO] [config.py:1055:print]   world_size ................... 16
server.com lassen268: [2022-07-22 10:23:00,291] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:23:00,291] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:23:00,291] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:23:00,291] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:23:00,292] [INFO] [config.py:1057:print]   json = {
server.com lassen268: [2022-07-22 10:23:08,756] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:23:08,757] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:23:08,757] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:23:08,757] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:23:08,757] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:23:11,812] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.34 | overflow_check: 74.52 | unscale_and_clip: 1.06 | basic_step: 4.01 | update_fp16: 3.27
server.com lassen268: [2022-07-22 10:23:11,812] [INFO] [logging.py:69:log_dist] [Rank 0] step=141, skipped=0, lr=[5.7345404417323266e-05, 5.7345404417323266e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:11,816] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1304.71 | backward_microstep: 1536.76 | backward_inner_microstep: 1500.71 | backward_allreduce_microstep: 33.41 | step_microstep: 96.65
server.com lassen268: [2022-07-22 10:23:11,819] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1304.11 | backward: 1536.24 | backward_inner: 1501.18 | backward_allreduce: 33.40 | step: 96.66
server.com lassen268: [2022-07-22 10:23:13,840] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.96 | overflow_check: 24.18 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:23:13,841] [INFO] [logging.py:69:log_dist] [Rank 0] step=142, skipped=0, lr=[5.730860682785923e-05, 5.730860682785923e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:13,844] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 540.55 | backward_microstep: 1256.48 | backward_inner_microstep: 1225.86 | backward_allreduce_microstep: 29.07 | step_microstep: 40.79
server.com lassen268: [2022-07-22 10:23:13,847] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 539.96 | backward: 1255.97 | backward_inner: 1225.34 | backward_allreduce: 29.11 | step: 40.80
server.com lassen268: [2022-07-22 10:23:15,735] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.26 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:23:15,736] [INFO] [logging.py:69:log_dist] [Rank 0] step=143, skipped=0, lr=[5.727156932225957e-05, 5.727156932225957e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:15,737] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=168.86832652455251, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:15,740] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 535.24 | backward_microstep: 1249.73 | backward_inner_microstep: 1219.31 | backward_allreduce_microstep: 29.02 | step_microstep: 41.22
server.com lassen268: [2022-07-22 10:23:15,743] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 534.65 | backward: 1249.19 | backward_inner: 1218.77 | backward_allreduce: 29.06 | step: 41.23
server.com lassen268: [2022-07-22 10:23:17,665] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.38 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:23:17,666] [INFO] [logging.py:69:log_dist] [Rank 0] step=144, skipped=0, lr=[5.723429226606953e-05, 5.723429226606953e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:17,667] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=165.82280923814977, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:17,670] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 535.63 | backward_microstep: 1256.83 | backward_inner_microstep: 1222.52 | backward_allreduce_microstep: 32.91 | step_microstep: 41.31
server.com lassen268: [2022-07-22 10:23:17,673] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 535.06 | backward: 1256.28 | backward_inner: 1221.99 | backward_allreduce: 32.94 | step: 41.34
server.com lassen268: [2022-07-22 10:23:19,584] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.11 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:23:19,584] [INFO] [logging.py:69:log_dist] [Rank 0] step=145, skipped=0, lr=[5.719677602719861e-05, 5.719677602719861e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:19,585] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=166.84872184488933, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:19,588] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 535.12 | backward_microstep: 1250.68 | backward_inner_microstep: 1220.20 | backward_allreduce_microstep: 29.09 | step_microstep: 40.96
server.com lassen268: [2022-07-22 10:23:19,591] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 534.55 | backward: 1250.13 | backward_inner: 1219.66 | backward_allreduce: 29.13 | step: 40.99
server.com lassen268: [2022-07-22 10:23:21,475] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.03 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:23:21,475] [INFO] [logging.py:69:log_dist] [Rank 0] step=146, skipped=0, lr=[5.715902097591694e-05, 5.715902097591694e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:21,476] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=167.52767430031798, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:21,479] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 535.03 | backward_microstep: 1249.71 | backward_inner_microstep: 1219.38 | backward_allreduce_microstep: 28.94 | step_microstep: 40.94
server.com lassen268: [2022-07-22 10:23:21,483] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 534.43 | backward: 1249.17 | backward_inner: 1218.83 | backward_allreduce: 28.98 | step: 40.96
server.com lassen268: [2022-07-22 10:23:23,366] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.08 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:23:23,367] [INFO] [logging.py:69:log_dist] [Rank 0] step=147, skipped=0, lr=[5.712102748485162e-05, 5.712102748485162e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:23,367] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=167.80731563262503, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:23,370] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 535.41 | backward_microstep: 1249.32 | backward_inner_microstep: 1218.85 | backward_allreduce_microstep: 29.08 | step_microstep: 40.98
server.com lassen268: [2022-07-22 10:23:23,374] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 534.84 | backward: 1248.78 | backward_inner: 1218.31 | backward_allreduce: 29.11 | step: 41.00
server.com lassen268: [2022-07-22 10:23:25,263] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.10 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:23:25,264] [INFO] [logging.py:69:log_dist] [Rank 0] step=148, skipped=0, lr=[5.7082795928983075e-05, 5.7082795928983075e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:25,265] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=167.6424466568992, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:25,268] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 537.66 | backward_microstep: 1256.08 | backward_inner_microstep: 1222.89 | backward_allreduce_microstep: 31.79 | step_microstep: 41.05
server.com lassen268: [2022-07-22 10:23:25,271] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 537.09 | backward: 1255.53 | backward_inner: 1222.35 | backward_allreduce: 31.83 | step: 41.07
server.com lassen268: [2022-07-22 10:23:27,157] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.13 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:23:27,157] [INFO] [logging.py:69:log_dist] [Rank 0] step=149, skipped=0, lr=[5.7044326685641326e-05, 5.7044326685641326e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:27,158] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=167.86844454354892, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:27,161] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 537.12 | backward_microstep: 1253.46 | backward_inner_microstep: 1223.00 | backward_allreduce_microstep: 29.07 | step_microstep: 40.94
server.com lassen268: [2022-07-22 10:23:27,164] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 536.55 | backward: 1252.92 | backward_inner: 1222.47 | backward_allreduce: 29.11 | step: 40.96
server.com lassen268: [2022-07-22 10:23:29,068] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.16 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:23:29,068] [INFO] [logging.py:69:log_dist] [Rank 0] step=150, skipped=0, lr=[5.700562013450229e-05, 5.700562013450229e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:29,069] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=167.39922591202287, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:29,072] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 535.47 | backward_microstep: 1250.72 | backward_inner_microstep: 1220.41 | backward_allreduce_microstep: 28.92 | step_microstep: 41.07
server.com lassen268: [2022-07-22 10:23:29,075] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 534.90 | backward: 1250.18 | backward_inner: 1219.88 | backward_allreduce: 28.95 | step: 41.09
server.com lassen268: [2022-07-22 10:23:30,969] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.07 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:23:30,969] [INFO] [logging.py:69:log_dist] [Rank 0] step=151, skipped=0, lr=[5.696667665758398e-05, 5.696667665758398e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:30,970] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=167.34021307500015, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:30,973] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 535.96 | backward_microstep: 1249.23 | backward_inner_microstep: 1218.92 | backward_allreduce_microstep: 28.92 | step_microstep: 40.88
server.com lassen268: [2022-07-22 10:23:30,976] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 535.40 | backward: 1248.68 | backward_inner: 1218.38 | backward_allreduce: 28.96 | step: 40.91
server.com lassen268: [2022-07-22 10:23:32,871] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.10 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:23:32,872] [INFO] [logging.py:69:log_dist] [Rank 0] step=152, skipped=0, lr=[5.69274966392428e-05, 5.69274966392428e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:32,873] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=167.44589168006138, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:32,876] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 535.50 | backward_microstep: 1250.92 | backward_inner_microstep: 1219.55 | backward_allreduce_microstep: 29.98 | step_microstep: 41.04
server.com lassen268: [2022-07-22 10:23:32,879] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 534.94 | backward: 1250.38 | backward_inner: 1219.01 | backward_allreduce: 30.02 | step: 41.07
server.com lassen268: [2022-07-22 10:23:34,774] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.10 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:23:34,775] [INFO] [logging.py:69:log_dist] [Rank 0] step=153, skipped=0, lr=[5.688808046616971e-05, 5.688808046616971e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:34,776] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=167.58982988280704, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:34,779] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 536.23 | backward_microstep: 1254.60 | backward_inner_microstep: 1224.09 | backward_allreduce_microstep: 29.11 | step_microstep: 41.04
server.com lassen268: [2022-07-22 10:23:34,782] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 535.67 | backward: 1254.06 | backward_inner: 1223.55 | backward_allreduce: 29.15 | step: 41.06
server.com lassen268: [2022-07-22 10:23:36,667] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.15 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:23:36,668] [INFO] [logging.py:69:log_dist] [Rank 0] step=154, skipped=0, lr=[5.684842852738642e-05, 5.684842852738642e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:36,669] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=167.51241106758832, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:36,672] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 536.82 | backward_microstep: 1253.38 | backward_inner_microstep: 1222.81 | backward_allreduce_microstep: 29.17 | step_microstep: 41.02
server.com lassen268: [2022-07-22 10:23:36,675] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 536.26 | backward: 1252.84 | backward_inner: 1222.28 | backward_allreduce: 29.20 | step: 41.04
server.com lassen268: [2022-07-22 10:23:38,570] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.25 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.44
server.com lassen268: [2022-07-22 10:23:38,571] [INFO] [logging.py:69:log_dist] [Rank 0] step=155, skipped=0, lr=[5.680854121424157e-05, 5.680854121424157e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:38,572] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=167.47857328177884, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:38,575] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 536.82 | backward_microstep: 1255.62 | backward_inner_microstep: 1222.88 | backward_allreduce_microstep: 31.34 | step_microstep: 41.22
server.com lassen268: [2022-07-22 10:23:38,578] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 536.26 | backward: 1255.08 | backward_inner: 1222.34 | backward_allreduce: 31.38 | step: 41.25
server.com lassen268: [2022-07-22 10:23:40,473] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.19 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:23:40,474] [INFO] [logging.py:69:log_dist] [Rank 0] step=156, skipped=0, lr=[5.676841892040685e-05, 5.676841892040685e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:40,474] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=167.59461445531142, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:40,477] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 537.62 | backward_microstep: 1253.12 | backward_inner_microstep: 1222.61 | backward_allreduce_microstep: 29.11 | step_microstep: 41.13
server.com lassen268: [2022-07-22 10:23:40,481] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 537.05 | backward: 1252.58 | backward_inner: 1222.07 | backward_allreduce: 29.15 | step: 41.15
server.com lassen268: [2022-07-22 10:23:42,369] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.33 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:23:42,370] [INFO] [logging.py:69:log_dist] [Rank 0] step=157, skipped=0, lr=[5.6728062041873066e-05, 5.6728062041873066e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:42,370] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=167.61255094835943, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:42,374] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 538.92 | backward_microstep: 1253.57 | backward_inner_microstep: 1222.00 | backward_allreduce_microstep: 30.16 | step_microstep: 41.21
server.com lassen268: [2022-07-22 10:23:42,377] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 538.34 | backward: 1253.03 | backward_inner: 1221.47 | backward_allreduce: 30.19 | step: 41.24
server.com lassen268: [2022-07-22 10:23:44,266] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.23 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:23:44,266] [INFO] [logging.py:69:log_dist] [Rank 0] step=158, skipped=0, lr=[5.6687470976946334e-05, 5.6687470976946334e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:44,267] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=167.68023716998266, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:44,270] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 536.33 | backward_microstep: 1257.30 | backward_inner_microstep: 1226.37 | backward_allreduce_microstep: 29.53 | step_microstep: 41.20
server.com lassen268: [2022-07-22 10:23:44,274] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 535.76 | backward: 1256.76 | backward_inner: 1225.84 | backward_allreduce: 29.56 | step: 41.21
server.com lassen268: [2022-07-22 10:23:46,158] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.07 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.45
server.com lassen268: [2022-07-22 10:23:46,159] [INFO] [logging.py:69:log_dist] [Rank 0] step=159, skipped=0, lr=[5.664664612624409e-05, 5.664664612624409e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:46,160] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=167.76114450720257, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:46,163] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 536.70 | backward_microstep: 1252.14 | backward_inner_microstep: 1221.67 | backward_allreduce_microstep: 29.07 | step_microstep: 41.07
server.com lassen268: [2022-07-22 10:23:46,166] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 536.13 | backward: 1251.60 | backward_inner: 1221.14 | backward_allreduce: 29.11 | step: 41.09
server.com lassen268: [2022-07-22 10:23:48,059] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.15 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:23:48,060] [INFO] [logging.py:69:log_dist] [Rank 0] step=160, skipped=0, lr=[5.66055878926911e-05, 5.66055878926911e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:48,060] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=167.84525427705356, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:48,063] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 536.83 | backward_microstep: 1251.71 | backward_inner_microstep: 1221.57 | backward_allreduce_microstep: 28.74 | step_microstep: 41.18
server.com lassen268: [2022-07-22 10:23:48,067] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 536.26 | backward: 1251.17 | backward_inner: 1221.04 | backward_allreduce: 28.77 | step: 41.20
server.com lassen268: [2022-07-22 10:23:48,084] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step160/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:23:52,884] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.24 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.39
server.com lassen268: [2022-07-22 10:23:52,885] [INFO] [logging.py:69:log_dist] [Rank 0] step=161, skipped=0, lr=[5.6564296681515586e-05, 5.6564296681515586e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:52,885] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=167.84352662582782, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:52,889] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 539.03 | backward_microstep: 1251.04 | backward_inner_microstep: 1220.96 | backward_allreduce_microstep: 28.67 | step_microstep: 41.19
server.com lassen268: [2022-07-22 10:23:52,892] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 538.41 | backward: 1250.49 | backward_inner: 1220.43 | backward_allreduce: 28.71 | step: 41.21
server.com lassen268: [2022-07-22 10:23:54,774] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.22 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:23:54,774] [INFO] [logging.py:69:log_dist] [Rank 0] step=162, skipped=0, lr=[5.652277290024512e-05, 5.652277290024512e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:54,775] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=167.90605458440265, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:54,778] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 538.70 | backward_microstep: 1252.35 | backward_inner_microstep: 1222.22 | backward_allreduce_microstep: 28.73 | step_microstep: 41.22
server.com lassen268: [2022-07-22 10:23:54,781] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 538.11 | backward: 1251.81 | backward_inner: 1221.69 | backward_allreduce: 28.76 | step: 41.24
server.com lassen268: [2022-07-22 10:23:56,666] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.23 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.42
server.com lassen268: [2022-07-22 10:23:56,666] [INFO] [logging.py:69:log_dist] [Rank 0] step=163, skipped=0, lr=[5.6481016958702634e-05, 5.6481016958702634e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:56,667] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=167.9435223726495, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:56,670] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 537.62 | backward_microstep: 1252.25 | backward_inner_microstep: 1221.77 | backward_allreduce_microstep: 29.08 | step_microstep: 41.21
server.com lassen268: [2022-07-22 10:23:56,673] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 537.03 | backward: 1251.71 | backward_inner: 1221.24 | backward_allreduce: 29.12 | step: 41.22
server.com lassen268: [2022-07-22 10:23:58,562] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.19 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:23:58,562] [INFO] [logging.py:69:log_dist] [Rank 0] step=164, skipped=0, lr=[5.643902926900246e-05, 5.643902926900246e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:23:58,563] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=168.000832041613, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:23:58,566] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 537.29 | backward_microstep: 1254.28 | backward_inner_microstep: 1223.76 | backward_allreduce_microstep: 29.07 | step_microstep: 41.19
server.com lassen268: [2022-07-22 10:23:58,569] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 536.67 | backward: 1253.76 | backward_inner: 1223.22 | backward_allreduce: 29.12 | step: 41.20
server.com lassen268: [2022-07-22 10:24:00,453] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.10 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.40
server.com lassen268: [2022-07-22 10:24:00,453] [INFO] [logging.py:69:log_dist] [Rank 0] step=165, skipped=0, lr=[5.6396810245546106e-05, 5.6396810245546106e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:24:00,454] [INFO] [timer.py:194:stop] 0/25, SamplesPerSec=168.0531283906893, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:24:00,457] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 538.55 | backward_microstep: 1251.31 | backward_inner_microstep: 1221.02 | backward_allreduce_microstep: 28.89 | step_microstep: 41.06
server.com lassen268: [2022-07-22 10:24:00,461] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 537.96 | backward: 1250.76 | backward_inner: 1220.48 | backward_allreduce: 28.92 | step: 41.08
server.com lassen268: [2022-07-22 10:24:02,348] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.05 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:24:02,349] [INFO] [logging.py:69:log_dist] [Rank 0] step=166, skipped=0, lr=[5.635436030501831e-05, 5.635436030501831e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:24:02,349] [INFO] [timer.py:194:stop] 0/26, SamplesPerSec=168.09277069560645, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:24:02,353] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 540.25 | backward_microstep: 1251.80 | backward_inner_microstep: 1221.70 | backward_allreduce_microstep: 28.70 | step_microstep: 40.96
server.com lassen268: [2022-07-22 10:24:02,356] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 539.63 | backward: 1251.26 | backward_inner: 1221.16 | backward_allreduce: 28.74 | step: 40.98
server.com lassen268: [2022-07-22 10:24:53,447] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:24:53,447] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:24:53,447] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:24:53,447] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:24:53,448] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:24:53,448] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:24:53,449] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:24:53,542] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:24:55,933] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:25:04,551] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:25:04,551] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:25:04,551] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:25:04,551] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:25:04,552] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:25:04,552] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:25:04,552] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:25:04,552] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:04,552] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:25:04,552] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:25:04,552] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:04,552] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:25:04,552] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:04,605] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:25:04,606] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:25:04,606] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.0 GB, percent = 12.6%
server.com lassen268: [2022-07-22 10:25:04,607] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:25:04,607] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:25:04,607] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:04,608] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:25:04,608] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:25:04,608] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:25:04,608] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:07,528] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:25:07,528] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:25:07,529] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:07,529] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:25:07,529] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:25:07,529] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:25:07,529] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:07,535] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:25:07,535] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:25:07,535] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:07,536] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:25:07,536] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:25:07,536] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:25:07,536] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:07,536] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:25:07,536] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:25:07,536] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:07,536] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:25:07,537] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:25:07,537] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:25:07,537] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:07,811] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:25:07,813] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:25:07,814] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.69 GB, percent = 12.8%
server.com lassen268: [2022-07-22 10:25:07,821] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:25:07,826] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:25:07,826] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:25:07,827] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:07,827] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:25:07,827] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:25:07,827] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:25:07,827] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:25:08,367] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:25:08,367] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:25:08,367] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:25:08,387] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:25:08,387] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:25:08,576] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:25:08,576] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:25:08,576] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x20004d7fbbe0>
server.com lassen268: [2022-07-22 10:25:08,577] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:08,578] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:25:08,578] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:25:08,578] [INFO] [config.py:1055:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
server.com lassen268: [2022-07-22 10:25:08,578] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:25:08,578] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:25:08,579] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:25:08,579] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:25:08,579] [INFO] [config.py:1055:print]   checkpoint_tag_validation_enabled  True
server.com lassen268: [2022-07-22 10:25:08,579] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:25:08,579] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:25:08,579] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:25:08,579] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:25:08,580] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:25:08,581] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 10
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x20004d70fc70>
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:25:08,582] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:25:08,583] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   train_batch_size ............. 480
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  4
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:25:08,584] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:25:08,585] [INFO] [config.py:1055:print]   world_size ................... 12
server.com lassen268: [2022-07-22 10:25:08,585] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:25:08,585] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:25:08,585] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:25:08,585] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:25:08,586] [INFO] [config.py:1057:print]   json = {
server.com lassen268: [2022-07-22 10:25:17,133] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:25:17,133] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:25:17,133] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:25:17,133] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:25:17,133] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:25:19,567] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.64 | overflow_check: 74.52 | unscale_and_clip: 1.02 | basic_step: 4.04 | update_fp16: 3.23
server.com lassen268: [2022-07-22 10:25:19,568] [INFO] [logging.py:69:log_dist] [Rank 0] step=161, skipped=0, lr=[5.6564296681515586e-05, 5.6564296681515586e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:19,570] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1126.68 | backward_microstep: 1140.84 | backward_inner_microstep: 1110.43 | backward_allreduce_microstep: 29.30 | step_microstep: 93.64
server.com lassen268: [2022-07-22 10:25:19,573] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1126.26 | backward: 1140.51 | backward_inner: 1110.05 | backward_allreduce: 29.35 | step: 93.66
server.com lassen268: [2022-07-22 10:25:20,898] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.34 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.27
server.com lassen268: [2022-07-22 10:25:20,899] [INFO] [logging.py:69:log_dist] [Rank 0] step=162, skipped=0, lr=[5.652277290024512e-05, 5.652277290024512e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:20,901] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.99 | backward_microstep: 858.61 | backward_inner_microstep: 826.50 | backward_allreduce_microstep: 31.11 | step_microstep: 40.61
server.com lassen268: [2022-07-22 10:25:20,903] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.58 | backward: 858.24 | backward_inner: 826.13 | backward_allreduce: 31.15 | step: 40.63
server.com lassen268: [2022-07-22 10:25:22,221] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.42 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.28
server.com lassen268: [2022-07-22 10:25:22,222] [INFO] [logging.py:69:log_dist] [Rank 0] step=163, skipped=0, lr=[5.6481016958702634e-05, 5.6481016958702634e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:22,222] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=245.0594029276653, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:22,225] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.92 | backward_microstep: 856.31 | backward_inner_microstep: 826.17 | backward_allreduce_microstep: 29.18 | step_microstep: 41.30
server.com lassen268: [2022-07-22 10:25:22,227] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.52 | backward: 855.96 | backward_inner: 825.81 | backward_allreduce: 29.22 | step: 41.33
server.com lassen268: [2022-07-22 10:25:23,535] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.29 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.25
server.com lassen268: [2022-07-22 10:25:23,536] [INFO] [logging.py:69:log_dist] [Rank 0] step=164, skipped=0, lr=[5.643902926900246e-05, 5.643902926900246e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:23,537] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=248.4315795903333, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:23,539] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.78 | backward_microstep: 854.34 | backward_inner_microstep: 825.27 | backward_allreduce_microstep: 28.10 | step_microstep: 41.17
server.com lassen268: [2022-07-22 10:25:23,541] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.38 | backward: 853.99 | backward_inner: 824.91 | backward_allreduce: 28.13 | step: 41.20
server.com lassen268: [2022-07-22 10:25:24,857] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.33 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:25:24,857] [INFO] [logging.py:69:log_dist] [Rank 0] step=165, skipped=0, lr=[5.6396810245546106e-05, 5.6396810245546106e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:24,858] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=248.2168172524684, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:24,860] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 367.71 | backward_microstep: 855.87 | backward_inner_microstep: 824.83 | backward_allreduce_microstep: 30.09 | step_microstep: 41.23
server.com lassen268: [2022-07-22 10:25:24,863] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.31 | backward: 855.52 | backward_inner: 824.47 | backward_allreduce: 30.12 | step: 41.26
server.com lassen268: [2022-07-22 10:25:26,172] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.22 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:25:26,172] [INFO] [logging.py:69:log_dist] [Rank 0] step=166, skipped=0, lr=[5.635436030501831e-05, 5.635436030501831e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:26,173] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=249.14344831853478, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:26,175] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.43 | backward_microstep: 855.15 | backward_inner_microstep: 825.87 | backward_allreduce_microstep: 28.32 | step_microstep: 41.10
server.com lassen268: [2022-07-22 10:25:26,178] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.03 | backward: 854.80 | backward_inner: 825.51 | backward_allreduce: 28.36 | step: 41.13
server.com lassen268: [2022-07-22 10:25:27,475] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.33 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.27
server.com lassen268: [2022-07-22 10:25:27,476] [INFO] [logging.py:69:log_dist] [Rank 0] step=167, skipped=0, lr=[5.631167986638283e-05, 5.631167986638283e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:27,477] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=249.68553699359785, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:27,479] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.57 | backward_microstep: 853.84 | backward_inner_microstep: 824.65 | backward_allreduce_microstep: 28.23 | step_microstep: 41.18
server.com lassen268: [2022-07-22 10:25:27,481] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.17 | backward: 853.48 | backward_inner: 824.28 | backward_allreduce: 28.27 | step: 41.21
server.com lassen268: [2022-07-22 10:25:28,788] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.86 | overflow_check: 23.97 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:25:28,789] [INFO] [logging.py:69:log_dist] [Rank 0] step=168, skipped=0, lr=[5.6268769350878385e-05, 5.6268769350878385e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:28,790] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=249.15501075135745, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:28,792] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.05 | backward_microstep: 858.35 | backward_inner_microstep: 824.74 | backward_allreduce_microstep: 32.65 | step_microstep: 40.79
server.com lassen268: [2022-07-22 10:25:28,794] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.65 | backward: 858.00 | backward_inner: 824.39 | backward_allreduce: 32.69 | step: 40.82
server.com lassen268: [2022-07-22 10:25:30,104] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.01 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.26
server.com lassen268: [2022-07-22 10:25:30,104] [INFO] [logging.py:69:log_dist] [Rank 0] step=169, skipped=0, lr=[5.622562918201443e-05, 5.622562918201443e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:30,105] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=249.30228885208197, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:30,107] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.66 | backward_microstep: 857.06 | backward_inner_microstep: 829.42 | backward_allreduce_microstep: 26.69 | step_microstep: 40.88
server.com lassen268: [2022-07-22 10:25:30,109] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.26 | backward: 856.72 | backward_inner: 829.06 | backward_allreduce: 26.73 | step: 40.91
server.com lassen268: [2022-07-22 10:25:31,415] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.24 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:25:31,416] [INFO] [logging.py:69:log_dist] [Rank 0] step=170, skipped=0, lr=[5.618225978556701e-05, 5.618225978556701e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:31,416] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=249.34586874968264, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:31,419] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.06 | backward_microstep: 864.27 | backward_inner_microstep: 833.44 | backward_allreduce_microstep: 29.87 | step_microstep: 41.11
server.com lassen268: [2022-07-22 10:25:31,421] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.67 | backward: 863.92 | backward_inner: 833.09 | backward_allreduce: 29.91 | step: 41.14
server.com lassen268: [2022-07-22 10:25:32,726] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.86 | overflow_check: 24.08 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:25:32,727] [INFO] [logging.py:69:log_dist] [Rank 0] step=171, skipped=0, lr=[5.613866158957456e-05, 5.613866158957456e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:32,727] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=249.60736878850136, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:32,730] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.74 | backward_microstep: 853.98 | backward_inner_microstep: 824.76 | backward_allreduce_microstep: 28.27 | step_microstep: 40.95
server.com lassen268: [2022-07-22 10:25:32,732] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.34 | backward: 853.63 | backward_inner: 824.40 | backward_allreduce: 28.30 | step: 40.98
server.com lassen268: [2022-07-22 10:25:34,032] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.24 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:25:34,032] [INFO] [logging.py:69:log_dist] [Rank 0] step=172, skipped=0, lr=[5.609483502433368e-05, 5.609483502433368e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:34,033] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=249.84353273045394, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:34,035] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.57 | backward_microstep: 853.42 | backward_inner_microstep: 824.67 | backward_allreduce_microstep: 27.78 | step_microstep: 41.08
server.com lassen268: [2022-07-22 10:25:34,038] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.18 | backward: 853.06 | backward_inner: 824.31 | backward_allreduce: 27.82 | step: 41.11
server.com lassen268: [2022-07-22 10:25:35,337] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.26 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:25:35,338] [INFO] [logging.py:69:log_dist] [Rank 0] step=173, skipped=0, lr=[5.6050780522394865e-05, 5.6050780522394865e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:35,339] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=250.02952494455437, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:35,341] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 370.22 | backward_microstep: 853.12 | backward_inner_microstep: 824.19 | backward_allreduce_microstep: 27.98 | step_microstep: 41.13
server.com lassen268: [2022-07-22 10:25:35,343] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.83 | backward: 852.77 | backward_inner: 823.83 | backward_allreduce: 28.01 | step: 41.16
server.com lassen268: [2022-07-22 10:25:36,644] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.25 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:25:36,644] [INFO] [logging.py:69:log_dist] [Rank 0] step=174, skipped=0, lr=[5.600649851855828e-05, 5.600649851855828e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:36,645] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=250.17035183247634, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:36,647] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.68 | backward_microstep: 854.32 | backward_inner_microstep: 825.14 | backward_allreduce_microstep: 28.22 | step_microstep: 41.22
server.com lassen268: [2022-07-22 10:25:36,650] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.29 | backward: 853.97 | backward_inner: 824.78 | backward_allreduce: 28.26 | step: 41.25
server.com lassen268: [2022-07-22 10:25:37,950] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.18 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.28
server.com lassen268: [2022-07-22 10:25:37,951] [INFO] [logging.py:69:log_dist] [Rank 0] step=175, skipped=0, lr=[5.596198944986941e-05, 5.596198944986941e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:37,952] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=250.3015334861397, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:37,954] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.62 | backward_microstep: 856.88 | backward_inner_microstep: 827.62 | backward_allreduce_microstep: 28.31 | step_microstep: 41.10
server.com lassen268: [2022-07-22 10:25:37,956] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.23 | backward: 856.54 | backward_inner: 827.26 | backward_allreduce: 28.35 | step: 41.13
server.com lassen268: [2022-07-22 10:25:39,259] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.24 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:25:39,260] [INFO] [logging.py:69:log_dist] [Rank 0] step=176, skipped=0, lr=[5.5917253755614815e-05, 5.5917253755614815e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:39,261] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=250.4155083228926, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:39,263] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.52 | backward_microstep: 852.72 | backward_inner_microstep: 823.42 | backward_allreduce_microstep: 28.34 | step_microstep: 41.11
server.com lassen268: [2022-07-22 10:25:39,265] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 368.13 | backward: 852.37 | backward_inner: 823.06 | backward_allreduce: 28.38 | step: 41.14
server.com lassen268: [2022-07-22 10:25:40,564] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.28 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.27
server.com lassen268: [2022-07-22 10:25:40,565] [INFO] [logging.py:69:log_dist] [Rank 0] step=177, skipped=0, lr=[5.587229187731771e-05, 5.587229187731771e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:40,565] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=250.51540957779025, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:40,568] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.31 | backward_microstep: 853.28 | backward_inner_microstep: 824.10 | backward_allreduce_microstep: 28.22 | step_microstep: 41.13
server.com lassen268: [2022-07-22 10:25:40,570] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.92 | backward: 852.93 | backward_inner: 823.75 | backward_allreduce: 28.26 | step: 41.16
server.com lassen268: [2022-07-22 10:25:41,872] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.26 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:25:41,873] [INFO] [logging.py:69:log_dist] [Rank 0] step=178, skipped=0, lr=[5.582710425873368e-05, 5.582710425873368e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:41,874] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=250.36930750878136, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:41,876] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.24 | backward_microstep: 853.79 | backward_inner_microstep: 824.80 | backward_allreduce_microstep: 28.04 | step_microstep: 41.18
server.com lassen268: [2022-07-22 10:25:41,878] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.85 | backward: 853.44 | backward_inner: 824.44 | backward_allreduce: 28.08 | step: 41.20
server.com lassen268: [2022-07-22 10:25:43,177] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.86 | overflow_check: 24.14 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:25:43,178] [INFO] [logging.py:69:log_dist] [Rank 0] step=179, skipped=0, lr=[5.578169134584631e-05, 5.578169134584631e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:43,178] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=250.44881163938118, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:43,181] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.37 | backward_microstep: 853.71 | backward_inner_microstep: 824.47 | backward_allreduce_microstep: 28.29 | step_microstep: 41.01
server.com lassen268: [2022-07-22 10:25:43,183] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.97 | backward: 853.37 | backward_inner: 824.12 | backward_allreduce: 28.33 | step: 41.04
server.com lassen268: [2022-07-22 10:25:44,486] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.10 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:25:44,487] [INFO] [logging.py:69:log_dist] [Rank 0] step=180, skipped=0, lr=[5.5736053586862686e-05, 5.5736053586862686e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:44,487] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=250.53674012026718, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:44,490] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.28 | backward_microstep: 853.60 | backward_inner_microstep: 824.46 | backward_allreduce_microstep: 28.19 | step_microstep: 40.97
server.com lassen268: [2022-07-22 10:25:44,492] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.89 | backward: 853.25 | backward_inner: 824.11 | backward_allreduce: 28.22 | step: 41.00
server.com lassen268: [2022-07-22 10:25:44,507] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step180/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:25:49,601] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.11 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:25:49,602] [INFO] [logging.py:69:log_dist] [Rank 0] step=181, skipped=0, lr=[5.569019143220909e-05, 5.569019143220909e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:49,603] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=250.37870597874885, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:49,605] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.00 | backward_microstep: 856.92 | backward_inner_microstep: 828.99 | backward_allreduce_microstep: 26.98 | step_microstep: 41.08
server.com lassen268: [2022-07-22 10:25:49,608] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.59 | backward: 856.57 | backward_inner: 828.63 | backward_allreduce: 27.02 | step: 41.11
server.com lassen268: [2022-07-22 10:25:50,912] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.21 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.26
server.com lassen268: [2022-07-22 10:25:50,912] [INFO] [logging.py:69:log_dist] [Rank 0] step=182, skipped=0, lr=[5.5644105334526445e-05, 5.5644105334526445e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:50,913] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=250.45888631551736, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:50,915] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.03 | backward_microstep: 853.96 | backward_inner_microstep: 824.62 | backward_allreduce_microstep: 28.39 | step_microstep: 41.10
server.com lassen268: [2022-07-22 10:25:50,918] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.63 | backward: 853.61 | backward_inner: 824.27 | backward_allreduce: 28.42 | step: 41.13
server.com lassen268: [2022-07-22 10:25:52,217] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.05 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:25:52,218] [INFO] [logging.py:69:log_dist] [Rank 0] step=183, skipped=0, lr=[5.559779574866595e-05, 5.559779574866595e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:52,219] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=250.5369677659295, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:52,221] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 367.62 | backward_microstep: 853.65 | backward_inner_microstep: 824.28 | backward_allreduce_microstep: 28.42 | step_microstep: 40.93
server.com lassen268: [2022-07-22 10:25:52,224] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.22 | backward: 853.30 | backward_inner: 823.92 | backward_allreduce: 28.46 | step: 40.96
server.com lassen268: [2022-07-22 10:25:53,520] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.16 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:25:53,521] [INFO] [logging.py:69:log_dist] [Rank 0] step=184, skipped=0, lr=[5.5551263131684516e-05, 5.5551263131684516e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:53,522] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=250.6091558994292, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:53,524] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 368.09 | backward_microstep: 853.90 | backward_inner_microstep: 824.73 | backward_allreduce_microstep: 28.21 | step_microstep: 41.12
server.com lassen268: [2022-07-22 10:25:53,527] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 367.69 | backward: 853.55 | backward_inner: 824.38 | backward_allreduce: 28.25 | step: 41.14
server.com lassen268: [2022-07-22 10:25:54,835] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.01 | unscale_and_clip: 1.02 | basic_step: 3.85 | update_fp16: 2.29
server.com lassen268: [2022-07-22 10:25:54,836] [INFO] [logging.py:69:log_dist] [Rank 0] step=185, skipped=0, lr=[5.5504507942840284e-05, 5.5504507942840284e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:25:54,837] [INFO] [timer.py:194:stop] 0/25, SamplesPerSec=250.5298752271833, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:25:54,839] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 369.80 | backward_microstep: 856.39 | backward_inner_microstep: 824.45 | backward_allreduce_microstep: 30.98 | step_microstep: 40.89
server.com lassen268: [2022-07-22 10:25:54,841] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 369.40 | backward: 856.04 | backward_inner: 824.10 | backward_allreduce: 31.02 | step: 40.91
server.com lassen268: [2022-07-22 10:26:48,514] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:48,514] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:48,514] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:48,516] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:48,517] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:48,609] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:26:49,894] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:26:55,766] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:26:55,766] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:26:55,766] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:26:55,767] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:26:55,767] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:55,798] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:26:55,799] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:26:55,800] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 39.98 GB, percent = 12.6%
server.com lassen268: [2022-07-22 10:26:55,800] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:26:55,801] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:55,801] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:55,801] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:26:55,801] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:26:55,801] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:26:55,801] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:58,735] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:26:58,735] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:58,735] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:58,735] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:26:58,735] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:26:58,735] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:26:58,735] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:26:58,735] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:58,736] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:58,736] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:58,736] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:26:58,736] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:26:58,736] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:26:58,736] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:58,740] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:26:58,740] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:58,740] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:58,740] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:26:58,740] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:26:58,741] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:26:58,741] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:58,984] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:26:58,986] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:26:58,986] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.67 GB, percent = 12.8%
server.com lassen268: [2022-07-22 10:26:58,993] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:26:58,998] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:26:58,998] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:26:58,998] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:58,998] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:26:58,998] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 480
server.com lassen268: [2022-07-22 10:26:58,998] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:26:58,998] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [8, 12, 16, 20, 24, 40, 48, 60, 80, 120, 240]
server.com lassen268: [2022-07-22 10:26:59,523] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:26:59,524] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:26:59,524] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:26:59,544] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:26:59,544] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:26:59,732] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:26:59,732] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:26:59,732] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x20009d99ab80>
server.com lassen268: [2022-07-22 10:26:59,733] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:26:59,734] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:26:59,734] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:26:59,734] [INFO] [config.py:1055:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
server.com lassen268: [2022-07-22 10:26:59,734] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:26:59,734] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:26:59,734] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:26:59,734] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:26:59,735] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 15
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x20009d75ec10>
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:26:59,736] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   train_batch_size ............. 480
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  4
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   world_size ................... 8
server.com lassen268: [2022-07-22 10:26:59,737] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:26:59,738] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:26:59,738] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:26:59,738] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:26:59,738] [INFO] [config.py:1057:print]   json = {
server.com lassen268: [2022-07-22 10:27:08,689] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:27:08,689] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:27:08,689] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:27:08,689] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:27:08,689] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:27:11,725] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.47 | overflow_check: 76.79 | unscale_and_clip: 1.09 | basic_step: 3.97 | update_fp16: 3.40
server.com lassen268: [2022-07-22 10:27:11,726] [INFO] [logging.py:69:log_dist] [Rank 0] step=181, skipped=0, lr=[5.569019143220909e-05, 5.569019143220909e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:11,729] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1343.31 | backward_microstep: 1559.56 | backward_inner_microstep: 1534.12 | backward_allreduce_microstep: 23.97 | step_microstep: 95.67
server.com lassen268: [2022-07-22 10:27:11,732] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1342.67 | backward: 1558.99 | backward_inner: 1533.54 | backward_allreduce: 24.01 | step: 95.68
server.com lassen268: [2022-07-22 10:27:13,693] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.64 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.70
server.com lassen268: [2022-07-22 10:27:13,694] [INFO] [logging.py:69:log_dist] [Rank 0] step=182, skipped=0, lr=[5.5644105334526445e-05, 5.5644105334526445e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:13,697] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 562.90 | backward_microstep: 1294.58 | backward_inner_microstep: 1268.56 | backward_allreduce_microstep: 24.51 | step_microstep: 41.52
server.com lassen268: [2022-07-22 10:27:13,701] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 562.28 | backward: 1294.05 | backward_inner: 1268.00 | backward_allreduce: 24.58 | step: 41.52
server.com lassen268: [2022-07-22 10:27:15,619] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.85 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.43
server.com lassen268: [2022-07-22 10:27:15,620] [INFO] [logging.py:69:log_dist] [Rank 0] step=183, skipped=0, lr=[5.559779574866595e-05, 5.559779574866595e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:15,620] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=173.3848441357287, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:15,624] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 558.93 | backward_microstep: 1277.84 | backward_inner_microstep: 1254.91 | backward_allreduce_microstep: 21.50 | step_microstep: 41.84
server.com lassen268: [2022-07-22 10:27:15,627] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.32 | backward: 1277.28 | backward_inner: 1254.36 | backward_allreduce: 21.54 | step: 41.85
server.com lassen268: [2022-07-22 10:27:17,569] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.02 | overflow_check: 24.82 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 3.08
server.com lassen268: [2022-07-22 10:27:17,570] [INFO] [logging.py:69:log_dist] [Rank 0] step=184, skipped=0, lr=[5.5551263131684516e-05, 5.5551263131684516e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:17,571] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=171.0208071192343, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:17,574] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.28 | backward_microstep: 1285.29 | backward_inner_microstep: 1262.00 | backward_allreduce_microstep: 21.74 | step_microstep: 42.87
server.com lassen268: [2022-07-22 10:27:17,577] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.67 | backward: 1284.77 | backward_inner: 1261.46 | backward_allreduce: 21.78 | step: 42.88
server.com lassen268: [2022-07-22 10:27:19,494] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.71 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.46
server.com lassen268: [2022-07-22 10:27:19,495] [INFO] [logging.py:69:log_dist] [Rank 0] step=185, skipped=0, lr=[5.5504507942840284e-05, 5.5504507942840284e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:19,496] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=171.86710869863074, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:19,499] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 558.76 | backward_microstep: 1276.28 | backward_inner_microstep: 1253.38 | backward_allreduce_microstep: 21.48 | step_microstep: 41.70
server.com lassen268: [2022-07-22 10:27:19,502] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.16 | backward: 1275.73 | backward_inner: 1252.84 | backward_allreduce: 21.52 | step: 41.70
server.com lassen268: [2022-07-22 10:27:21,413] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.82 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.46
server.com lassen268: [2022-07-22 10:27:21,413] [INFO] [logging.py:69:log_dist] [Rank 0] step=186, skipped=0, lr=[5.545753064358809e-05, 5.545753064358809e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:21,414] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=172.2529987891264, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:21,417] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 558.53 | backward_microstep: 1276.23 | backward_inner_microstep: 1253.25 | backward_allreduce_microstep: 21.56 | step_microstep: 41.80
server.com lassen268: [2022-07-22 10:27:21,420] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 557.90 | backward: 1275.68 | backward_inner: 1252.71 | backward_allreduce: 21.60 | step: 41.81
server.com lassen268: [2022-07-22 10:27:23,338] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.78 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.56
server.com lassen268: [2022-07-22 10:27:23,339] [INFO] [logging.py:69:log_dist] [Rank 0] step=187, skipped=0, lr=[5.5410331697574924e-05, 5.5410331697574924e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:23,339] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=172.47273183338712, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:23,343] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 558.13 | backward_microstep: 1277.04 | backward_inner_microstep: 1253.92 | backward_allreduce_microstep: 21.72 | step_microstep: 41.84
server.com lassen268: [2022-07-22 10:27:23,346] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 557.53 | backward: 1276.49 | backward_inner: 1253.37 | backward_allreduce: 21.76 | step: 41.85
server.com lassen268: [2022-07-22 10:27:25,259] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.71 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.45
server.com lassen268: [2022-07-22 10:27:25,260] [INFO] [logging.py:69:log_dist] [Rank 0] step=188, skipped=0, lr=[5.536291157063532e-05, 5.536291157063532e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:25,260] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=172.5306265685209, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:25,264] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 558.79 | backward_microstep: 1277.17 | backward_inner_microstep: 1253.62 | backward_allreduce_microstep: 22.14 | step_microstep: 41.71
server.com lassen268: [2022-07-22 10:27:25,267] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.16 | backward: 1276.62 | backward_inner: 1253.07 | backward_allreduce: 22.17 | step: 41.72
server.com lassen268: [2022-07-22 10:27:27,181] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.84 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.48
server.com lassen268: [2022-07-22 10:27:27,181] [INFO] [logging.py:69:log_dist] [Rank 0] step=189, skipped=0, lr=[5.531527073078677e-05, 5.531527073078677e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:27,182] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=172.6755283055626, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:27,185] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 560.88 | backward_microstep: 1276.13 | backward_inner_microstep: 1253.29 | backward_allreduce_microstep: 21.43 | step_microstep: 41.83
server.com lassen268: [2022-07-22 10:27:27,188] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 560.28 | backward: 1275.58 | backward_inner: 1252.74 | backward_allreduce: 21.47 | step: 41.84
server.com lassen268: [2022-07-22 10:27:29,099] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.74 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.45
server.com lassen268: [2022-07-22 10:27:29,100] [INFO] [logging.py:69:log_dist] [Rank 0] step=190, skipped=0, lr=[5.5267409648225156e-05, 5.5267409648225156e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:29,101] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=172.82188032603267, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:29,104] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 558.35 | backward_microstep: 1275.56 | backward_inner_microstep: 1252.76 | backward_allreduce_microstep: 21.39 | step_microstep: 41.72
server.com lassen268: [2022-07-22 10:27:29,107] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 557.74 | backward: 1275.00 | backward_inner: 1252.21 | backward_allreduce: 21.42 | step: 41.72
server.com lassen268: [2022-07-22 10:27:31,029] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.68 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.45
server.com lassen268: [2022-07-22 10:27:31,030] [INFO] [logging.py:69:log_dist] [Rank 0] step=191, skipped=0, lr=[5.521932879532003e-05, 5.521932879532003e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:31,030] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=172.50951076206914, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:31,034] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.60 | backward_microstep: 1279.78 | backward_inner_microstep: 1256.67 | backward_allreduce_microstep: 21.70 | step_microstep: 41.64
server.com lassen268: [2022-07-22 10:27:31,037] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.97 | backward: 1279.22 | backward_inner: 1256.12 | backward_allreduce: 21.73 | step: 41.65
server.com lassen268: [2022-07-22 10:27:32,959] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.73 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.47
server.com lassen268: [2022-07-22 10:27:32,960] [INFO] [logging.py:69:log_dist] [Rank 0] step=192, skipped=0, lr=[5.5171028646610004e-05, 5.5171028646610004e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:32,960] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=172.4067331479585, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:32,963] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.88 | backward_microstep: 1280.06 | backward_inner_microstep: 1257.19 | backward_allreduce_microstep: 21.44 | step_microstep: 41.79
server.com lassen268: [2022-07-22 10:27:32,967] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 559.26 | backward: 1279.51 | backward_inner: 1256.65 | backward_allreduce: 21.48 | step: 41.79
server.com lassen268: [2022-07-22 10:27:34,883] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.73 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.52
server.com lassen268: [2022-07-22 10:27:34,884] [INFO] [logging.py:69:log_dist] [Rank 0] step=193, skipped=0, lr=[5.5122509678798046e-05, 5.5122509678798046e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:34,884] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=172.48727609962472, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:34,887] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.31 | backward_microstep: 1276.46 | backward_inner_microstep: 1253.39 | backward_allreduce_microstep: 21.66 | step_microstep: 41.77
server.com lassen268: [2022-07-22 10:27:34,891] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.67 | backward: 1275.91 | backward_inner: 1252.85 | backward_allreduce: 21.69 | step: 41.77
server.com lassen268: [2022-07-22 10:27:36,805] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.68 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.43
server.com lassen268: [2022-07-22 10:27:36,805] [INFO] [logging.py:69:log_dist] [Rank 0] step=194, skipped=0, lr=[5.5073772370746766e-05, 5.5073772370746766e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:36,806] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=172.44369564067583, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:36,809] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.60 | backward_microstep: 1276.23 | backward_inner_microstep: 1253.33 | backward_allreduce_microstep: 21.48 | step_microstep: 41.86
server.com lassen268: [2022-07-22 10:27:36,812] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.97 | backward: 1275.67 | backward_inner: 1252.79 | backward_allreduce: 21.52 | step: 41.87
server.com lassen268: [2022-07-22 10:27:38,731] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.98 | overflow_check: 24.96 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.45
server.com lassen268: [2022-07-22 10:27:38,732] [INFO] [logging.py:69:log_dist] [Rank 0] step=195, skipped=0, lr=[5.5024817203473735e-05, 5.5024817203473735e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:38,733] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=172.48629332260947, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:38,736] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.76 | backward_microstep: 1279.39 | backward_inner_microstep: 1256.56 | backward_allreduce_microstep: 21.42 | step_microstep: 42.15
server.com lassen268: [2022-07-22 10:27:38,739] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 559.12 | backward: 1278.84 | backward_inner: 1256.02 | backward_allreduce: 21.46 | step: 42.15
server.com lassen268: [2022-07-22 10:27:40,654] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.72 | unscale_and_clip: 1.02 | basic_step: 3.87 | update_fp16: 2.54
server.com lassen268: [2022-07-22 10:27:40,655] [INFO] [logging.py:69:log_dist] [Rank 0] step=196, skipped=0, lr=[5.4975644660146684e-05, 5.4975644660146684e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:40,655] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=172.568485339402, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:40,658] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 558.83 | backward_microstep: 1276.91 | backward_inner_microstep: 1254.09 | backward_allreduce_microstep: 21.42 | step_microstep: 41.84
server.com lassen268: [2022-07-22 10:27:40,662] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.19 | backward: 1276.36 | backward_inner: 1253.55 | backward_allreduce: 21.46 | step: 41.84
server.com lassen268: [2022-07-22 10:27:42,586] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.72 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.48
server.com lassen268: [2022-07-22 10:27:42,587] [INFO] [logging.py:69:log_dist] [Rank 0] step=197, skipped=0, lr=[5.4926255226078765e-05, 5.4926255226078765e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:42,587] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=172.62164874856833, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:42,591] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 561.36 | backward_microstep: 1277.85 | backward_inner_microstep: 1254.59 | backward_allreduce_microstep: 21.85 | step_microstep: 41.71
server.com lassen268: [2022-07-22 10:27:42,594] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 560.72 | backward: 1277.30 | backward_inner: 1254.04 | backward_allreduce: 21.89 | step: 41.71
server.com lassen268: [2022-07-22 10:27:44,507] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.76 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.44
server.com lassen268: [2022-07-22 10:27:44,508] [INFO] [logging.py:69:log_dist] [Rank 0] step=198, skipped=0, lr=[5.487664938872375e-05, 5.487664938872375e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:44,508] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=172.68471639767048, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:44,512] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.36 | backward_microstep: 1275.91 | backward_inner_microstep: 1253.08 | backward_allreduce_microstep: 21.42 | step_microstep: 41.74
server.com lassen268: [2022-07-22 10:27:44,515] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.72 | backward: 1275.35 | backward_inner: 1252.54 | backward_allreduce: 21.45 | step: 41.74
server.com lassen268: [2022-07-22 10:27:46,429] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.77 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.52
server.com lassen268: [2022-07-22 10:27:46,429] [INFO] [logging.py:69:log_dist] [Rank 0] step=199, skipped=0, lr=[5.482682763767124e-05, 5.482682763767124e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:46,430] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=172.75073455170087, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:46,433] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 558.67 | backward_microstep: 1275.81 | backward_inner_microstep: 1252.96 | backward_allreduce_microstep: 21.42 | step_microstep: 41.75
server.com lassen268: [2022-07-22 10:27:46,436] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.04 | backward: 1275.26 | backward_inner: 1252.42 | backward_allreduce: 21.47 | step: 41.75
server.com lassen268: [2022-07-22 10:27:48,350] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.65 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.44
server.com lassen268: [2022-07-22 10:27:48,351] [INFO] [logging.py:69:log_dist] [Rank 0] step=200, skipped=0, lr=[5.477679046464177e-05, 5.477679046464177e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:48,351] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=172.81468859588728, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:48,355] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 559.49 | backward_microstep: 1276.58 | backward_inner_microstep: 1253.84 | backward_allreduce_microstep: 21.33 | step_microstep: 41.61
server.com lassen268: [2022-07-22 10:27:48,358] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 558.85 | backward: 1276.02 | backward_inner: 1253.29 | backward_allreduce: 21.37 | step: 41.61
server.com lassen268: [2022-07-22 10:27:48,375] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step200/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:27:53,846] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.86 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.50
server.com lassen268: [2022-07-22 10:27:53,847] [INFO] [logging.py:69:log_dist] [Rank 0] step=201, skipped=0, lr=[5.472653836348208e-05, 5.472653836348208e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:53,847] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=172.81958332520108, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:53,851] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 561.80 | backward_microstep: 1277.06 | backward_inner_microstep: 1254.07 | backward_allreduce_microstep: 21.58 | step_microstep: 41.96
server.com lassen268: [2022-07-22 10:27:53,854] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 560.89 | backward: 1276.51 | backward_inner: 1253.53 | backward_allreduce: 21.62 | step: 41.96
server.com lassen268: [2022-07-22 10:27:55,773] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 25.02 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.52
server.com lassen268: [2022-07-22 10:27:55,773] [INFO] [logging.py:69:log_dist] [Rank 0] step=202, skipped=0, lr=[5.4676071830160096e-05, 5.4676071830160096e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:55,774] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=172.81235102616958, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:55,777] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 561.98 | backward_microstep: 1279.72 | backward_inner_microstep: 1256.58 | backward_allreduce_microstep: 21.72 | step_microstep: 42.10
server.com lassen268: [2022-07-22 10:27:55,780] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 561.07 | backward: 1279.17 | backward_inner: 1256.04 | backward_allreduce: 21.76 | step: 42.10
server.com lassen268: [2022-07-22 10:27:57,701] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.89 | overflow_check: 24.78 | unscale_and_clip: 1.02 | basic_step: 3.86 | update_fp16: 2.47
server.com lassen268: [2022-07-22 10:27:57,702] [INFO] [logging.py:69:log_dist] [Rank 0] step=203, skipped=0, lr=[5.4625391362760124e-05, 5.4625391362760124e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:57,702] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=172.80948446829905, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:57,706] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 565.13 | backward_microstep: 1280.47 | backward_inner_microstep: 1257.17 | backward_allreduce_microstep: 21.88 | step_microstep: 41.76
server.com lassen268: [2022-07-22 10:27:57,709] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 564.22 | backward: 1279.92 | backward_inner: 1256.63 | backward_allreduce: 21.91 | step: 41.77
server.com lassen268: [2022-07-22 10:27:59,631] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.84 | unscale_and_clip: 1.02 | basic_step: 3.88 | update_fp16: 2.48
server.com lassen268: [2022-07-22 10:27:59,631] [INFO] [logging.py:69:log_dist] [Rank 0] step=204, skipped=0, lr=[5.457449746147793e-05, 5.457449746147793e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:27:59,632] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=172.76629365489535, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:27:59,635] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 562.50 | backward_microstep: 1282.38 | backward_inner_microstep: 1259.12 | backward_allreduce_microstep: 21.84 | step_microstep: 41.89
server.com lassen268: [2022-07-22 10:27:59,638] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 561.59 | backward: 1281.82 | backward_inner: 1258.58 | backward_allreduce: 21.87 | step: 41.89
server.com lassen268: [2022-07-22 10:28:53,721] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:28:53,721] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:28:53,721] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:28:53,721] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:28:53,722] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:28:53,723] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:28:53,814] [INFO] [comm.py:423:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
server.com lassen268: [2022-07-22 10:28:54,955] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
server.com lassen268: [2022-07-22 10:28:58,171] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:28:58,171] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:28:58,171] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:28:58,171] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:28:58,172] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:28:58,172] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:28:58,172] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:28:58,172] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:28:58,172] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:28:58,172] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:28:58,172] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:28:58,172] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:28:58,172] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:28:58,204] [INFO] [utils.py:827:see_memory_usage] Before Building Model
server.com lassen268: [2022-07-22 10:28:58,205] [INFO] [utils.py:828:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:28:58,205] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 39.89 GB, percent = 12.5%
server.com lassen268: [2022-07-22 10:28:58,206] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:28:58,206] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:28:58,207] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:28:58,207] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:28:58,207] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:28:58,207] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:28:58,207] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:29:01,091] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:29:01,092] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:29:01,092] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:29:01,092] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:29:01,092] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:29:01,092] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:29:01,092] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:29:01,134] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:29:01,135] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:29:01,135] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:29:01,135] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:29:01,135] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:29:01,135] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:29:01,135] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:29:01,142] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:29:01,142] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:29:01,143] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:29:01,143] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:29:01,143] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:29:01,143] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:29:01,143] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:29:01,390] [INFO] [utils.py:827:see_memory_usage] After Building Model
server.com lassen268: [2022-07-22 10:29:01,392] [INFO] [utils.py:828:see_memory_usage] MA 0.19 GB         Max_MA 0.19 GB         CA 0.2 GB         Max_CA 0 GB 
server.com lassen268: [2022-07-22 10:29:01,392] [INFO] [utils.py:836:see_memory_usage] CPU Virtual Memory:  used = 40.58 GB, percent = 12.7%
server.com lassen268: [2022-07-22 10:29:01,399] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed info: version=0.6.6+4f9c535, git-hash=4f9c535, git-branch=arpan/elasticity
server.com lassen268: [2022-07-22 10:29:01,404] [INFO] [config.py:796:__init__] DeepSpeed elasticity support enabled
server.com lassen268: [2022-07-22 10:29:01,404] [INFO] [elasticity.py:73:get_candidate_batch_sizes] Candidate batch size: [120, 96]
server.com lassen268: [2022-07-22 10:29:01,404] [INFO] [elasticity.py:385:compute_elastic_config] Valid World Size (GPUs / Model Parallel Size): [4.0]
server.com lassen268: [2022-07-22 10:29:01,404] [WARNING] [elasticity.py:283:ensure_immutable_elastic_config] Unable to find DEEPSPEED_ELASTICITY_CONFIG environment variable, cannot guarantee resource scheduler will scale this job using compatible GPU counts.
server.com lassen268: [2022-07-22 10:29:01,404] [WARNING] [config.py:847:__init__] [Elasticity] overriding training_batch_size: 512 -> 512
server.com lassen268: [2022-07-22 10:29:01,405] [WARNING] [config.py:851:__init__] [Elasticity] overriding train_micro_batch_size_per_gpu: 4 -> 4
server.com lassen268: [2022-07-22 10:29:01,405] [INFO] [config.py:861:__init__] [Elasticity] valid GPU counts: [4.0]
server.com lassen268: [2022-07-22 10:29:01,641] [INFO] [engine.py:296:__init__] DeepSpeed Flops Profiler Enabled: False
server.com lassen268: [2022-07-22 10:29:01,641] [INFO] [engine.py:1064:_configure_optimizer] Removing param_group that has no 'params' in the client Optimizer
server.com lassen268: [2022-07-22 10:29:01,641] [INFO] [engine.py:1070:_configure_optimizer] Using client Optimizer as basic optimizer
server.com lassen268: [2022-07-22 10:29:01,661] [INFO] [engine.py:1086:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:29:01,661] [INFO] [logging.py:69:log_dist] [Rank 0] Creating fp16 optimizer with dynamic loss scale
server.com lassen268: [2022-07-22 10:29:01,735] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
server.com lassen268: [2022-07-22 10:29:01,736] [INFO] [engine.py:774:_configure_lr_scheduler] DeepSpeed using client LR scheduler
server.com lassen268: [2022-07-22 10:29:01,736] [INFO] [logging.py:69:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x20009d99bb80>
server.com lassen268: [2022-07-22 10:29:01,736] [INFO] [logging.py:69:log_dist] [Rank 0] step=0, skipped=0, lr=[5.9999999999999995e-05, 5.9999999999999995e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:01,737] [INFO] [config.py:1051:print] DeepSpeedEngine configuration:
server.com lassen268: [2022-07-22 10:29:01,737] [INFO] [config.py:1055:print]   activation_checkpointing_config  {
server.com lassen268: [2022-07-22 10:29:01,737] [INFO] [config.py:1055:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
server.com lassen268: [2022-07-22 10:29:01,737] [INFO] [config.py:1055:print]   amp_enabled .................. False
server.com lassen268: [2022-07-22 10:29:01,737] [INFO] [config.py:1055:print]   amp_params ................... False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   autotuning_config ............ {
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   bfloat16_enabled ............. False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   checkpoint_tag_validation_enabled  True
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   checkpoint_tag_validation_fail  False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   communication_data_type ...... None
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   curriculum_enabled ........... False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   curriculum_params ............ False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   dataloader_drop_last ......... False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   disable_allgather ............ False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   dump_state ................... False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   dynamic_loss_scale_args ...... {'init_scale': 4096, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   eigenvalue_enabled ........... False
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   eigenvalue_gas_boundary_resolution  1
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   eigenvalue_layer_name ........ bert.encoder.layer
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   eigenvalue_layer_num ......... 0
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   eigenvalue_max_iter .......... 100
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   eigenvalue_stability ......... 1e-06
server.com lassen268: [2022-07-22 10:29:01,738] [INFO] [config.py:1055:print]   eigenvalue_tol ............... 0.01
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   eigenvalue_verbose ........... False
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   elastic_model_parallel_size .. 1
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   elasticity_enabled ........... True
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   flops_profiler_config ........ {
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   fp16_enabled ................. True
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   fp16_master_weights_and_gradients  False
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   fp16_mixed_quantize .......... False
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   global_rank .................. 0
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   gradient_accumulation_steps .. 32
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   gradient_clipping ............ 0.0
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   gradient_predivide_factor .... 1.0
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   initial_dynamic_scale ........ 4096
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   loss_scale ................... 0
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   memory_breakdown ............. False
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x20009d761c10>
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   num_gpus_per_node ............ 4
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   optimizer_legacy_fusion ...... False
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   optimizer_name ............... None
server.com lassen268: [2022-07-22 10:29:01,739] [INFO] [config.py:1055:print]   optimizer_params ............. None
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   pld_enabled .................. False
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   pld_params ................... False
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   prescale_gradients ........... False
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_change_rate ......... 0.001
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_groups .............. 1
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_offset .............. 1000
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_period .............. 1000
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_rounding ............ 0
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_start_bits .......... 16
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_target_bits ......... 8
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_training_enabled .... False
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_type ................ 0
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   quantize_verbose ............. False
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   scheduler_name ............... None
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   scheduler_params ............. None
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   sparse_attention ............. None
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   sparse_gradients_enabled ..... False
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   steps_per_print .............. 1
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   train_batch_size ............. 512
server.com lassen268: [2022-07-22 10:29:01,740] [INFO] [config.py:1055:print]   train_micro_batch_size_per_gpu  4
server.com lassen268: [2022-07-22 10:29:01,741] [INFO] [config.py:1055:print]   use_quantizer_kernel ......... False
server.com lassen268: [2022-07-22 10:29:01,741] [INFO] [config.py:1055:print]   wall_clock_breakdown ......... True
server.com lassen268: [2022-07-22 10:29:01,741] [INFO] [config.py:1055:print]   world_size ................... 4
server.com lassen268: [2022-07-22 10:29:01,741] [INFO] [config.py:1055:print]   zero_allow_untested_optimizer  False
server.com lassen268: [2022-07-22 10:29:01,741] [INFO] [config.py:1055:print]   zero_config .................. {
server.com lassen268: [2022-07-22 10:29:01,741] [INFO] [config.py:1055:print]   zero_enabled ................. False
server.com lassen268: [2022-07-22 10:29:01,741] [INFO] [config.py:1055:print]   zero_optimization_stage ...... 0
server.com lassen268: [2022-07-22 10:29:01,741] [INFO] [config.py:1057:print]   json = {
server.com lassen268: [2022-07-22 10:29:10,297] [INFO] [checkpointing.py:547:forward] Activation Checkpointing Information
server.com lassen268: [2022-07-22 10:29:10,297] [INFO] [checkpointing.py:548:forward] ----Partition Activations False, CPU CHECKPOINTING False
server.com lassen268: [2022-07-22 10:29:10,297] [INFO] [checkpointing.py:551:forward] ----contiguous Memory Checkpointing False with 24 total layers
server.com lassen268: [2022-07-22 10:29:10,297] [INFO] [checkpointing.py:554:forward] ----Synchronization False
server.com lassen268: [2022-07-22 10:29:10,297] [INFO] [checkpointing.py:555:forward] ----Profiling time in checkpointing False
server.com lassen268: [2022-07-22 10:29:15,426] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 1.11 | overflow_check: 76.51 | unscale_and_clip: 1.06 | basic_step: 3.90 | update_fp16: 2.86
server.com lassen268: [2022-07-22 10:29:15,426] [INFO] [logging.py:69:log_dist] [Rank 0] step=201, skipped=0, lr=[5.472318059365174e-05, 5.472318059365174e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:15,433] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1962.75 | backward_microstep: 2981.65 | backward_inner_microstep: 2958.81 | backward_allreduce_microstep: 19.76 | step_microstep: 93.95
server.com lassen268: [2022-07-22 10:29:15,439] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1961.43 | backward: 2980.38 | backward_inner: 2957.62 | backward_allreduce: 19.80 | step: 93.95
server.com lassen268: [2022-07-22 10:29:19,476] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.50 | unscale_and_clip: 1.02 | basic_step: 3.92 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:29:19,477] [INFO] [logging.py:69:log_dist] [Rank 0] step=202, skipped=0, lr=[5.466932678424601e-05, 5.466932678424601e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:19,483] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1192.92 | backward_microstep: 2706.30 | backward_inner_microstep: 2684.28 | backward_allreduce_microstep: 19.08 | step_microstep: 40.83
server.com lassen268: [2022-07-22 10:29:19,490] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1191.65 | backward: 2705.09 | backward_inner: 2683.13 | backward_allreduce: 19.12 | step: 40.83
server.com lassen268: [2022-07-22 10:29:23,497] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.57 | unscale_and_clip: 1.02 | basic_step: 3.93 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:29:23,498] [INFO] [logging.py:69:log_dist] [Rank 0] step=203, skipped=0, lr=[5.4615229641170884e-05, 5.4615229641170884e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:23,499] [INFO] [timer.py:194:stop] 0/3, SamplesPerSec=87.76025652426361, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:23,505] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1188.27 | backward_microstep: 2695.33 | backward_inner_microstep: 2672.94 | backward_allreduce_microstep: 19.47 | step_microstep: 41.38
server.com lassen268: [2022-07-22 10:29:23,512] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1187.01 | backward: 2694.13 | backward_inner: 2671.80 | backward_allreduce: 19.51 | step: 41.38
server.com lassen268: [2022-07-22 10:29:27,522] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.46 | unscale_and_clip: 1.02 | basic_step: 3.92 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:29:27,522] [INFO] [logging.py:69:log_dist] [Rank 0] step=204, skipped=0, lr=[5.456088977190517e-05, 5.456088977190517e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:27,523] [INFO] [timer.py:194:stop] 0/4, SamplesPerSec=87.80555535566039, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:27,530] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1190.71 | backward_microstep: 2697.69 | backward_inner_microstep: 2675.32 | backward_allreduce_microstep: 19.46 | step_microstep: 41.31
server.com lassen268: [2022-07-22 10:29:27,536] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.45 | backward: 2696.50 | backward_inner: 2674.18 | backward_allreduce: 19.50 | step: 41.31
server.com lassen268: [2022-07-22 10:29:31,544] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.72 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:29:31,544] [INFO] [logging.py:69:log_dist] [Rank 0] step=205, skipped=0, lr=[5.45063077866533e-05, 5.45063077866533e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:31,545] [INFO] [timer.py:194:stop] 0/5, SamplesPerSec=87.81338739562361, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:31,552] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1188.15 | backward_microstep: 2696.61 | backward_inner_microstep: 2674.40 | backward_allreduce_microstep: 19.30 | step_microstep: 41.61
server.com lassen268: [2022-07-22 10:29:31,558] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1186.90 | backward: 2695.42 | backward_inner: 2673.26 | backward_allreduce: 19.34 | step: 41.62
server.com lassen268: [2022-07-22 10:29:35,566] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.45 | unscale_and_clip: 1.02 | basic_step: 3.92 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:29:35,567] [INFO] [logging.py:69:log_dist] [Rank 0] step=206, skipped=0, lr=[5.4451484298338545e-05, 5.4451484298338545e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:35,567] [INFO] [timer.py:194:stop] 0/6, SamplesPerSec=87.84816971700197, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:35,574] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1190.43 | backward_microstep: 2699.38 | backward_inner_microstep: 2677.13 | backward_allreduce_microstep: 19.33 | step_microstep: 41.32
server.com lassen268: [2022-07-22 10:29:35,581] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.18 | backward: 2698.19 | backward_inner: 2676.00 | backward_allreduce: 19.36 | step: 41.33
server.com lassen268: [2022-07-22 10:29:39,591] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.44 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:29:39,592] [INFO] [logging.py:69:log_dist] [Rank 0] step=207, skipped=0, lr=[5.439641992259615e-05, 5.439641992259615e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:39,592] [INFO] [timer.py:194:stop] 0/7, SamplesPerSec=87.87225088495703, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:39,599] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1189.68 | backward_microstep: 2699.93 | backward_inner_microstep: 2677.69 | backward_allreduce_microstep: 19.33 | step_microstep: 41.31
server.com lassen268: [2022-07-22 10:29:39,605] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1188.43 | backward: 2698.74 | backward_inner: 2676.55 | backward_allreduce: 19.35 | step: 41.32
server.com lassen268: [2022-07-22 10:29:43,618] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.54 | unscale_and_clip: 1.02 | basic_step: 3.92 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:29:43,619] [INFO] [logging.py:69:log_dist] [Rank 0] step=208, skipped=0, lr=[5.434111527776631e-05, 5.434111527776631e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:43,619] [INFO] [timer.py:194:stop] 0/8, SamplesPerSec=87.85565472618883, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:43,626] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1191.32 | backward_microstep: 2703.83 | backward_inner_microstep: 2681.27 | backward_allreduce_microstep: 19.65 | step_microstep: 41.45
server.com lassen268: [2022-07-22 10:29:43,632] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1190.07 | backward: 2702.63 | backward_inner: 2680.14 | backward_allreduce: 19.67 | step: 41.45
server.com lassen268: [2022-07-22 10:29:47,644] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.46 | unscale_and_clip: 1.02 | basic_step: 3.94 | update_fp16: 2.31
server.com lassen268: [2022-07-22 10:29:47,645] [INFO] [logging.py:69:log_dist] [Rank 0] step=209, skipped=0, lr=[5.4285570984887355e-05, 5.4285570984887355e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:47,646] [INFO] [timer.py:194:stop] 0/9, SamplesPerSec=87.85765386524487, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:47,652] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1191.10 | backward_microstep: 2700.32 | backward_inner_microstep: 2677.97 | backward_allreduce_microstep: 19.40 | step_microstep: 41.35
server.com lassen268: [2022-07-22 10:29:47,659] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.85 | backward: 2699.09 | backward_inner: 2676.84 | backward_allreduce: 19.43 | step: 41.35
server.com lassen268: [2022-07-22 10:29:51,666] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.46 | unscale_and_clip: 1.02 | basic_step: 3.89 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:29:51,667] [INFO] [logging.py:69:log_dist] [Rank 0] step=210, skipped=0, lr=[5.422978766768871e-05, 5.422978766768871e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:51,667] [INFO] [timer.py:194:stop] 0/10, SamplesPerSec=87.86246038692344, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:51,674] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1189.81 | backward_microstep: 2701.88 | backward_inner_microstep: 2679.54 | backward_allreduce_microstep: 19.43 | step_microstep: 41.39
server.com lassen268: [2022-07-22 10:29:51,680] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1188.56 | backward: 2700.70 | backward_inner: 2678.40 | backward_allreduce: 19.45 | step: 41.39
server.com lassen268: [2022-07-22 10:29:55,691] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.69 | unscale_and_clip: 1.02 | basic_step: 3.92 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:29:55,692] [INFO] [logging.py:69:log_dist] [Rank 0] step=211, skipped=0, lr=[5.4173765952583895e-05, 5.4173765952583895e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:55,692] [INFO] [timer.py:194:stop] 0/11, SamplesPerSec=87.66025578783882, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:55,699] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1191.05 | backward_microstep: 2699.55 | backward_inner_microstep: 2677.60 | backward_allreduce_microstep: 19.04 | step_microstep: 41.55
server.com lassen268: [2022-07-22 10:29:55,705] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.79 | backward: 2698.36 | backward_inner: 2676.46 | backward_allreduce: 19.07 | step: 41.55
server.com lassen268: [2022-07-22 10:29:59,717] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.45 | unscale_and_clip: 1.02 | basic_step: 3.90 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:29:59,718] [INFO] [logging.py:69:log_dist] [Rank 0] step=212, skipped=0, lr=[5.411750646866347e-05, 5.411750646866347e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:29:59,718] [INFO] [timer.py:194:stop] 0/12, SamplesPerSec=87.68964006001308, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:29:59,725] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1193.38 | backward_microstep: 2700.80 | backward_inner_microstep: 2678.65 | backward_allreduce_microstep: 19.25 | step_microstep: 41.28
server.com lassen268: [2022-07-22 10:29:59,731] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1192.13 | backward: 2699.61 | backward_inner: 2677.52 | backward_allreduce: 19.27 | step: 41.28
server.com lassen268: [2022-07-22 10:30:03,740] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.49 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.32
server.com lassen268: [2022-07-22 10:30:03,741] [INFO] [logging.py:69:log_dist] [Rank 0] step=213, skipped=0, lr=[5.4061009847688064e-05, 5.4061009847688064e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:03,741] [INFO] [timer.py:194:stop] 0/13, SamplesPerSec=87.72582959241576, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:03,748] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1191.62 | backward_microstep: 2701.49 | backward_inner_microstep: 2679.41 | backward_allreduce_microstep: 19.16 | step_microstep: 41.33
server.com lassen268: [2022-07-22 10:30:03,754] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1190.37 | backward: 2700.30 | backward_inner: 2678.26 | backward_allreduce: 19.18 | step: 41.34
server.com lassen268: [2022-07-22 10:30:07,764] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.61 | unscale_and_clip: 1.02 | basic_step: 3.90 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:30:07,764] [INFO] [logging.py:69:log_dist] [Rank 0] step=214, skipped=0, lr=[5.4004276724081156e-05, 5.4004276724081156e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:07,765] [INFO] [timer.py:194:stop] 0/14, SamplesPerSec=87.7409034768352, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:07,772] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1191.42 | backward_microstep: 2702.81 | backward_inner_microstep: 2680.81 | backward_allreduce_microstep: 19.09 | step_microstep: 41.54
server.com lassen268: [2022-07-22 10:30:07,778] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1190.17 | backward: 2701.62 | backward_inner: 2679.68 | backward_allreduce: 19.11 | step: 41.54
server.com lassen268: [2022-07-22 10:30:11,784] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.65 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:30:11,784] [INFO] [logging.py:69:log_dist] [Rank 0] step=215, skipped=0, lr=[5.394730773492202e-05, 5.394730773492202e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:11,785] [INFO] [timer.py:194:stop] 0/15, SamplesPerSec=87.75061718063517, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:11,791] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1190.86 | backward_microstep: 2699.11 | backward_inner_microstep: 2677.00 | backward_allreduce_microstep: 19.20 | step_microstep: 41.58
server.com lassen268: [2022-07-22 10:30:11,798] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.61 | backward: 2697.92 | backward_inner: 2675.87 | backward_allreduce: 19.23 | step: 41.59
server.com lassen268: [2022-07-22 10:30:15,806] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.46 | unscale_and_clip: 1.02 | basic_step: 3.92 | update_fp16: 2.41
server.com lassen268: [2022-07-22 10:30:15,806] [INFO] [logging.py:69:log_dist] [Rank 0] step=216, skipped=0, lr=[5.389010351993858e-05, 5.389010351993858e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:15,807] [INFO] [timer.py:194:stop] 0/16, SamplesPerSec=87.75897771399471, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:15,813] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1193.58 | backward_microstep: 2701.72 | backward_inner_microstep: 2679.66 | backward_allreduce_microstep: 19.15 | step_microstep: 41.40
server.com lassen268: [2022-07-22 10:30:15,820] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1192.33 | backward: 2700.54 | backward_inner: 2678.52 | backward_allreduce: 19.18 | step: 41.40
server.com lassen268: [2022-07-22 10:30:19,822] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.71 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:30:19,822] [INFO] [logging.py:69:log_dist] [Rank 0] step=217, skipped=0, lr=[5.383266472150018e-05, 5.383266472150018e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:19,823] [INFO] [timer.py:194:stop] 0/17, SamplesPerSec=87.76429649794781, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:19,829] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1191.20 | backward_microstep: 2701.97 | backward_inner_microstep: 2679.84 | backward_allreduce_microstep: 19.20 | step_microstep: 41.64
server.com lassen268: [2022-07-22 10:30:19,836] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.95 | backward: 2700.77 | backward_inner: 2678.70 | backward_allreduce: 19.22 | step: 41.64
server.com lassen268: [2022-07-22 10:30:23,841] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.65 | unscale_and_clip: 1.02 | basic_step: 3.90 | update_fp16: 2.37
server.com lassen268: [2022-07-22 10:30:23,842] [INFO] [logging.py:69:log_dist] [Rank 0] step=218, skipped=0, lr=[5.377499198461044e-05, 5.377499198461044e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:23,842] [INFO] [timer.py:194:stop] 0/18, SamplesPerSec=87.77341362907715, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:23,849] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1190.34 | backward_microstep: 2699.81 | backward_inner_microstep: 2677.60 | backward_allreduce_microstep: 19.29 | step_microstep: 41.53
server.com lassen268: [2022-07-22 10:30:23,855] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.09 | backward: 2698.62 | backward_inner: 2676.47 | backward_allreduce: 19.32 | step: 41.53
server.com lassen268: [2022-07-22 10:30:27,856] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.47 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.34
server.com lassen268: [2022-07-22 10:30:27,856] [INFO] [logging.py:69:log_dist] [Rank 0] step=219, skipped=0, lr=[5.371708595689991e-05, 5.371708595689991e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:27,857] [INFO] [timer.py:194:stop] 0/19, SamplesPerSec=87.79151795240615, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:27,864] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1190.25 | backward_microstep: 2699.40 | backward_inner_microstep: 2677.34 | backward_allreduce_microstep: 19.14 | step_microstep: 41.36
server.com lassen268: [2022-07-22 10:30:27,870] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.00 | backward: 2698.21 | backward_inner: 2676.21 | backward_allreduce: 19.18 | step: 41.36
server.com lassen268: [2022-07-22 10:30:31,876] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.38 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:30:31,877] [INFO] [logging.py:69:log_dist] [Rank 0] step=220, skipped=0, lr=[5.3658947288618905e-05, 5.3658947288618905e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:31,877] [INFO] [timer.py:194:stop] 0/20, SamplesPerSec=87.76913271311612, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:31,884] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1190.99 | backward_microstep: 2698.19 | backward_inner_microstep: 2676.15 | backward_allreduce_microstep: 19.14 | step_microstep: 41.27
server.com lassen268: [2022-07-22 10:30:31,890] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1189.74 | backward: 2697.00 | backward_inner: 2675.02 | backward_allreduce: 19.16 | step: 41.27
server.com lassen268: [2022-07-22 10:30:31,905] [INFO] [logging.py:69:log_dist] [Rank 0] Saving model checkpoint: results/el_scale_up_down//ds_z0_nl24_hs512_gb512_mb4/checkpoint/global_step220/mp_rank_00_model_states.pt
server.com lassen268: [2022-07-22 10:30:39,451] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.70 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.36
server.com lassen268: [2022-07-22 10:30:39,452] [INFO] [logging.py:69:log_dist] [Rank 0] step=221, skipped=0, lr=[5.360057663263013e-05, 5.360057663263013e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:39,453] [INFO] [timer.py:194:stop] 0/21, SamplesPerSec=87.76918507345852, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:39,459] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1189.67 | backward_microstep: 2700.04 | backward_inner_microstep: 2677.77 | backward_allreduce_microstep: 19.35 | step_microstep: 41.54
server.com lassen268: [2022-07-22 10:30:39,466] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1188.41 | backward: 2698.85 | backward_inner: 2676.64 | backward_allreduce: 19.38 | step: 41.55
server.com lassen268: [2022-07-22 10:30:43,467] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.66 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.35
server.com lassen268: [2022-07-22 10:30:43,467] [INFO] [logging.py:69:log_dist] [Rank 0] step=222, skipped=0, lr=[5.354197464440138e-05, 5.354197464440138e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:43,468] [INFO] [timer.py:194:stop] 0/22, SamplesPerSec=87.76309709193997, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:43,475] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1189.41 | backward_microstep: 2698.77 | backward_inner_microstep: 2676.66 | backward_allreduce_microstep: 19.20 | step_microstep: 41.49
server.com lassen268: [2022-07-22 10:30:43,481] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1188.16 | backward: 2697.58 | backward_inner: 2675.52 | backward_allreduce: 19.21 | step: 41.49
server.com lassen268: [2022-07-22 10:30:47,487] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.88 | overflow_check: 24.66 | unscale_and_clip: 1.02 | basic_step: 3.94 | update_fp16: 2.30
server.com lassen268: [2022-07-22 10:30:47,488] [INFO] [logging.py:69:log_dist] [Rank 0] step=223, skipped=0, lr=[5.348314198199818e-05, 5.348314198199818e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:47,488] [INFO] [timer.py:194:stop] 0/23, SamplesPerSec=87.77024782929519, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:47,495] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1189.78 | backward_microstep: 2703.86 | backward_inner_microstep: 2681.84 | backward_allreduce_microstep: 19.11 | step_microstep: 41.51
server.com lassen268: [2022-07-22 10:30:47,501] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1188.52 | backward: 2702.67 | backward_inner: 2680.71 | backward_allreduce: 19.14 | step: 41.51
server.com lassen268: [2022-07-22 10:30:51,507] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | compute_norm: 0.87 | overflow_check: 24.66 | unscale_and_clip: 1.02 | basic_step: 3.91 | update_fp16: 2.38
server.com lassen268: [2022-07-22 10:30:51,507] [INFO] [logging.py:69:log_dist] [Rank 0] step=224, skipped=0, lr=[5.3424079306076404e-05, 5.3424079306076404e-05], mom=[(0.9, 0.95), (0.9, 0.95)]
server.com lassen268: [2022-07-22 10:30:51,508] [INFO] [timer.py:194:stop] 0/24, SamplesPerSec=87.77317489559807, MemAllocated=1.33GB, MaxMemAllocated=2.29GB
server.com lassen268: [2022-07-22 10:30:51,515] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward_microstep: 1191.98 | backward_microstep: 2700.29 | backward_inner_microstep: 2678.10 | backward_allreduce_microstep: 19.25 | step_microstep: 41.56
server.com lassen268: [2022-07-22 10:30:51,521] [INFO] [logging.py:69:log_dist] [Rank 0] rank=0 time (ms) | forward: 1190.73 | backward: 2699.08 | backward_inner: 2676.97 | backward_allreduce: 19.28 | step: 41.56
